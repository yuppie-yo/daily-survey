{"version":3,"file":"e74b563e3c3c2f7d6c55.chunk.js","mappings":"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","sources":["webpack://superset/./packages/superset-ui-core/src/color/index.ts","webpack://superset/./packages/superset-ui-core/src/dimension/computeMaxFontSize.ts","webpack://superset/./packages/superset-ui-core/src/dimension/getTextDimension.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/LazyFactory.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/constants.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/factories.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/createHiddenSvgNode.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/createTextNode.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/getBBoxCeil.ts","webpack://superset/./packages/superset-ui-core/src/dimension/svg/updateTextNode.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberViz.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/components/Echart.tsx"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport * as CategoricalColorNamespace from './CategoricalColorNamespace';\n\nexport { CategoricalColorNamespace };\nexport { default as CategoricalColorScale } from './CategoricalColorScale';\nexport { default as CategoricalScheme } from './CategoricalScheme';\nexport * from './CategoricalScheme';\nexport { default as getCategoricalSchemeRegistry } from './CategoricalSchemeRegistrySingleton';\nexport { default as ColorScheme } from './ColorScheme';\nexport * from './ColorScheme';\nexport { default as getSequentialSchemeRegistry } from './SequentialSchemeRegistrySingleton';\nexport { default as SequentialScheme } from './SequentialScheme';\nexport * from './SequentialScheme';\nexport { default as ColorSchemeRegistry } from './ColorSchemeRegistry';\nexport * from './colorSchemes';\nexport * from './utils';\nexport * from './types';\nexport {\n  default as getLabelsColorMap,\n  LabelsColorMap,\n  LabelsColorMapSource,\n} from './LabelsColorMapSingleton';\n\nexport const BRAND_COLOR = '#00A699';\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport getTextDimension, { GetTextDimensionInput } from './getTextDimension';\nimport { Dimension } from './types';\n\nfunction decreaseSizeUntil(\n  startSize: number,\n  computeDimension: (size: number) => Dimension,\n  condition: (dimension: Dimension) => boolean,\n): number {\n  let size = startSize;\n  let dimension = computeDimension(size);\n\n  while (!condition(dimension)) {\n    size -= 1;\n\n    // Here if the size goes below zero most likely is because it\n    // has additional style applied in which case we assume the user\n    // knows what it's doing and we just let them use that.\n    // Visually it works, although it could have another\n    // check in place.\n    if (size < 0) {\n      size = startSize;\n      break;\n    }\n\n    dimension = computeDimension(size);\n  }\n\n  return size;\n}\n\nexport default function computeMaxFontSize(\n  input: GetTextDimensionInput & {\n    maxWidth?: number;\n    maxHeight?: number;\n    idealFontSize?: number;\n  },\n) {\n  const { idealFontSize, maxWidth, maxHeight, style, ...rest } = input;\n\n  let size: number;\n  if (idealFontSize !== undefined && idealFontSize !== null) {\n    size = idealFontSize;\n  } else if (maxHeight === undefined || maxHeight === null) {\n    throw new Error(\n      'You must specify at least one of maxHeight or idealFontSize',\n    );\n  } else {\n    size = Math.floor(maxHeight);\n  }\n\n  function computeDimension(fontSize: number) {\n    return getTextDimension({\n      ...rest,\n      style: { ...style, fontSize: `${fontSize}px` },\n    });\n  }\n\n  if (maxWidth !== undefined && maxWidth !== null) {\n    size = decreaseSizeUntil(\n      size,\n      computeDimension,\n      dim => dim.width > 0 && dim.width <= maxWidth,\n    );\n  }\n\n  if (maxHeight !== undefined && maxHeight !== null) {\n    size = decreaseSizeUntil(\n      size,\n      computeDimension,\n      dim => dim.height > 0 && dim.height <= maxHeight,\n    );\n  }\n\n  return size;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { TextStyle, Dimension } from './types';\nimport updateTextNode from './svg/updateTextNode';\nimport getBBoxCeil from './svg/getBBoxCeil';\nimport { hiddenSvgFactory, textFactory } from './svg/factories';\n\nexport interface GetTextDimensionInput {\n  className?: string;\n  container?: HTMLElement;\n  style?: TextStyle;\n  text: string;\n}\n\nexport default function getTextDimension(\n  input: GetTextDimensionInput,\n  defaultDimension?: Dimension,\n): Dimension {\n  const { text, className, style, container } = input;\n\n  // Empty string\n  if (text.length === 0) {\n    return { height: 0, width: 0 };\n  }\n\n  const svgNode = hiddenSvgFactory.createInContainer(container);\n  const textNode = textFactory.createInContainer(svgNode);\n  updateTextNode(textNode, { className, style, text });\n  const dimension = getBBoxCeil(textNode, defaultDimension);\n\n  // The nodes are added to the DOM briefly only to make getBBox works.\n  // (If not added to DOM getBBox will always return 0x0.)\n  // After that the svg nodes are not needed.\n  // We delay its removal in case there are subsequent calls to this function\n  // that can reuse the svg nodes.\n  // Experiments have shown that reusing existing nodes\n  // instead of deleting and adding new ones can save lot of time.\n  setTimeout(() => {\n    textFactory.removeFromContainer(svgNode);\n    hiddenSvgFactory.removeFromContainer(container);\n  }, 500);\n\n  return dimension;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport default class LazyFactory<T extends HTMLElement | SVGElement> {\n  private activeNodes = new Map<\n    HTMLElement | SVGElement,\n    {\n      counter: number;\n      node: T;\n    }\n  >();\n\n  private factoryFn: () => T;\n\n  constructor(factoryFn: () => T) {\n    this.factoryFn = factoryFn;\n  }\n\n  createInContainer(container: HTMLElement | SVGElement = document.body) {\n    if (this.activeNodes.has(container)) {\n      const entry = this.activeNodes.get(container)!;\n      entry.counter += 1;\n\n      return entry.node;\n    }\n\n    const node = this.factoryFn();\n    container.append(node);\n    this.activeNodes.set(container, { counter: 1, node });\n\n    return node;\n  }\n\n  removeFromContainer(container: HTMLElement | SVGElement = document.body) {\n    if (this.activeNodes.has(container)) {\n      const entry = this.activeNodes.get(container)!;\n      entry.counter -= 1;\n      if (entry.counter === 0) {\n        container.removeChild(entry.node);\n        this.activeNodes.delete(container);\n      }\n    }\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// eslint-disable-next-line import/prefer-default-export\nexport const SVG_NS = 'http://www.w3.org/2000/svg';\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport LazyFactory from './LazyFactory';\nimport createHiddenSvgNode from './createHiddenSvgNode';\nimport createTextNode from './createTextNode';\n\nexport const hiddenSvgFactory = new LazyFactory(createHiddenSvgNode);\nexport const textFactory = new LazyFactory(createTextNode);\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SVG_NS } from './constants';\n\nexport default function createHiddenSvgNode() {\n  const svgNode = document.createElementNS(SVG_NS, 'svg');\n  svgNode.style.position = 'absolute'; // so it won't disrupt page layout\n  svgNode.style.top = '-100%';\n  svgNode.style.left = '-100%';\n  svgNode.style.width = '0'; // no dimensions\n  svgNode.style.height = '0';\n  svgNode.style.opacity = '0'; // not visible\n  svgNode.style.pointerEvents = 'none'; // won't capture mouse events\n\n  return svgNode;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SVG_NS } from './constants';\n\nexport default function createTextNode() {\n  return document.createElementNS(SVG_NS, 'text');\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Dimension } from '../types';\n\nconst DEFAULT_DIMENSION = { height: 20, width: 100 };\n\nexport default function getBBoxCeil(\n  node: SVGGraphicsElement,\n  defaultDimension: Dimension = DEFAULT_DIMENSION,\n) {\n  const { width, height } = node.getBBox ? node.getBBox() : defaultDimension;\n\n  return {\n    height: Math.ceil(height),\n    width: Math.ceil(width),\n  };\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { TextStyle } from '../types';\n\nconst STYLE_FIELDS: (keyof TextStyle)[] = [\n  'font',\n  'fontWeight',\n  'fontStyle',\n  'fontSize',\n  'fontFamily',\n  'letterSpacing',\n];\n\nexport default function updateTextNode(\n  node: SVGTextElement,\n  {\n    className,\n    style = {},\n    text,\n  }: {\n    className?: string;\n    style?: TextStyle;\n    text?: string;\n  } = {},\n) {\n  const textNode = node;\n\n  if (textNode.textContent !== text) {\n    textNode.textContent = typeof text === 'undefined' ? null : text;\n  }\n  if (textNode.getAttribute('class') !== className) {\n    textNode.setAttribute('class', className ?? '');\n  }\n\n  // Clear style\n  // Note: multi-word property names are hyphenated and not camel-cased.\n  textNode.style.removeProperty('font');\n  textNode.style.removeProperty('font-weight');\n  textNode.style.removeProperty('font-style');\n  textNode.style.removeProperty('font-size');\n  textNode.style.removeProperty('font-family');\n  textNode.style.removeProperty('letter-spacing');\n\n  // Apply new style\n  // Note: the font field will auto-populate other font fields when applicable.\n  STYLE_FIELDS.filter(\n    (field: keyof TextStyle) =>\n      typeof style[field] !== 'undefined' && style[field] !== null,\n  ).forEach((field: keyof TextStyle) => {\n    textNode.style[field] = `${style[field]}`;\n  });\n\n  return textNode;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { PureComponent, MouseEvent } from 'react';\nimport {\n  t,\n  getNumberFormatter,\n  getTimeFormatter,\n  SMART_DATE_VERBOSE_ID,\n  computeMaxFontSize,\n  BRAND_COLOR,\n  styled,\n  BinaryQueryObjectFilterClause,\n} from '@superset-ui/core';\nimport Echart from '../components/Echart';\nimport { BigNumberVizProps } from './types';\nimport { EventHandlers } from '../types';\n\nconst defaultNumberFormatter = getNumberFormatter();\n\nconst PROPORTION = {\n  // text size: proportion of the chart container sans trendline\n  KICKER: 0.1,\n  HEADER: 0.3,\n  SUBHEADER: 0.125,\n  // trendline size: proportion of the whole chart container\n  TRENDLINE: 0.3,\n};\n\nclass BigNumberVis extends PureComponent<BigNumberVizProps> {\n  static defaultProps = {\n    className: '',\n    headerFormatter: defaultNumberFormatter,\n    formatTime: getTimeFormatter(SMART_DATE_VERBOSE_ID),\n    headerFontSize: PROPORTION.HEADER,\n    kickerFontSize: PROPORTION.KICKER,\n    mainColor: BRAND_COLOR,\n    showTimestamp: false,\n    showTrendLine: false,\n    startYAxisAtZero: true,\n    subheader: '',\n    subheaderFontSize: PROPORTION.SUBHEADER,\n    timeRangeFixed: false,\n  };\n\n  getClassName() {\n    const { className, showTrendLine, bigNumberFallback } = this.props;\n    const names = `superset-legacy-chart-big-number ${className} ${\n      bigNumberFallback ? 'is-fallback-value' : ''\n    }`;\n    if (showTrendLine) return names;\n    return `${names} no-trendline`;\n  }\n\n  createTemporaryContainer() {\n    const container = document.createElement('div');\n    container.className = this.getClassName();\n    container.style.position = 'absolute'; // so it won't disrupt page layout\n    container.style.opacity = '0'; // and not visible\n    return container;\n  }\n\n  renderFallbackWarning() {\n    const { bigNumberFallback, formatTime, showTimestamp } = this.props;\n    if (!formatTime || !bigNumberFallback || showTimestamp) return null;\n    return (\n      <span\n        className=\"alert alert-warning\"\n        role=\"alert\"\n        title={t(\n          `Last available value seen on %s`,\n          formatTime(bigNumberFallback[0]),\n        )}\n      >\n        {t('Not up to date')}\n      </span>\n    );\n  }\n\n  renderKicker(maxHeight: number) {\n    const { timestamp, showTimestamp, formatTime, width } = this.props;\n    if (\n      !formatTime ||\n      !showTimestamp ||\n      typeof timestamp === 'string' ||\n      typeof timestamp === 'boolean'\n    )\n      return null;\n\n    const text = timestamp === null ? '' : formatTime(timestamp);\n\n    const container = this.createTemporaryContainer();\n    document.body.append(container);\n    const fontSize = computeMaxFontSize({\n      text,\n      maxWidth: width,\n      maxHeight,\n      className: 'kicker',\n      container,\n    });\n    container.remove();\n\n    return (\n      <div\n        className=\"kicker\"\n        style={{\n          fontSize,\n          height: 'auto',\n        }}\n      >\n        {text}\n      </div>\n    );\n  }\n\n  renderHeader(maxHeight: number) {\n    const { bigNumber, headerFormatter, width, colorThresholdFormatters } =\n      this.props;\n    // @ts-ignore\n    const text = bigNumber === null ? t('No data') : headerFormatter(bigNumber);\n\n    const hasThresholdColorFormatter =\n      Array.isArray(colorThresholdFormatters) &&\n      colorThresholdFormatters.length > 0;\n\n    let numberColor;\n    if (hasThresholdColorFormatter) {\n      colorThresholdFormatters!.forEach(formatter => {\n        const formatterResult = bigNumber\n          ? formatter.getColorFromValue(bigNumber as number)\n          : false;\n        if (formatterResult) {\n          numberColor = formatterResult;\n        }\n      });\n    } else {\n      numberColor = 'black';\n    }\n\n    const container = this.createTemporaryContainer();\n    document.body.append(container);\n    const fontSize = computeMaxFontSize({\n      text,\n      maxWidth: width * 0.9, // reduced it's max width\n      maxHeight,\n      className: 'header-line',\n      container,\n    });\n    container.remove();\n\n    const onContextMenu = (e: MouseEvent<HTMLDivElement>) => {\n      if (this.props.onContextMenu) {\n        e.preventDefault();\n        this.props.onContextMenu(e.nativeEvent.clientX, e.nativeEvent.clientY);\n      }\n    };\n\n    return (\n      <div\n        className=\"header-line\"\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          fontSize,\n          height: 'auto',\n          color: numberColor,\n        }}\n        onContextMenu={onContextMenu}\n      >\n        {text}\n      </div>\n    );\n  }\n\n  renderSubheader(maxHeight: number) {\n    const { bigNumber, subheader, width, bigNumberFallback } = this.props;\n    let fontSize = 0;\n\n    const NO_DATA_OR_HASNT_LANDED = t(\n      'No data after filtering or data is NULL for the latest time record',\n    );\n    const NO_DATA = t(\n      'Try applying different filters or ensuring your datasource has data',\n    );\n    let text = subheader;\n    if (bigNumber === null) {\n      text = bigNumberFallback ? NO_DATA : NO_DATA_OR_HASNT_LANDED;\n    }\n    if (text) {\n      const container = this.createTemporaryContainer();\n      document.body.append(container);\n      fontSize = computeMaxFontSize({\n        text,\n        maxWidth: width * 0.9, // max width reduced\n        maxHeight,\n        className: 'subheader-line',\n        container,\n      });\n      container.remove();\n\n      return (\n        <div\n          className=\"subheader-line\"\n          style={{\n            fontSize,\n            height: maxHeight,\n          }}\n        >\n          {text}\n        </div>\n      );\n    }\n    return null;\n  }\n\n  renderTrendline(maxHeight: number) {\n    const { width, trendLineData, echartOptions, refs } = this.props;\n\n    // if can't find any non-null values, no point rendering the trendline\n    if (!trendLineData?.some(d => d[1] !== null)) {\n      return null;\n    }\n\n    const eventHandlers: EventHandlers = {\n      contextmenu: eventParams => {\n        if (this.props.onContextMenu) {\n          eventParams.event.stop();\n          const { data } = eventParams;\n          if (data) {\n            const pointerEvent = eventParams.event.event;\n            const drillToDetailFilters: BinaryQueryObjectFilterClause[] = [];\n            drillToDetailFilters.push({\n              col: this.props.formData?.granularitySqla,\n              grain: this.props.formData?.timeGrainSqla,\n              op: '==',\n              val: data[0],\n              formattedVal: this.props.xValueFormatter?.(data[0]),\n            });\n            this.props.onContextMenu(\n              pointerEvent.clientX,\n              pointerEvent.clientY,\n              { drillToDetail: drillToDetailFilters },\n            );\n          }\n        }\n      },\n    };\n\n    return (\n      echartOptions && (\n        <Echart\n          refs={refs}\n          width={Math.floor(width)}\n          height={maxHeight}\n          echartOptions={echartOptions}\n          eventHandlers={eventHandlers}\n        />\n      )\n    );\n  }\n\n  render() {\n    const {\n      showTrendLine,\n      height,\n      kickerFontSize,\n      headerFontSize,\n      subheaderFontSize,\n    } = this.props;\n    const className = this.getClassName();\n\n    if (showTrendLine) {\n      const chartHeight = Math.floor(PROPORTION.TRENDLINE * height);\n      const allTextHeight = height - chartHeight;\n\n      return (\n        <div className={className}>\n          <div className=\"text-container\" style={{ height: allTextHeight }}>\n            {this.renderFallbackWarning()}\n            {this.renderKicker(\n              Math.ceil(\n                (kickerFontSize || 0) * (1 - PROPORTION.TRENDLINE) * height,\n              ),\n            )}\n            {this.renderHeader(\n              Math.ceil(headerFontSize * (1 - PROPORTION.TRENDLINE) * height),\n            )}\n            {this.renderSubheader(\n              Math.ceil(\n                subheaderFontSize * (1 - PROPORTION.TRENDLINE) * height,\n              ),\n            )}\n          </div>\n          {this.renderTrendline(chartHeight)}\n        </div>\n      );\n    }\n\n    return (\n      <div className={className} style={{ height }}>\n        {this.renderFallbackWarning()}\n        {this.renderKicker((kickerFontSize || 0) * height)}\n        {this.renderHeader(Math.ceil(headerFontSize * height))}\n        {this.renderSubheader(Math.ceil(subheaderFontSize * height))}\n      </div>\n    );\n  }\n}\n\nexport default styled(BigNumberVis)`\n  ${({ theme }) => `\n    font-family: ${theme.typography.families.sansSerif};\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: flex-start;\n\n    &.no-trendline .subheader-line {\n      padding-bottom: 0.3em;\n    }\n\n    .text-container {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: flex-start;\n      .alert {\n        font-size: ${theme.typography.sizes.s};\n        margin: -0.5em 0 0.4em;\n        line-height: 1;\n        padding: ${theme.gridUnit}px;\n        border-radius: ${theme.gridUnit}px;\n      }\n    }\n\n    .kicker {\n      line-height: 1em;\n      padding-bottom: 2em;\n    }\n\n    .header-line {\n      position: relative;\n      line-height: 1em;\n      white-space: nowrap;\n      margin-bottom:${theme.gridUnit * 2}px;\n      span {\n        position: absolute;\n        bottom: 0;\n      }\n    }\n\n    .subheader-line {\n      line-height: 1em;\n      padding-bottom: 0;\n    }\n\n    &.is-fallback-value {\n      .kicker,\n      .header-line,\n      .subheader-line {\n        opacity: ${theme.opacity.mediumHeavy};\n      }\n    }\n  `}\n`;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  useRef,\n  useEffect,\n  useMemo,\n  forwardRef,\n  useImperativeHandle,\n  useLayoutEffect,\n  useCallback,\n  Ref,\n} from 'react';\n\nimport { styled } from '@superset-ui/core';\nimport { use, init, EChartsType } from 'echarts/core';\nimport {\n  SankeyChart,\n  PieChart,\n  BarChart,\n  FunnelChart,\n  GaugeChart,\n  GraphChart,\n  LineChart,\n  ScatterChart,\n  RadarChart,\n  BoxplotChart,\n  TreeChart,\n  TreemapChart,\n  HeatmapChart,\n  SunburstChart,\n} from 'echarts/charts';\nimport { CanvasRenderer } from 'echarts/renderers';\nimport {\n  TooltipComponent,\n  GridComponent,\n  VisualMapComponent,\n  LegendComponent,\n  DataZoomComponent,\n  ToolboxComponent,\n  GraphicComponent,\n  AriaComponent,\n  MarkAreaComponent,\n  MarkLineComponent,\n} from 'echarts/components';\nimport { LabelLayout } from 'echarts/features';\nimport { EchartsHandler, EchartsProps, EchartsStylesProps } from '../types';\n\nconst Styles = styled.div<EchartsStylesProps>`\n  height: ${({ height }) => height};\n  width: ${({ width }) => width};\n`;\n\nuse([\n  CanvasRenderer,\n  BarChart,\n  BoxplotChart,\n  FunnelChart,\n  GaugeChart,\n  GraphChart,\n  HeatmapChart,\n  LineChart,\n  PieChart,\n  RadarChart,\n  SankeyChart,\n  ScatterChart,\n  SunburstChart,\n  TreeChart,\n  TreemapChart,\n  AriaComponent,\n  DataZoomComponent,\n  GraphicComponent,\n  GridComponent,\n  MarkAreaComponent,\n  MarkLineComponent,\n  LegendComponent,\n  ToolboxComponent,\n  TooltipComponent,\n  VisualMapComponent,\n  LabelLayout,\n]);\n\nfunction Echart(\n  {\n    width,\n    height,\n    echartOptions,\n    eventHandlers,\n    zrEventHandlers,\n    selectedValues = {},\n    refs,\n  }: EchartsProps,\n  ref: Ref<EchartsHandler>,\n) {\n  const divRef = useRef<HTMLDivElement>(null);\n  if (refs) {\n    // eslint-disable-next-line no-param-reassign\n    refs.divRef = divRef;\n  }\n  const chartRef = useRef<EChartsType>();\n  const currentSelection = useMemo(\n    () => Object.keys(selectedValues) || [],\n    [selectedValues],\n  );\n  const previousSelection = useRef<string[]>([]);\n\n  useImperativeHandle(ref, () => ({\n    getEchartInstance: () => chartRef.current,\n  }));\n\n  useEffect(() => {\n    if (!divRef.current) return;\n    if (!chartRef.current) {\n      chartRef.current = init(divRef.current);\n    }\n\n    Object.entries(eventHandlers || {}).forEach(([name, handler]) => {\n      chartRef.current?.off(name);\n      chartRef.current?.on(name, handler);\n    });\n\n    Object.entries(zrEventHandlers || {}).forEach(([name, handler]) => {\n      chartRef.current?.getZr().off(name);\n      chartRef.current?.getZr().on(name, handler);\n    });\n\n    chartRef.current.setOption(echartOptions, true);\n  }, [echartOptions, eventHandlers, zrEventHandlers]);\n\n  // highlighting\n  useEffect(() => {\n    if (!chartRef.current) return;\n    chartRef.current.dispatchAction({\n      type: 'downplay',\n      dataIndex: previousSelection.current.filter(\n        value => !currentSelection.includes(value),\n      ),\n    });\n    if (currentSelection.length) {\n      chartRef.current.dispatchAction({\n        type: 'highlight',\n        dataIndex: currentSelection,\n      });\n    }\n    previousSelection.current = currentSelection;\n  }, [currentSelection]);\n\n  const handleSizeChange = useCallback(\n    ({ width, height }: { width: number; height: number }) => {\n      if (chartRef.current) {\n        chartRef.current.resize({ width, height });\n      }\n    },\n    [],\n  );\n\n  // did mount\n  useEffect(() => {\n    handleSizeChange({ width, height });\n    return () => chartRef.current?.dispose();\n  }, []);\n\n  useLayoutEffect(() => {\n    handleSizeChange({ width, height });\n  }, [width, height, handleSizeChange]);\n\n  return <Styles ref={divRef} height={height} width={width} />;\n}\n\nexport default forwardRef(Echart);\n"],"names":["BRAND_COLOR","decreaseSizeUntil","startSize","computeDimension","condition","size","dimension","computeMaxFontSize","input","idealFontSize","maxWidth","maxHeight","style","rest","Error","Math","floor","fontSize","getTextDimension","dim","width","height","defaultDimension","text","className","container","length","svgNode","hiddenSvgFactory","createInContainer","textNode","textFactory","updateTextNode","getBBoxCeil","setTimeout","removeFromContainer","LazyFactory","constructor","factoryFn","activeNodes","Map","this","document","body","has","entry","get","counter","node","append","set","removeChild","delete","SVG_NS","createElementNS","position","top","left","opacity","pointerEvents","DEFAULT_DIMENSION","getBBox","ceil","STYLE_FIELDS","textContent","getAttribute","setAttribute","removeProperty","filter","field","forEach","defaultNumberFormatter","getNumberFormatter","PROPORTION","BigNumberVis","PureComponent","getClassName","showTrendLine","bigNumberFallback","props","names","createTemporaryContainer","createElement","renderFallbackWarning","formatTime","showTimestamp","_jsx","role","title","t","children","renderKicker","timestamp","remove","renderHeader","bigNumber","headerFormatter","colorThresholdFormatters","numberColor","Array","isArray","formatter","formatterResult","getColorFromValue","display","alignItems","color","onContextMenu","e","preventDefault","nativeEvent","clientX","clientY","renderSubheader","subheader","NO_DATA_OR_HASNT_LANDED","NO_DATA","renderTrendline","trendLineData","echartOptions","refs","some","d","eventHandlers","contextmenu","eventParams","event","stop","data","_this$props$formData","_this$props$formData2","_this$props$xValueFor","_this$props","pointerEvent","drillToDetailFilters","push","col","formData","granularitySqla","grain","timeGrainSqla","op","val","formattedVal","xValueFormatter","call","drillToDetail","Echart","render","kickerFontSize","headerFontSize","subheaderFontSize","chartHeight","allTextHeight","_jsxs","defaultProps","getTimeFormatter","SMART_DATE_VERBOSE_ID","mainColor","startYAxisAtZero","timeRangeFixed","styled","theme","typography","families","sansSerif","sizes","s","gridUnit","mediumHeavy","Styles","div","zrEventHandlers","selectedValues","ref","divRef","useRef","chartRef","currentSelection","useMemo","Object","keys","previousSelection","useImperativeHandle","getEchartInstance","current","useEffect","init","entries","name","handler","_chartRef$current","_chartRef$current2","off","on","_chartRef$current3","_chartRef$current4","getZr","setOption","dispatchAction","type","dataIndex","value","includes","handleSizeChange","useCallback","resize","_chartRef$current5","dispose","useLayoutEffect","use","CanvasRenderer","BarChart","BoxplotChart","FunnelChart","GaugeChart","GraphChart","HeatmapChart","LineChart","PieChart","RadarChart","SankeyChart","ScatterChart","SunburstChart","TreeChart","TreemapChart","AriaComponent","DataZoomComponent","GraphicComponent","GridComponent","MarkAreaComponent","MarkLineComponent","LegendComponent","ToolboxComponent","TooltipComponent","VisualMapComponent","LabelLayout","forwardRef"],"sourceRoot":""}