/*! For license information please see ec75c12e5ab4bcbe5c7c.chunk.js.LICENSE.txt */
(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[1128],{479217:(e,t,a)=>{"use strict";a.d(t,{z:()=>n});const n=e=>{var t;return{columns:e.columns,name:(null==e?void 0:e.datasource_name)||(null==e?void 0:e.name)||"Untitled",dbId:(null==e||null==(t=e.database)?void 0:t.id)||(null==e?void 0:e.dbId),sql:(null==e?void 0:e.sql)||"",catalog:null==e?void 0:e.catalog,schema:null==e?void 0:e.schema}}},279512:function(e,t){var a;!function(n,o){"use strict";function r(){}r.TO_RAD=Math.PI/180,r.TO_DEG=180/Math.PI,r.PI_X2=2*Math.PI,r.PI_DIV4=Math.PI/4;var i=Object.create(r.prototype,{version:{value:"2.0.23"},radius:{value:6378137},minLat:{value:-90},maxLat:{value:90},minLon:{value:-180},maxLon:{value:180},sexagesimalPattern:{value:/^([0-9]{1,3})°\s*([0-9]{1,3}(?:\.(?:[0-9]{1,2}))?)'\s*(([0-9]{1,3}(\.([0-9]{1,4}))?)"\s*)?([NEOSW]?)$/},measures:{value:Object.create(Object.prototype,{m:{value:1},km:{value:.001},cm:{value:100},mm:{value:1e3},mi:{value:1/1609.344},sm:{value:1/1852.216},ft:{value:100/30.48},in:{value:100/2.54},yd:{value:1/.9144}})},prototype:{value:r.prototype},extend:{value:function(e,t){for(var a in e)void 0!==i.prototype[a]&&!0!==t||("function"==typeof e[a]&&"function"==typeof e[a].bind?i.prototype[a]=e[a].bind(i):i.prototype[a]=e[a])}}});void 0===Number.prototype.toRad&&(Number.prototype.toRad=function(){return this*r.TO_RAD}),void 0===Number.prototype.toDeg&&(Number.prototype.toDeg=function(){return this*r.TO_DEG}),i.extend({decimal:{},sexagesimal:{},distance:null,getKeys:function(e){if("[object Array]"==Object.prototype.toString.call(e))return{longitude:e.length>=1?0:o,latitude:e.length>=2?1:o,elevation:e.length>=3?2:o};var t=function(t){var a;return t.every((function(t){return"object"!=typeof e||!e.hasOwnProperty(t)||(a=t,!1)})),a},a=t(["lng","lon","longitude"]),n=t(["lat","latitude"]),r=t(["alt","altitude","elevation","elev"]);return void 0===n&&void 0===a&&void 0===r?o:{latitude:n,longitude:a,elevation:r}},getLat:function(e,t){return!0===t?e[this.getKeys(e).latitude]:this.useDecimal(e[this.getKeys(e).latitude])},latitude:function(e){return this.getLat.call(this,e)},getLon:function(e,t){return!0===t?e[this.getKeys(e).longitude]:this.useDecimal(e[this.getKeys(e).longitude])},longitude:function(e){return this.getLon.call(this,e)},getElev:function(e){return e[this.getKeys(e).elevation]},elevation:function(e){return this.getElev.call(this,e)},coords:function(e,t){var a={latitude:!0===t?e[this.getKeys(e).latitude]:this.useDecimal(e[this.getKeys(e).latitude]),longitude:!0===t?e[this.getKeys(e).longitude]:this.useDecimal(e[this.getKeys(e).longitude])},n=e[this.getKeys(e).elevation];return void 0!==n&&(a.elevation=n),a},ll:function(e,t){return this.coords.call(this,e,t)},validate:function(e){var t=this.getKeys(e);if(void 0===t||void 0===t.latitude||"undefined"===t.longitude)return!1;var a=e[t.latitude],n=e[t.longitude];return!(void 0===a||!this.isDecimal(a)&&!this.isSexagesimal(a)||void 0===n||!this.isDecimal(n)&&!this.isSexagesimal(n)||(a=this.useDecimal(a),n=this.useDecimal(n),a<this.minLat||a>this.maxLat||n<this.minLon||n>this.maxLon))},getDistance:function(e,t,a,n){a=Math.floor(a)||1,n=Math.floor(n)||0;var o,r,l,s,d,c,u,h=this.coords(e),p=this.coords(t),f=6378137,g=6356752.314245,m=1/298.257223563,v=(p.longitude-h.longitude).toRad(),b=Math.atan((1-m)*Math.tan(parseFloat(h.latitude).toRad())),y=Math.atan((1-m)*Math.tan(parseFloat(p.latitude).toRad())),x=Math.sin(b),w=Math.cos(b),C=Math.sin(y),S=Math.cos(y),k=v,E=100;do{var Z=Math.sin(k),_=Math.cos(k);if(0===(c=Math.sqrt(S*Z*(S*Z)+(w*C-x*S*_)*(w*C-x*S*_))))return i.distance=0;o=x*C+w*S*_,r=Math.atan2(c,o),d=o-2*x*C/(s=1-(l=w*S*Z/c)*l),isNaN(d)&&(d=0);var M=m/16*s*(4+m*(4-3*s));u=k,k=v+(1-M)*m*l*(r+M*c*(d+M*o*(2*d*d-1)))}while(Math.abs(k-u)>1e-12&&--E>0);if(0===E)return NaN;var T=s*(f*f-g*g)/(g*g),O=T/1024*(256+T*(T*(74-47*T)-128)),D=g*(1+T/16384*(4096+T*(T*(320-175*T)-768)))*(r-O*c*(d+O/4*(o*(2*d*d-1)-O/6*d*(4*c*c-3)*(4*d*d-3))));if(D=D.toFixed(n),void 0!==this.elevation(e)&&void 0!==this.elevation(t)){var R=Math.abs(this.elevation(e)-this.elevation(t));D=Math.sqrt(D*D+R*R)}return this.distance=Math.round(D*Math.pow(10,n)/a)*a/Math.pow(10,n)},getDistanceSimple:function(e,t,a){a=Math.floor(a)||1;var n=Math.round(Math.acos(Math.sin(this.latitude(t).toRad())*Math.sin(this.latitude(e).toRad())+Math.cos(this.latitude(t).toRad())*Math.cos(this.latitude(e).toRad())*Math.cos(this.longitude(e).toRad()-this.longitude(t).toRad()))*this.radius);return i.distance=Math.floor(Math.round(n/a)*a)},getCenter:function(e){var t=e;if("object"==typeof e&&!(e instanceof Array))for(var a in t=[],e)t.push(this.coords(e[a]));if(!t.length)return!1;var n,o,i,l=0,s=0,d=0;t.forEach((function(e){n=this.latitude(e).toRad(),o=this.longitude(e).toRad(),l+=Math.cos(n)*Math.cos(o),s+=Math.cos(n)*Math.sin(o),d+=Math.sin(n)}),this);var c=t.length;return l/=c,s/=c,d/=c,o=Math.atan2(s,l),i=Math.sqrt(l*l+s*s),{latitude:((n=Math.atan2(d,i))*r.TO_DEG).toFixed(6),longitude:(o*r.TO_DEG).toFixed(6)}},getBounds:function(e){if(!e.length)return!1;var t=this.elevation(e[0]),a={maxLat:-1/0,minLat:1/0,maxLng:-1/0,minLng:1/0};void 0!==t&&(a.maxElev=0,a.minElev=1/0);for(var n=0,o=e.length;n<o;++n)a.maxLat=Math.max(this.latitude(e[n]),a.maxLat),a.minLat=Math.min(this.latitude(e[n]),a.minLat),a.maxLng=Math.max(this.longitude(e[n]),a.maxLng),a.minLng=Math.min(this.longitude(e[n]),a.minLng),t&&(a.maxElev=Math.max(this.elevation(e[n]),a.maxElev),a.minElev=Math.min(this.elevation(e[n]),a.minElev));return a},getCenterOfBounds:function(e){var t=this.getBounds(e),a=t.minLat+(t.maxLat-t.minLat)/2,n=t.minLng+(t.maxLng-t.minLng)/2;return{latitude:parseFloat(a.toFixed(6)),longitude:parseFloat(n.toFixed(6))}},getBoundsOfDistance:function(e,t){var a,n,o=this.latitude(e),i=this.longitude(e),l=o.toRad(),s=i.toRad(),d=t/this.radius,c=l-d,u=l+d,h=this.maxLat.toRad(),p=this.minLat.toRad(),f=this.maxLon.toRad(),g=this.minLon.toRad();if(c>p&&u<h){var m=Math.asin(Math.sin(d)/Math.cos(l));(a=s-m)<g&&(a+=r.PI_X2),(n=s+m)>f&&(n-=r.PI_X2)}else c=Math.max(c,p),u=Math.min(u,h),a=g,n=f;return[{latitude:c.toDeg(),longitude:a.toDeg()},{latitude:u.toDeg(),longitude:n.toDeg()}]},isPointInside:function(e,t){for(var a=!1,n=-1,o=t.length,r=o-1;++n<o;r=n)(this.longitude(t[n])<=this.longitude(e)&&this.longitude(e)<this.longitude(t[r])||this.longitude(t[r])<=this.longitude(e)&&this.longitude(e)<this.longitude(t[n]))&&this.latitude(e)<(this.latitude(t[r])-this.latitude(t[n]))*(this.longitude(e)-this.longitude(t[n]))/(this.longitude(t[r])-this.longitude(t[n]))+this.latitude(t[n])&&(a=!a);return a},preparePolygonForIsPointInsideOptimized:function(e){for(var t=0,a=e.length-1;t<e.length;t++)this.longitude(e[a])===this.longitude(e[t])?(e[t].constant=this.latitude(e[t]),e[t].multiple=0):(e[t].constant=this.latitude(e[t])-this.longitude(e[t])*this.latitude(e[a])/(this.longitude(e[a])-this.longitude(e[t]))+this.longitude(e[t])*this.latitude(e[t])/(this.longitude(e[a])-this.longitude(e[t])),e[t].multiple=(this.latitude(e[a])-this.latitude(e[t]))/(this.longitude(e[a])-this.longitude(e[t]))),a=t},isPointInsideWithPreparedPolygon:function(e,t){for(var a=!1,n=this.longitude(e),o=this.latitude(e),r=0,i=t.length-1;r<t.length;r++)(this.longitude(t[r])<n&&this.longitude(t[i])>=n||this.longitude(t[i])<n&&this.longitude(t[r])>=n)&&(a^=n*t[r].multiple+t[r].constant<o),i=r;return a},isInside:function(){return this.isPointInside.apply(this,arguments)},isPointInCircle:function(e,t,a){return this.getDistance(e,t)<a},withinRadius:function(){return this.isPointInCircle.apply(this,arguments)},getRhumbLineBearing:function(e,t){var a=this.longitude(t).toRad()-this.longitude(e).toRad(),n=Math.log(Math.tan(this.latitude(t).toRad()/2+r.PI_DIV4)/Math.tan(this.latitude(e).toRad()/2+r.PI_DIV4));return Math.abs(a)>Math.PI&&(a=a>0?-1*(r.PI_X2-a):r.PI_X2+a),(Math.atan2(a,n).toDeg()+360)%360},getBearing:function(e,t){return t.latitude=this.latitude(t),t.longitude=this.longitude(t),e.latitude=this.latitude(e),e.longitude=this.longitude(e),(Math.atan2(Math.sin(t.longitude.toRad()-e.longitude.toRad())*Math.cos(t.latitude.toRad()),Math.cos(e.latitude.toRad())*Math.sin(t.latitude.toRad())-Math.sin(e.latitude.toRad())*Math.cos(t.latitude.toRad())*Math.cos(t.longitude.toRad()-e.longitude.toRad())).toDeg()+360)%360},getCompassDirection:function(e,t,a){var n,o;switch(o="circle"==a?this.getBearing(e,t):this.getRhumbLineBearing(e,t),Math.round(o/22.5)){case 1:n={exact:"NNE",rough:"N"};break;case 2:n={exact:"NE",rough:"N"};break;case 3:n={exact:"ENE",rough:"E"};break;case 4:n={exact:"E",rough:"E"};break;case 5:n={exact:"ESE",rough:"E"};break;case 6:n={exact:"SE",rough:"E"};break;case 7:n={exact:"SSE",rough:"S"};break;case 8:n={exact:"S",rough:"S"};break;case 9:n={exact:"SSW",rough:"S"};break;case 10:n={exact:"SW",rough:"S"};break;case 11:n={exact:"WSW",rough:"W"};break;case 12:n={exact:"W",rough:"W"};break;case 13:n={exact:"WNW",rough:"W"};break;case 14:n={exact:"NW",rough:"W"};break;case 15:n={exact:"NNW",rough:"N"};break;default:n={exact:"N",rough:"N"}}return n.bearing=o,n},getDirection:function(e,t,a){return this.getCompassDirection.apply(this,arguments)},orderByDistance:function(e,t){return Object.keys(t).map((function(a){var n=this.getDistance(e,t[a]),o=Object.create(t[a]);return o.distance=n,o.key=a,o}),this).sort((function(e,t){return e.distance-t.distance}))},isPointInLine:function(e,t,a){return(this.getDistance(t,e,1,3)+this.getDistance(e,a,1,3)).toFixed(3)==this.getDistance(t,a,1,3)},isPointNearLine:function(e,t,a,n){return this.getDistanceFromLine(e,t,a)<n},getDistanceFromLine:function(e,t,a){var n=this.getDistance(t,e,1,3),o=this.getDistance(e,a,1,3),r=this.getDistance(t,a,1,3),i=Math.acos((n*n+r*r-o*o)/(2*n*r)),l=Math.acos((o*o+r*r-n*n)/(2*o*r));return i>Math.PI/2?n:l>Math.PI/2?o:Math.sin(i)*n},findNearest:function(e,t,a,n){a=a||0,n=n||1;var o=this.orderByDistance(e,t);return 1===n?o[a]:o.splice(a,n)},getPathLength:function(e){for(var t,a=0,n=0,o=e.length;n<o;++n)t&&(a+=this.getDistance(this.coords(e[n]),t)),t=this.coords(e[n]);return a},getSpeed:function(e,t,a){var n=a&&a.unit||"km";"mph"==n?n="mi":"kmh"==n&&(n="km");var o=i.getDistance(e,t)/(1*t.time/1e3-1*e.time/1e3)*3600;return Math.round(o*this.measures[n]*1e4)/1e4},computeDestinationPoint:function(e,t,a,n){var o=this.latitude(e),r=this.longitude(e);n=void 0===n?this.radius:Number(n);var i=Number(t)/n,l=Number(a).toRad(),s=Number(o).toRad(),d=Number(r).toRad(),c=Math.asin(Math.sin(s)*Math.cos(i)+Math.cos(s)*Math.sin(i)*Math.cos(l)),u=d+Math.atan2(Math.sin(l)*Math.sin(i)*Math.cos(s),Math.cos(i)-Math.sin(s)*Math.sin(c));return u=(u+3*Math.PI)%(2*Math.PI)-Math.PI,{latitude:c.toDeg(),longitude:u.toDeg()}},convertUnit:function(e,t,a){if(0===t)return 0;if(void 0===t){if(null===this.distance)throw new Error("No distance was given");if(0===this.distance)return 0;t=this.distance}if(e=e||"m",a=null==a?4:a,void 0!==this.measures[e])return this.round(t*this.measures[e],a);throw new Error("Unknown unit for conversion.")},useDecimal:function(e){if("[object Array]"===Object.prototype.toString.call(e)){var t=this;return e=e.map((function(e){if(t.isDecimal(e))return t.useDecimal(e);if("object"==typeof e){if(t.validate(e))return t.coords(e);for(var a in e)e[a]=t.useDecimal(e[a]);return e}return t.isSexagesimal(e)?t.sexagesimal2decimal(e):e})),e}if("object"==typeof e&&this.validate(e))return this.coords(e);if("object"==typeof e){for(var a in e)e[a]=this.useDecimal(e[a]);return e}if(this.isDecimal(e))return parseFloat(e);if(!0===this.isSexagesimal(e))return parseFloat(this.sexagesimal2decimal(e));throw new Error("Unknown format.")},decimal2sexagesimal:function(e){if(e in this.sexagesimal)return this.sexagesimal[e];var t=e.toString().split("."),a=Math.abs(t[0]),n=60*("0."+(t[1]||0)),o=n.toString().split(".");return n=Math.floor(n),o=(60*("0."+(o[1]||0))).toFixed(2),this.sexagesimal[e]=a+"° "+n+"' "+o+'"',this.sexagesimal[e]},sexagesimal2decimal:function(e){if(e in this.decimal)return this.decimal[e];var t=new RegExp(this.sexagesimalPattern).exec(e),a=0,n=0;t&&(a=parseFloat(t[2]/60),n=parseFloat(t[4]/3600)||0);var o=(parseFloat(t[1])+a+n).toFixed(8);return o="S"==t[7]||"W"==t[7]?parseFloat(-o):parseFloat(o),this.decimal[e]=o,o},isDecimal:function(e){return e=e.toString().replace(/\s*/,""),!isNaN(parseFloat(e))&&parseFloat(e)==e},isSexagesimal:function(e){return e=e.toString().replace(/\s*/,""),this.sexagesimalPattern.test(e)},round:function(e,t){var a=Math.pow(10,t);return Math.round(e*a)/a}}),void 0!==e.exports?(e.exports=i,"object"==typeof n&&(n.geolib=i)):(a=function(){return i}.apply(t,[]))===o||(e.exports=a)}(this)},441143:e=>{"use strict";e.exports=function(e,t,a,n,o,r,i,l){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[a,n,o,r,i,l],c=0;(s=new Error(t.replace(/%s/g,(function(){return d[c++]})))).name="Invariant Violation"}throw s.framesToPop=1,s}}},554290:(e,t,a)=>{var n=a(406557);e.exports=function(e){return"function"==typeof e?e:n}},966073:(e,t,a)=>{e.exports=a(784486)},784486:(e,t,a)=>{var n=a(477412),o=a(989881),r=a(554290),i=a(701469);e.exports=function(e,t){return(i(e)?n:o)(e,r(t))}},402525:(e,t,a)=>{var n=a(247816),o=a(554290);e.exports=function(e,t){return e&&n(e,o(t))}},422701:(e,t,a)=>{var n=a(555639),o=a(479833),r=/^\s+/,i=n.parseInt;e.exports=function(e,t,a){return a||null==t?t=0:t&&(t=+t),i(o(e).replace(r,""),t||0)}},690233:(e,t,a)=>{"use strict";a.d(t,{Lu:()=>l,tL:()=>r});var n=a(376826),o=a.n(n);const r={CASE_SENSITIVE_EQUAL:7,EQUAL:6,STARTS_WITH:5,WORD_STARTS_WITH:4,CONTAINS:3,ACRONYM:2,MATCHES:1,NO_MATCH:0},i=(e,t)=>String(e.rankedValue).localeCompare(String(t.rankedValue));function l(e,t,a){void 0===a&&(a={});const{keys:n,threshold:o=r.MATCHES,baseSort:l=i,sorter:c=(e=>e.sort(((e,t)=>d(e,t,l))))}=a,h=e.reduce((function(e,i,l){const d=function(e,t,a,n){if(!t)return{rankedValue:e,rank:s(e,a,n),keyIndex:-1,keyThreshold:n.threshold};const o=function(e,t){const a=[];for(let n=0,o=t.length;n<o;n++){const o=t[n],r=p(o),i=u(e,o);for(let e=0,t=i.length;e<t;e++)a.push({itemValue:i[e],attributes:r})}return a}(e,t);return o.reduce(((e,t,o)=>{let{rank:i,rankedValue:l,keyIndex:d,keyThreshold:c}=e,{itemValue:u,attributes:h}=t,p=s(u,a,n),f=l;const{minRanking:g,maxRanking:m,threshold:v}=h;return p<g&&p>=r.MATCHES?p=g:p>m&&(p=m),p>i&&(i=p,d=o,c=v,f=u),{rankedValue:f,rank:i,keyIndex:d,keyThreshold:c}}),{rankedValue:e,rank:r.NO_MATCH,keyIndex:-1,keyThreshold:n.threshold})}(i,n,t,a),{rank:c,keyThreshold:h=o}=d;return c>=h&&e.push({...d,item:i,index:l}),e}),[]);return c(h).map((e=>{let{item:t}=e;return t}))}function s(e,t,a){return e=c(e,a),(t=c(t,a)).length>e.length?r.NO_MATCH:e===t?r.CASE_SENSITIVE_EQUAL:(e=e.toLowerCase())===(t=t.toLowerCase())?r.EQUAL:e.startsWith(t)?r.STARTS_WITH:e.includes(` ${t}`)?r.WORD_STARTS_WITH:e.includes(t)?r.CONTAINS:1===t.length?r.NO_MATCH:function(e){let t="";return e.split(" ").forEach((e=>{e.split("-").forEach((e=>{t+=e.substr(0,1)}))})),t}(e).includes(t)?r.ACRONYM:function(e,t){let a=0,n=0;function o(e,t,n){for(let o=n,r=t.length;o<r;o++)if(t[o]===e)return a+=1,o+1;return-1}const i=o(t[0],e,0);if(i<0)return r.NO_MATCH;n=i;for(let a=1,i=t.length;a<i;a++)if(n=o(t[a],e,n),!(n>-1))return r.NO_MATCH;return function(e){const n=1/e,o=a/t.length;return r.MATCHES+o*n}(n-i)}(e,t)}function d(e,t,a){const{rank:n,keyIndex:o}=e,{rank:r,keyIndex:i}=t;return n===r?o===i?a(e,t):o<i?-1:1:n>r?-1:1}function c(e,t){let{keepDiacritics:a}=t;return e=`${e}`,a||(e=o()(e)),e}function u(e,t){let a;if("object"==typeof t&&(t=t.key),"function"==typeof t)a=t(e);else if(null==e)a=null;else if(Object.hasOwnProperty.call(e,t))a=e[t];else{if(t.includes("."))return function(e,t){const a=e.split(".");let n=[t];for(let e=0,t=a.length;e<t;e++){const t=a[e];let o=[];for(let e=0,a=n.length;e<a;e++){const a=n[e];if(null!=a)if(Object.hasOwnProperty.call(a,t)){const e=a[t];null!=e&&o.push(e)}else"*"===t&&(o=o.concat(a))}n=o}return Array.isArray(n[0])?[].concat(...n):n}(t,e);a=null}return null==a?[]:Array.isArray(a)?a:[String(a)]}l.rankings=r;const h={maxRanking:1/0,minRanking:-1/0};function p(e){return"string"==typeof e?h:{...h,...e}}},253893:(e,t,a)=>{"use strict";a.r(t),a.d(t,{amber:()=>m,black:()=>_,blue:()=>s,blueGrey:()=>w,brown:()=>y,cyan:()=>c,darkIcons:()=>k,darkText:()=>C,deepOrange:()=>b,deepPurple:()=>i,default:()=>M,green:()=>h,grey:()=>x,indigo:()=>l,lightBlue:()=>d,lightGreen:()=>p,lightIcons:()=>E,lightText:()=>S,lime:()=>f,orange:()=>v,pink:()=>o,purple:()=>r,red:()=>n,teal:()=>u,white:()=>Z,yellow:()=>g});var n={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",a100:"#ff8a80",a200:"#ff5252",a400:"#ff1744",a700:"#d50000"},o={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",a100:"#ff80ab",a200:"#ff4081",a400:"#f50057",a700:"#c51162"},r={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",a100:"#ea80fc",a200:"#e040fb",a400:"#d500f9",a700:"#aa00ff"},i={50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",a100:"#b388ff",a200:"#7c4dff",a400:"#651fff",a700:"#6200ea"},l={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",a100:"#8c9eff",a200:"#536dfe",a400:"#3d5afe",a700:"#304ffe"},s={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",a100:"#82b1ff",a200:"#448aff",a400:"#2979ff",a700:"#2962ff"},d={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",a100:"#80d8ff",a200:"#40c4ff",a400:"#00b0ff",a700:"#0091ea"},c={50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",a100:"#84ffff",a200:"#18ffff",a400:"#00e5ff",a700:"#00b8d4"},u={50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",a100:"#a7ffeb",a200:"#64ffda",a400:"#1de9b6",a700:"#00bfa5"},h={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",a100:"#b9f6ca",a200:"#69f0ae",a400:"#00e676",a700:"#00c853"},p={50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",a100:"#ccff90",a200:"#b2ff59",a400:"#76ff03",a700:"#64dd17"},f={50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",a100:"#f4ff81",a200:"#eeff41",a400:"#c6ff00",a700:"#aeea00"},g={50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",a100:"#ffff8d",a200:"#ffff00",a400:"#ffea00",a700:"#ffd600"},m={50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",a100:"#ffe57f",a200:"#ffd740",a400:"#ffc400",a700:"#ffab00"},v={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",a100:"#ffd180",a200:"#ffab40",a400:"#ff9100",a700:"#ff6d00"},b={50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",a100:"#ff9e80",a200:"#ff6e40",a400:"#ff3d00",a700:"#dd2c00"},y={50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723"},x={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"},w={50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238"},C={primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",dividers:"rgba(0, 0, 0, 0.12)"},S={primary:"rgba(255, 255, 255, 1)",secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",dividers:"rgba(255, 255, 255, 0.12)"},k={active:"rgba(0, 0, 0, 0.54)",inactive:"rgba(0, 0, 0, 0.38)"},E={active:"rgba(255, 255, 255, 1)",inactive:"rgba(255, 255, 255, 0.5)"},Z="#ffffff",_="#000000";const M={red:n,pink:o,purple:r,deepPurple:i,indigo:l,blue:s,lightBlue:d,cyan:c,teal:u,green:h,lightGreen:p,lime:f,yellow:g,amber:m,orange:v,deepOrange:b,brown:y,grey:x,blueGrey:w,darkText:C,lightText:S,darkIcons:k,lightIcons:E,white:Z,black:_}},609563:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlphaPicker=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=s(a(667294)),r=s(a(579941)),i=a(1150),l=s(a(382519));function s(e){return e&&e.__esModule?e:{default:e}}var d=t.AlphaPicker=function(e){var t=e.rgb,a=e.hsl,l=e.width,s=e.height,d=e.onChange,c=e.direction,u=e.style,h=e.renderers,p=e.pointer,f=e.className,g=void 0===f?"":f,m=(0,r.default)({default:{picker:{position:"relative",width:l,height:s},alpha:{radius:"2px",style:u}}});return o.default.createElement("div",{style:m.picker,className:"alpha-picker "+g},o.default.createElement(i.Alpha,n({},m.alpha,{rgb:t,hsl:a,pointer:p,renderers:h,onChange:d,direction:c})))};d.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:l.default},t.default=(0,i.ColorWrap)(d)},382519:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlphaPointer=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.AlphaPointer=function(e){var t=e.direction,a=(0,o.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===t});return n.default.createElement("div",{style:a.picker})};t.default=i},788858:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Block=void 0;var n=d(a(667294)),o=d(a(45697)),r=d(a(579941)),i=d(a(264809)),l=a(1150),s=d(a(253014));function d(e){return e&&e.__esModule?e:{default:e}}var c=t.Block=function(e){var t=e.onChange,a=e.onSwatchHover,o=e.hex,d=e.colors,c=e.width,u=e.triangle,h=e.className,p=void 0===h?"":h,f="transparent"===o,g=function(e,a){i.default.isValidHex(e)&&t({hex:e,source:"hex"},a)},m=(0,r.default)({default:{card:{width:c,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:o,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:i.default.getContrastingColor(o),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+o+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},{"hide-triangle":"hide"===u});return n.default.createElement("div",{style:m.card,className:"block-picker "+p},n.default.createElement("div",{style:m.triangle}),n.default.createElement("div",{style:m.head},f&&n.default.createElement(l.Checkboard,{borderRadius:"6px 6px 0 0"}),n.default.createElement("div",{style:m.label},o)),n.default.createElement("div",{style:m.body},n.default.createElement(s.default,{colors:d,onClick:g,onSwatchHover:a}),n.default.createElement(l.EditableInput,{style:{input:m.input},value:o,onChange:g})))};c.propTypes={width:o.default.oneOfType([o.default.string,o.default.number]),colors:o.default.arrayOf(o.default.string),triangle:o.default.oneOf(["top","hide"])},c.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top"},t.default=(0,l.ColorWrap)(c)},253014:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlockSwatches=void 0;var n=l(a(667294)),o=l(a(579941)),r=l(a(435161)),i=a(1150);function l(e){return e&&e.__esModule?e:{default:e}}var s=t.BlockSwatches=function(e){var t=e.colors,a=e.onClick,l=e.onSwatchHover,s=(0,o.default)({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return n.default.createElement("div",{style:s.swatches},(0,r.default)(t,(function(e){return n.default.createElement(i.Swatch,{key:e,color:e,style:s.swatch,onClick:a,onHover:l,focusStyle:{boxShadow:"0 0 4px "+e}})})),n.default.createElement("div",{style:s.clear}))};t.default=s},53891:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome=void 0;var n=c(a(667294)),o=c(a(45697)),r=c(a(579941)),i=a(1150),l=c(a(632564)),s=c(a(614066)),d=c(a(720289));function c(e){return e&&e.__esModule?e:{default:e}}var u=t.Chrome=function(e){var t=e.onChange,a=e.disableAlpha,o=e.rgb,c=e.hsl,u=e.hsv,h=e.hex,p=e.renderers,f=e.className,g=void 0===f?"":f,m=(0,r.default)({default:{picker:{background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",width:"225px",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+o.r+", "+o.g+", "+o.b+", "+o.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},{disableAlpha:a});return n.default.createElement("div",{style:m.picker,className:"chrome-picker "+g},n.default.createElement("div",{style:m.saturation},n.default.createElement(i.Saturation,{style:m.Saturation,hsl:c,hsv:u,pointer:d.default,onChange:t})),n.default.createElement("div",{style:m.body},n.default.createElement("div",{style:m.controls,className:"flexbox-fix"},n.default.createElement("div",{style:m.color},n.default.createElement("div",{style:m.swatch},n.default.createElement("div",{style:m.active}),n.default.createElement(i.Checkboard,{renderers:p}))),n.default.createElement("div",{style:m.toggles},n.default.createElement("div",{style:m.hue},n.default.createElement(i.Hue,{style:m.Hue,hsl:c,pointer:s.default,onChange:t})),n.default.createElement("div",{style:m.alpha},n.default.createElement(i.Alpha,{style:m.Alpha,rgb:o,hsl:c,pointer:s.default,renderers:p,onChange:t})))),n.default.createElement(l.default,{rgb:o,hsl:c,hex:h,onChange:t,disableAlpha:a})))};u.propTypes={disableAlpha:o.default.bool},u.defaultProps={disableAlpha:!1},t.default=(0,i.ColorWrap)(u)},632564:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChromeFields=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=s(a(667294)),r=s(a(579941)),i=s(a(264809)),l=a(1150);function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=t.ChromeFields=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,r=Array(o),l=0;l<o;l++)r[l]=arguments[l];return a=n=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),n.state={view:""},n.toggleViews=function(){"hex"===n.state.view?n.setState({view:"rgb"}):"rgb"===n.state.view?n.setState({view:"hsl"}):"hsl"===n.state.view&&(1===n.props.hsl.a?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(e,t){e.hex?i.default.isValidHex(e.hex)&&n.props.onChange({hex:e.hex,source:"hex"},t):e.r||e.g||e.b?n.props.onChange({r:e.r||n.props.rgb.r,g:e.g||n.props.rgb.g,b:e.b||n.props.rgb.b,source:"rgb"},t):e.a?(e.a<0?e.a=0:e.a>1&&(e.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(100*e.a)/100,source:"rgb"},t)):(e.h||e.s||e.l)&&n.props.onChange({h:e.h||n.props.hsl.h,s:Number(e.s&&e.s||n.props.hsl.s),l:Number(e.l&&e.l||n.props.hsl.l),source:"hsl"},t)},n.showHighlight=function(e){e.target.style.background="#eee"},n.hideHighlight=function(e){e.target.style.background="transparent"},d(n,a)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentDidMount",value:function(){1===this.props.hsl.a&&"hex"!==this.state.view?this.setState({view:"hex"}):"rgb"!==this.state.view&&"hsl"!==this.state.view&&this.setState({view:"rgb"})}},{key:"componentWillReceiveProps",value:function(e){1!==e.hsl.a&&"hex"===this.state.view&&this.setState({view:"rgb"})}},{key:"render",value:function(){var e=this,t=(0,r.default)({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),a=void 0;return"hex"===this.state.view?a=o.default.createElement("div",{style:t.fields,className:"flexbox-fix"},o.default.createElement("div",{style:t.field},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):"rgb"===this.state.view?a=o.default.createElement("div",{style:t.fields,className:"flexbox-fix"},o.default.createElement("div",{style:t.field},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),o.default.createElement("div",{style:t.field},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),o.default.createElement("div",{style:t.field},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),o.default.createElement("div",{style:t.alpha},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):"hsl"===this.state.view&&(a=o.default.createElement("div",{style:t.fields,className:"flexbox-fix"},o.default.createElement("div",{style:t.field},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),o.default.createElement("div",{style:t.field},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"s",value:Math.round(100*this.props.hsl.s)+"%",onChange:this.handleChange})),o.default.createElement("div",{style:t.field},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"l",value:Math.round(100*this.props.hsl.l)+"%",onChange:this.handleChange})),o.default.createElement("div",{style:t.alpha},o.default.createElement(l.EditableInput,{style:{input:t.input,label:t.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),o.default.createElement("div",{style:t.wrap,className:"flexbox-fix"},a,o.default.createElement("div",{style:t.toggle},o.default.createElement("div",{style:t.icon,onClick:this.toggleViews,ref:function(t){return e.icon=t}},o.default.createElement("svg",{style:t.svg,viewBox:"0 0 24 24",onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight},o.default.createElement("path",{ref:function(t){return e.iconUp=t},fill:"#333",d:"M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}),o.default.createElement("path",{ref:function(t){return e.iconDown=t},fill:"#333",d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15Z"})))))}}]),t}(o.default.Component);t.default=c},614066:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChromePointer=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.ChromePointer=function(){var e=(0,o.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return n.default.createElement("div",{style:e.picker})};t.default=i},720289:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChromePointerCircle=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.ChromePointerCircle=function(){var e=(0,o.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return n.default.createElement("div",{style:e.picker})};t.default=i},209703:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Circle=void 0;var n=c(a(667294)),o=c(a(45697)),r=c(a(579941)),i=c(a(435161)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(253893)),s=a(1150),d=c(a(226249));function c(e){return e&&e.__esModule?e:{default:e}}var u=t.Circle=function(e){var t=e.width,a=e.onChange,o=e.onSwatchHover,l=e.colors,s=e.hex,c=e.circleSize,u=e.circleSpacing,h=e.className,p=void 0===h?"":h,f=(0,r.default)({default:{card:{width:t,display:"flex",flexWrap:"wrap",marginRight:-u,marginBottom:-u}}}),g=function(e,t){return a({hex:e,source:"hex"},t)};return n.default.createElement("div",{style:f.card,className:"circle-picker "+p},(0,i.default)(l,(function(e){return n.default.createElement(d.default,{key:e,color:e,onClick:g,onSwatchHover:o,active:s===e.toLowerCase(),circleSize:c,circleSpacing:u})})))};u.propTypes={width:o.default.oneOfType([o.default.string,o.default.number]),circleSize:o.default.number,circleSpacing:o.default.number},u.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[l.red[500],l.pink[500],l.purple[500],l.deepPurple[500],l.indigo[500],l.blue[500],l.lightBlue[500],l.cyan[500],l.teal[500],l.green[500],l.lightGreen[500],l.lime[500],l.yellow[500],l.amber[500],l.orange[500],l.deepOrange[500],l.brown[500],l.blueGrey[500]]},t.default=(0,s.ColorWrap)(u)},226249:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircleSwatch=void 0;var n=l(a(667294)),o=a(579941),r=l(o),i=a(1150);function l(e){return e&&e.__esModule?e:{default:e}}var s=t.CircleSwatch=function(e){var t=e.color,a=e.onClick,o=e.onSwatchHover,l=e.hover,s=e.active,d=e.circleSize,c=e.circleSpacing,u=(0,r.default)({default:{swatch:{width:d,height:d,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+d/2+"px "+t,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+t}}},{hover:l,active:s});return n.default.createElement("div",{style:u.swatch},n.default.createElement(i.Swatch,{style:u.Swatch,color:t,onClick:a,onHover:o,focusStyle:{boxShadow:u.Swatch.boxShadow+", 0 0 5px "+t}}))};s.defaultProps={circleSize:28,circleSpacing:14},t.default=(0,o.handleHover)(s)},757319:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Alpha=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(667294),i=c(r),l=c(a(579941)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(66713)),d=c(a(334349));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=t.Alpha=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];return a=n=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),n.handleChange=function(e,t){var a=s.calculateChange(e,t,n.props,n.container);a&&n.props.onChange&&n.props.onChange(a,e)},n.handleMouseDown=function(e){n.handleChange(e,!0),window.addEventListener("mousemove",n.handleChange),window.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleChange),window.removeEventListener("mouseup",n.handleMouseUp)},u(n,a)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var e=this,t=this.props.rgb,a=(0,l.default)({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+t.r+","+t.g+","+t.b+", 0) 0%,\n           rgba("+t.r+","+t.g+","+t.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:100*t.a+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+t.r+","+t.g+","+t.b+", 0) 0%,\n           rgba("+t.r+","+t.g+","+t.b+", 1) 100%)"},pointer:{left:0,top:100*t.a+"%"}},overwrite:n({},this.props.style)},{vertical:"vertical"===this.props.direction,overwrite:!0});return i.default.createElement("div",{style:a.alpha},i.default.createElement("div",{style:a.checkboard},i.default.createElement(d.default,{renderers:this.props.renderers})),i.default.createElement("div",{style:a.gradient}),i.default.createElement("div",{style:a.container,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},i.default.createElement("div",{style:a.pointer},this.props.pointer?i.default.createElement(this.props.pointer,this.props):i.default.createElement("div",{style:a.slider}))))}}]),t}(r.PureComponent||r.Component);t.default=h},334349:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Checkboard=void 0;var n=i(a(667294)),o=i(a(579941)),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(945704));function i(e){return e&&e.__esModule?e:{default:e}}var l=t.Checkboard=function(e){var t=e.white,a=e.grey,i=e.size,l=e.renderers,s=e.borderRadius,d=e.boxShadow,c=(0,o.default)({default:{grid:{borderRadius:s,boxShadow:d,absolute:"0px 0px 0px 0px",background:"url("+r.get(t,a,i,l.canvas)+") center left"}}});return n.default.createElement("div",{style:c.grid})};l.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}},t.default=l},388288:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorWrap=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(667294),i=d(r),l=d(a(23279)),s=d(a(264809));function d(e){return e&&e.__esModule?e:{default:e}}var c=t.ColorWrap=function(e){var t=function(t){function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.handleChange=function(e,a){if(s.default.simpleCheckForValidColor(e)){var n=s.default.toState(e,e.h||t.state.oldHue);t.setState(n),t.props.onChangeComplete&&t.debounce(t.props.onChangeComplete,n,a),t.props.onChange&&t.props.onChange(n,a)}},t.handleSwatchHover=function(e,a){if(s.default.simpleCheckForValidColor(e)){var n=s.default.toState(e,e.h||t.state.oldHue);t.setState(n),t.props.onSwatchHover&&t.props.onSwatchHover(n,a)}},t.state=n({},s.default.toState(e.color,0)),t.debounce=(0,l.default)((function(e,t,a){e(t,a)}),100),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),o(a,[{key:"componentWillReceiveProps",value:function(e){this.setState(n({},s.default.toState(e.color,this.state.oldHue)))}},{key:"render",value:function(){var t={};return this.props.onSwatchHover&&(t.onSwatchHover=this.handleSwatchHover),i.default.createElement(e,n({},this.props,this.state,{onChange:this.handleChange},t))}}]),a}(r.PureComponent||r.Component);return t.propTypes=n({},e.propTypes),t.defaultProps=n({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),t};t.default=c},427747:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditableInput=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(667294),r=l(o),i=l(a(579941));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var d=t.EditableInput=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.handleBlur=function(){a.state.blurValue&&a.setState({value:a.state.blurValue,blurValue:null})},a.handleChange=function(e){a.props.label?a.props.onChange&&a.props.onChange(s({},a.props.label,e.target.value),e):a.props.onChange&&a.props.onChange(e.target.value,e),a.setState({value:e.target.value})},a.handleKeyDown=function(e){var t=String(e.target.value),n=t.indexOf("%")>-1,o=Number(t.replace(/%/g,""));if(!isNaN(o)){var r=a.props.arrowOffset||1;38===e.keyCode&&(null!==a.props.label?a.props.onChange&&a.props.onChange(s({},a.props.label,o+r),e):a.props.onChange&&a.props.onChange(o+r,e),n?a.setState({value:o+r+"%"}):a.setState({value:o+r})),40===e.keyCode&&(null!==a.props.label?a.props.onChange&&a.props.onChange(s({},a.props.label,o-r),e):a.props.onChange&&a.props.onChange(o-r,e),n?a.setState({value:o-r+"%"}):a.setState({value:o-r}))}},a.handleDrag=function(e){if(a.props.dragLabel){var t=Math.round(a.props.value+e.movementX);t>=0&&t<=a.props.dragMax&&a.props.onChange&&a.props.onChange(s({},a.props.label,t),e)}},a.handleMouseDown=function(e){a.props.dragLabel&&(e.preventDefault(),a.handleDrag(e),window.addEventListener("mousemove",a.handleDrag),window.addEventListener("mouseup",a.handleMouseUp))},a.handleMouseUp=function(){a.unbindEventListeners()},a.unbindEventListeners=function(){window.removeEventListener("mousemove",a.handleDrag),window.removeEventListener("mouseup",a.handleMouseUp)},a.state={value:String(e.value).toUpperCase(),blurValue:String(e.value).toUpperCase()},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.input;e.value!==this.state.value&&(t===document.activeElement?this.setState({blurValue:String(e.value).toUpperCase()}):this.setState({value:String(e.value).toUpperCase(),blurValue:!this.state.blurValue&&String(e.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var e=this,t=(0,i.default)({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return r.default.createElement("div",{style:t.wrap},r.default.createElement("input",{style:t.input,ref:function(t){return e.input=t},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?r.default.createElement("span",{style:t.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),t}(o.PureComponent||o.Component);t.default=d},226358:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hue=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(667294),r=s(o),i=s(a(579941)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(933716));function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=t.Hue=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];return a=n=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),n.handleChange=function(e,t){var a=l.calculateChange(e,t,n.props,n.container);a&&n.props.onChange&&n.props.onChange(a,e)},n.handleMouseDown=function(e){n.handleChange(e,!0),window.addEventListener("mousemove",n.handleChange),window.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},d(n,a)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this,t=this.props.direction,a=void 0===t?"horizontal":t,n=(0,i.default)({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:100*this.props.hsl.h/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-100*this.props.hsl.h/360+100+"%"}}},{vertical:"vertical"===a});return r.default.createElement("div",{style:n.hue},r.default.createElement("div",{className:"hue-"+a,style:n.container,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},r.default.createElement("style",null,"\n            .hue-horizontal {\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n\n            .hue-vertical {\n              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\n                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,\n                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\n            }\n          "),r.default.createElement("div",{style:n.pointer},this.props.pointer?r.default.createElement(this.props.pointer,this.props):r.default.createElement("div",{style:n.slider}))))}}]),t}(o.PureComponent||o.Component);t.default=c},796207:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Raised=void 0;var n=i(a(667294)),o=i(a(45697)),r=i(a(579941));function i(e){return e&&e.__esModule?e:{default:e}}var l=t.Raised=function(e){var t=e.zDepth,a=e.radius,o=e.background,i=e.children,l=(0,r.default)({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+t+"px "+4*t+"px rgba(0,0,0,.24)",borderRadius:a,background:o}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},{"zDepth-1":1===t});return n.default.createElement("div",{style:l.wrap},n.default.createElement("div",{style:l.bg}),n.default.createElement("div",{style:l.content},i))};l.propTypes={background:o.default.string,zDepth:o.default.oneOf([0,1,2,3,4,5]),radius:o.default.number},l.defaultProps={background:"#fff",zDepth:1,radius:2},t.default=l},376659:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Saturation=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(667294),r=d(o),i=d(a(579941)),l=d(a(823493)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(37599));function d(e){return e&&e.__esModule?e:{default:e}}var c=t.Saturation=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleChange=function(e,t){a.props.onChange&&a.throttle(a.props.onChange,s.calculateChange(e,t,a.props,a.container),e)},a.handleMouseDown=function(e){a.handleChange(e,!0),window.addEventListener("mousemove",a.handleChange),window.addEventListener("mouseup",a.handleMouseUp)},a.handleMouseUp=function(){a.unbindEventListeners()},a.throttle=(0,l.default)((function(e,t,a){e(t,a)}),50),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var e=this,t=this.props.style||{},a=t.color,n=t.white,o=t.black,l=t.pointer,s=t.circle,d=(0,i.default)({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-100*this.props.hsv.v+100+"%",left:100*this.props.hsv.s+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:"0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\n            0 0 1px 2px rgba(0,0,0,.4)",borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:a,white:n,black:o,pointer:l,circle:s}},{custom:!!this.props.style});return r.default.createElement("div",{style:d.color,ref:function(t){return e.container=t},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},r.default.createElement("style",null,"\n          .saturation-white {\n            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\n            background: linear-gradient(to right, #fff, rgba(255,255,255,0));\n          }\n          .saturation-black {\n            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\n            background: linear-gradient(to top, #000, rgba(0,0,0,0));\n          }\n        "),r.default.createElement("div",{style:d.white,className:"saturation-white"},r.default.createElement("div",{style:d.black,className:"saturation-black"}),r.default.createElement("div",{style:d.pointer},this.props.pointer?r.default.createElement(this.props.pointer,this.props):r.default.createElement("div",{style:d.circle}))))}}]),t}(o.PureComponent||o.Component);t.default=c},962489:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Swatch=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=s(a(667294)),r=s(a(579941)),i=a(182538),l=a(1150);function s(e){return e&&e.__esModule?e:{default:e}}var d=t.Swatch=function(e){var t=e.color,a=e.style,i=e.onClick,s=void 0===i?function(){}:i,d=e.onHover,c=e.title,u=void 0===c?t:c,h=e.children,p=e.focus,f=e.focusStyle,g=void 0===f?{}:f,m="transparent"===t,v=(0,r.default)({default:{swatch:n({background:t,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},a,p?g:{})}}),b={};return d&&(b.onMouseOver=function(e){return d(t,e)}),o.default.createElement("div",n({style:v.swatch,onClick:function(e){return s(t,e)},title:u,tabIndex:0,onKeyDown:function(e){return 13===e.keyCode&&s(t,e)}},b),h,m&&o.default.createElement(l.Checkboard,{borderRadius:v.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};t.default=(0,i.handleFocus)(d)},1150:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(757319);Object.defineProperty(t,"Alpha",{enumerable:!0,get:function(){return u(n).default}});var o=a(334349);Object.defineProperty(t,"Checkboard",{enumerable:!0,get:function(){return u(o).default}});var r=a(427747);Object.defineProperty(t,"EditableInput",{enumerable:!0,get:function(){return u(r).default}});var i=a(226358);Object.defineProperty(t,"Hue",{enumerable:!0,get:function(){return u(i).default}});var l=a(796207);Object.defineProperty(t,"Raised",{enumerable:!0,get:function(){return u(l).default}});var s=a(376659);Object.defineProperty(t,"Saturation",{enumerable:!0,get:function(){return u(s).default}});var d=a(388288);Object.defineProperty(t,"ColorWrap",{enumerable:!0,get:function(){return u(d).default}});var c=a(962489);function u(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"Swatch",{enumerable:!0,get:function(){return u(c).default}})},399766:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Compact=void 0;var n=u(a(667294)),o=u(a(45697)),r=u(a(579941)),i=u(a(435161)),l=u(a(264809)),s=a(1150),d=u(a(349613)),c=u(a(782018));function u(e){return e&&e.__esModule?e:{default:e}}var h=t.Compact=function(e){var t=e.onChange,a=e.onSwatchHover,o=e.colors,u=e.hex,h=e.rgb,p=e.className,f=void 0===p?"":p,g=(0,r.default)({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}}),m=function(e,a){e.hex?l.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},a):t(e,a)};return n.default.createElement(s.Raised,{style:g.Compact},n.default.createElement("div",{style:g.compact,className:"compact-picker "+f},n.default.createElement("div",null,(0,i.default)(o,(function(e){return n.default.createElement(d.default,{key:e,color:e,active:e.toLowerCase()===u,onClick:m,onSwatchHover:a})})),n.default.createElement("div",{style:g.clear})),n.default.createElement(c.default,{hex:u,rgb:h,onChange:m})))};h.propTypes={colors:o.default.arrayOf(o.default.string)},h.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"]},t.default=(0,s.ColorWrap)(h)},349613:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompactColor=void 0;var n=l(a(667294)),o=l(a(579941)),r=l(a(264809)),i=a(1150);function l(e){return e&&e.__esModule?e:{default:e}}var s=t.CompactColor=function(e){var t=e.color,a=e.onClick,l=void 0===a?function(){}:a,s=e.onSwatchHover,d=e.active,c=(0,o.default)({default:{color:{background:t,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:r.default.getContrastingColor(t),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:d,"color-#FFFFFF":"#FFFFFF"===t,transparent:"transparent"===t});return n.default.createElement(i.Swatch,{style:c.color,color:t,onClick:l,onHover:s,focusStyle:{boxShadow:"0 0 4px "+t}},n.default.createElement("div",{style:c.dot}))};t.default=s},782018:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompactFields=void 0;var n=i(a(667294)),o=i(a(579941)),r=a(1150);function i(e){return e&&e.__esModule?e:{default:e}}var l=t.CompactFields=function(e){var t=e.hex,a=e.rgb,i=e.onChange,l=(0,o.default)({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:t},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),s=function(e,t){e.r||e.g||e.b?i({r:e.r||a.r,g:e.g||a.g,b:e.b||a.b,source:"rgb"},t):i({hex:e.hex,source:"hex"},t)};return n.default.createElement("div",{style:l.fields,className:"flexbox-fix"},n.default.createElement("div",{style:l.active}),n.default.createElement(r.EditableInput,{style:{wrap:l.HEXwrap,input:l.HEXinput,label:l.HEXlabel},label:"hex",value:t,onChange:s}),n.default.createElement(r.EditableInput,{style:{wrap:l.RGBwrap,input:l.RGBinput,label:l.RGBlabel},label:"r",value:a.r,onChange:s}),n.default.createElement(r.EditableInput,{style:{wrap:l.RGBwrap,input:l.RGBinput,label:l.RGBlabel},label:"g",value:a.g,onChange:s}),n.default.createElement(r.EditableInput,{style:{wrap:l.RGBwrap,input:l.RGBinput,label:l.RGBlabel},label:"b",value:a.b,onChange:s}))};t.default=l},19700:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Github=void 0;var n=d(a(667294)),o=d(a(45697)),r=d(a(579941)),i=d(a(435161)),l=a(1150),s=d(a(413255));function d(e){return e&&e.__esModule?e:{default:e}}var c=t.Github=function(e){var t=e.width,a=e.colors,o=e.onChange,l=e.onSwatchHover,d=e.triangle,c=e.className,u=void 0===c?"":c,h=(0,r.default)({default:{card:{width:t,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},{"hide-triangle":"hide"===d,"top-left-triangle":"top-left"===d,"top-right-triangle":"top-right"===d,"bottom-left-triangle":"bottom-left"==d,"bottom-right-triangle":"bottom-right"===d}),p=function(e,t){return o({hex:e,source:"hex"},t)};return n.default.createElement("div",{style:h.card,className:"github-picker "+u},n.default.createElement("div",{style:h.triangleShadow}),n.default.createElement("div",{style:h.triangle}),(0,i.default)(a,(function(e){return n.default.createElement(s.default,{color:e,key:e,onClick:p,onSwatchHover:l})})))};c.propTypes={width:o.default.oneOfType([o.default.string,o.default.number]),colors:o.default.arrayOf(o.default.string),triangle:o.default.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"])},c.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left"},t.default=(0,l.ColorWrap)(c)},413255:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GithubSwatch=void 0;var n=l(a(667294)),o=a(579941),r=l(o),i=a(1150);function l(e){return e&&e.__esModule?e:{default:e}}var s=t.GithubSwatch=function(e){var t=e.hover,a=e.color,o=e.onClick,l=e.onSwatchHover,s={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},d=(0,r.default)({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:s}},{hover:t});return n.default.createElement("div",{style:d.swatch},n.default.createElement(i.Swatch,{color:a,onClick:o,onHover:l,focusStyle:s}))};t.default=(0,o.handleHover)(s)},110565:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HuePicker=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=s(a(667294)),r=s(a(579941)),i=a(1150),l=s(a(788878));function s(e){return e&&e.__esModule?e:{default:e}}var d=t.HuePicker=function(e){var t=e.width,a=e.height,l=e.onChange,s=e.hsl,d=e.direction,c=e.pointer,u=e.className,h=void 0===u?"":u,p=(0,r.default)({default:{picker:{position:"relative",width:t,height:a},hue:{radius:"2px"}}});return o.default.createElement("div",{style:p.picker,className:"hue-picker "+h},o.default.createElement(i.Hue,n({},p.hue,{hsl:s,pointer:c,onChange:function(e){return l({a:1,h:e.h,l:.5,s:1})},direction:d})))};d.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:l.default},t.default=(0,i.ColorWrap)(d)},788878:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SliderPointer=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.SliderPointer=function(e){var t=e.direction,a=(0,o.default)({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:"vertical"===t});return n.default.createElement("div",{style:a.picker})};t.default=i},166142:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0;var n=l(a(667294)),o=l(a(579941)),r=l(a(264809)),i=a(1150);function l(e){return e&&e.__esModule?e:{default:e}}var s=t.Material=function(e){var t=e.onChange,a=e.hex,l=e.rgb,s=e.className,d=void 0===s?"":s,c=(0,o.default)({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+a,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}}),u=function(e,a){e.hex?r.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},a):(e.r||e.g||e.b)&&t({r:e.r||l.r,g:e.g||l.g,b:e.b||l.b,source:"rgb"},a)};return n.default.createElement(i.Raised,null,n.default.createElement("div",{style:c.material,className:"material-picker "+d},n.default.createElement(i.EditableInput,{style:{wrap:c.HEXwrap,input:c.HEXinput,label:c.HEXlabel},label:"hex",value:a,onChange:u}),n.default.createElement("div",{style:c.split,className:"flexbox-fix"},n.default.createElement("div",{style:c.third},n.default.createElement(i.EditableInput,{style:{wrap:c.RGBwrap,input:c.RGBinput,label:c.RGBlabel},label:"r",value:l.r,onChange:u})),n.default.createElement("div",{style:c.third},n.default.createElement(i.EditableInput,{style:{wrap:c.RGBwrap,input:c.RGBinput,label:c.RGBlabel},label:"g",value:l.g,onChange:u})),n.default.createElement("div",{style:c.third},n.default.createElement(i.EditableInput,{style:{wrap:c.RGBwrap,input:c.RGBinput,label:c.RGBlabel},label:"b",value:l.b,onChange:u})))))};t.default=(0,i.ColorWrap)(s)},33165:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Photoshop=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=p(a(667294)),r=p(a(45697)),i=p(a(579941)),l=a(1150),s=p(a(721962)),d=p(a(331804)),c=p(a(240670)),u=p(a(610170)),h=p(a(329628));function p(e){return e&&e.__esModule?e:{default:e}}var f=t.Photoshop=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.state={currentColor:e.hex},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"render",value:function(){var e=this.props.className,t=void 0===e?"":e,a=(0,i.default)({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}});return o.default.createElement("div",{style:a.picker,className:"photoshop-picker "+t},o.default.createElement("div",{style:a.head},this.props.header),o.default.createElement("div",{style:a.body,className:"flexbox-fix"},o.default.createElement("div",{style:a.saturation},o.default.createElement(l.Saturation,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:d.default,onChange:this.props.onChange})),o.default.createElement("div",{style:a.hue},o.default.createElement(l.Hue,{direction:"vertical",hsl:this.props.hsl,pointer:c.default,onChange:this.props.onChange})),o.default.createElement("div",{style:a.controls},o.default.createElement("div",{style:a.top,className:"flexbox-fix"},o.default.createElement("div",{style:a.previews},o.default.createElement(h.default,{rgb:this.props.rgb,currentColor:this.state.currentColor})),o.default.createElement("div",{style:a.actions},o.default.createElement(u.default,{label:"OK",onClick:this.props.onAccept,active:!0}),o.default.createElement(u.default,{label:"Cancel",onClick:this.props.onCancel}),o.default.createElement(s.default,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),t}(o.default.Component);f.propTypes={header:r.default.string},f.defaultProps={header:"Color Picker"},t.default=(0,l.ColorWrap)(f)},610170:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopBotton=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.PhotoshopBotton=function(e){var t=e.onClick,a=e.label,r=e.children,i=e.active,l=(0,o.default)({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:i});return n.default.createElement("div",{style:l.button,onClick:t},a||r)};t.default=i},721962:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopPicker=void 0;var n=l(a(667294)),o=l(a(579941)),r=l(a(264809)),i=a(1150);function l(e){return e&&e.__esModule?e:{default:e}}var s=t.PhotoshopPicker=function(e){var t=e.onChange,a=e.rgb,l=e.hsv,s=e.hex,d=(0,o.default)({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),c=function(e,n){e["#"]?r.default.isValidHex(e["#"])&&t({hex:e["#"],source:"hex"},n):e.r||e.g||e.b?t({r:e.r||a.r,g:e.g||a.g,b:e.b||a.b,source:"rgb"},n):(e.h||e.s||e.v)&&t({h:e.h||l.h,s:e.s||l.s,v:e.v||l.v,source:"hsv"},n)};return n.default.createElement("div",{style:d.fields},n.default.createElement(i.EditableInput,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"h",value:Math.round(l.h),onChange:c}),n.default.createElement(i.EditableInput,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"s",value:Math.round(100*l.s),onChange:c}),n.default.createElement(i.EditableInput,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"v",value:Math.round(100*l.v),onChange:c}),n.default.createElement("div",{style:d.divider}),n.default.createElement(i.EditableInput,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"r",value:a.r,onChange:c}),n.default.createElement(i.EditableInput,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"g",value:a.g,onChange:c}),n.default.createElement(i.EditableInput,{style:{wrap:d.RGBwrap,input:d.RGBinput,label:d.RGBlabel},label:"b",value:a.b,onChange:c}),n.default.createElement("div",{style:d.divider}),n.default.createElement(i.EditableInput,{style:{wrap:d.HEXwrap,input:d.HEXinput,label:d.HEXlabel},label:"#",value:s.replace("#",""),onChange:c}),n.default.createElement("div",{style:d.fieldSymbols},n.default.createElement("div",{style:d.symbol},"°"),n.default.createElement("div",{style:d.symbol},"%"),n.default.createElement("div",{style:d.symbol},"%")))};t.default=s},240670:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopPointerCircle=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.PhotoshopPointerCircle=function(){var e=(0,o.default)({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return n.default.createElement("div",{style:e.pointer},n.default.createElement("div",{style:e.left},n.default.createElement("div",{style:e.leftInside})),n.default.createElement("div",{style:e.right},n.default.createElement("div",{style:e.rightInside})))};t.default=i},331804:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopPointerCircle=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.PhotoshopPointerCircle=function(e){var t=e.hsl,a=(0,o.default)({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":t.l>.5});return n.default.createElement("div",{style:a.picker})};t.default=i},329628:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoshopPreviews=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.PhotoshopPreviews=function(e){var t=e.rgb,a=e.currentColor,r=(0,o.default)({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+t.r+","+t.g+", "+t.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:a,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return n.default.createElement("div",null,n.default.createElement("div",{style:r.label},"new"),n.default.createElement("div",{style:r.swatches},n.default.createElement("div",{style:r.new}),n.default.createElement("div",{style:r.current})),n.default.createElement("div",{style:r.label},"current"))};t.default=i},889753:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sketch=void 0;var n=d(a(667294)),o=d(a(45697)),r=d(a(579941)),i=a(1150),l=d(a(524530)),s=d(a(13067));function d(e){return e&&e.__esModule?e:{default:e}}var c=t.Sketch=function(e){var t=e.width,a=e.rgb,o=e.hex,d=e.hsv,c=e.hsl,u=e.onChange,h=e.onSwatchHover,p=e.disableAlpha,f=e.presetColors,g=e.renderers,m=e.className,v=void 0===m?"":m,b=(0,r.default)({default:{picker:{width:t,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+a.r+","+a.g+","+a.b+","+a.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},{disableAlpha:p});return n.default.createElement("div",{style:b.picker,className:"sketch-picker "+v},n.default.createElement("div",{style:b.saturation},n.default.createElement(i.Saturation,{style:b.Saturation,hsl:c,hsv:d,onChange:u})),n.default.createElement("div",{style:b.controls,className:"flexbox-fix"},n.default.createElement("div",{style:b.sliders},n.default.createElement("div",{style:b.hue},n.default.createElement(i.Hue,{style:b.Hue,hsl:c,onChange:u})),n.default.createElement("div",{style:b.alpha},n.default.createElement(i.Alpha,{style:b.Alpha,rgb:a,hsl:c,renderers:g,onChange:u}))),n.default.createElement("div",{style:b.color},n.default.createElement(i.Checkboard,null),n.default.createElement("div",{style:b.activeColor}))),n.default.createElement(l.default,{rgb:a,hsl:c,hex:o,onChange:u,disableAlpha:p}),n.default.createElement(s.default,{colors:f,onClick:u,onSwatchHover:h}))};c.propTypes={disableAlpha:o.default.bool,width:o.default.oneOfType([o.default.string,o.default.number])},c.defaultProps={disableAlpha:!1,width:200,presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]},t.default=(0,i.ColorWrap)(c)},524530:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SketchFields=void 0;var n=l(a(667294)),o=l(a(579941)),r=l(a(264809)),i=a(1150);function l(e){return e&&e.__esModule?e:{default:e}}var s=t.SketchFields=function(e){var t=e.onChange,a=e.rgb,l=e.hsl,s=e.hex,d=e.disableAlpha,c=(0,o.default)({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:d}),u=function(e,n){e.hex?r.default.isValidHex(e.hex)&&t({hex:e.hex,source:"hex"},n):e.r||e.g||e.b?t({r:e.r||a.r,g:e.g||a.g,b:e.b||a.b,a:a.a,source:"rgb"},n):e.a&&(e.a<0?e.a=0:e.a>100&&(e.a=100),e.a/=100,t({h:l.h,s:l.s,l:l.l,a:e.a,source:"rgb"},n))};return n.default.createElement("div",{style:c.fields,className:"flexbox-fix"},n.default.createElement("div",{style:c.double},n.default.createElement(i.EditableInput,{style:{input:c.input,label:c.label},label:"hex",value:s.replace("#",""),onChange:u})),n.default.createElement("div",{style:c.single},n.default.createElement(i.EditableInput,{style:{input:c.input,label:c.label},label:"r",value:a.r,onChange:u,dragLabel:"true",dragMax:"255"})),n.default.createElement("div",{style:c.single},n.default.createElement(i.EditableInput,{style:{input:c.input,label:c.label},label:"g",value:a.g,onChange:u,dragLabel:"true",dragMax:"255"})),n.default.createElement("div",{style:c.single},n.default.createElement(i.EditableInput,{style:{input:c.input,label:c.label},label:"b",value:a.b,onChange:u,dragLabel:"true",dragMax:"255"})),n.default.createElement("div",{style:c.alpha},n.default.createElement(i.EditableInput,{style:{input:c.input,label:c.label},label:"a",value:Math.round(100*a.a),onChange:u,dragLabel:"true",dragMax:"100"})))};t.default=s},13067:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SketchPresetColors=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o=s(a(667294)),r=s(a(45697)),i=s(a(579941)),l=a(1150);function s(e){return e&&e.__esModule?e:{default:e}}var d=t.SketchPresetColors=function(e){var t=e.colors,a=e.onClick,r=void 0===a?function(){}:a,s=e.onSwatchHover,d=(0,i.default)({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!t||!t.length}),c=function(e,t){r({hex:e,source:"hex"},t)};return o.default.createElement("div",{style:d.colors,className:"flexbox-fix"},t.map((function(e){var t="string"==typeof e?{color:e}:e,a=""+t.color+(t.title||"");return o.default.createElement("div",{key:a,style:d.swatchWrap},o.default.createElement(l.Swatch,n({},t,{style:d.swatch,onClick:c,onHover:s,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+t.color}})))})))};d.propTypes={colors:r.default.arrayOf(r.default.oneOfType([r.default.string,r.default.shape({color:r.default.string,title:r.default.string})])).isRequired},t.default=d},749857:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Slider=void 0;var n=s(a(667294)),o=s(a(579941)),r=a(1150),i=s(a(306457)),l=s(a(277792));function s(e){return e&&e.__esModule?e:{default:e}}var d=t.Slider=function(e){var t=e.hsl,a=e.onChange,l=e.pointer,s=e.className,d=void 0===s?"":s,c=(0,o.default)({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}});return n.default.createElement("div",{className:"slider-picker "+d},n.default.createElement("div",{style:c.hue},n.default.createElement(r.Hue,{style:c.Hue,hsl:t,pointer:l,onChange:a})),n.default.createElement("div",{style:c.swatches},n.default.createElement(i.default,{hsl:t,onClick:a})))};d.defaultProps={pointer:l.default},t.default=(0,r.ColorWrap)(d)},277792:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SliderPointer=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.SliderPointer=function(){var e=(0,o.default)({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return n.default.createElement("div",{style:e.picker})};t.default=i},564377:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SliderSwatch=void 0;var n=r(a(667294)),o=r(a(579941));function r(e){return e&&e.__esModule?e:{default:e}}var i=t.SliderSwatch=function(e){var t=e.hsl,a=e.offset,r=e.onClick,i=void 0===r?function(){}:r,l=e.active,s=e.first,d=e.last,c=(0,o.default)({default:{swatch:{height:"12px",background:"hsl("+t.h+", 50%, "+100*a+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:l,first:s,last:d});return n.default.createElement("div",{style:c.swatch,onClick:function(e){return i({h:t.h,s:.5,l:a,source:"hsl"},e)}})};t.default=i},306457:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SliderSwatches=void 0;var n=i(a(667294)),o=i(a(579941)),r=i(a(564377));function i(e){return e&&e.__esModule?e:{default:e}}var l=t.SliderSwatches=function(e){var t=e.onClick,a=e.hsl,i=(0,o.default)({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}});return n.default.createElement("div",{style:i.swatches},n.default.createElement("div",{style:i.swatch},n.default.createElement(r.default,{hsl:a,offset:".80",active:Math.round(100*a.l)/100==.8&&Math.round(100*a.s)/100==.5,onClick:t,first:!0})),n.default.createElement("div",{style:i.swatch},n.default.createElement(r.default,{hsl:a,offset:".65",active:Math.round(100*a.l)/100==.65&&Math.round(100*a.s)/100==.5,onClick:t})),n.default.createElement("div",{style:i.swatch},n.default.createElement(r.default,{hsl:a,offset:".50",active:Math.round(100*a.l)/100==.5&&Math.round(100*a.s)/100==.5,onClick:t})),n.default.createElement("div",{style:i.swatch},n.default.createElement(r.default,{hsl:a,offset:".35",active:Math.round(100*a.l)/100==.35&&Math.round(100*a.s)/100==.5,onClick:t})),n.default.createElement("div",{style:i.swatch},n.default.createElement(r.default,{hsl:a,offset:".20",active:Math.round(100*a.l)/100==.2&&Math.round(100*a.s)/100==.5,onClick:t,last:!0})),n.default.createElement("div",{style:i.clear}))};t.default=l},993926:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Swatches=void 0;var n=u(a(667294)),o=u(a(45697)),r=u(a(579941)),i=u(a(435161)),l=u(a(264809)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(253893)),d=a(1150),c=u(a(923088));function u(e){return e&&e.__esModule?e:{default:e}}var h=t.Swatches=function(e){var t=e.width,a=e.height,o=e.onChange,s=e.onSwatchHover,u=e.colors,h=e.hex,p=e.className,f=void 0===p?"":p,g=(0,r.default)({default:{picker:{width:t,height:a},overflow:{height:a,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}}),m=function(e,t){l.default.isValidHex(e)&&o({hex:e,source:"hex"},t)};return n.default.createElement("div",{style:g.picker,className:"swatches-picker "+f},n.default.createElement(d.Raised,null,n.default.createElement("div",{style:g.overflow},n.default.createElement("div",{style:g.body},(0,i.default)(u,(function(e){return n.default.createElement(c.default,{key:e.toString(),group:e,active:h,onClick:m,onSwatchHover:s})})),n.default.createElement("div",{style:g.clear})))))};h.propTypes={width:o.default.oneOfType([o.default.string,o.default.number]),height:o.default.oneOfType([o.default.string,o.default.number]),colors:o.default.arrayOf(o.default.arrayOf(o.default.string))},h.defaultProps={width:320,height:240,colors:[[s.red[900],s.red[700],s.red[500],s.red[300],s.red[100]],[s.pink[900],s.pink[700],s.pink[500],s.pink[300],s.pink[100]],[s.purple[900],s.purple[700],s.purple[500],s.purple[300],s.purple[100]],[s.deepPurple[900],s.deepPurple[700],s.deepPurple[500],s.deepPurple[300],s.deepPurple[100]],[s.indigo[900],s.indigo[700],s.indigo[500],s.indigo[300],s.indigo[100]],[s.blue[900],s.blue[700],s.blue[500],s.blue[300],s.blue[100]],[s.lightBlue[900],s.lightBlue[700],s.lightBlue[500],s.lightBlue[300],s.lightBlue[100]],[s.cyan[900],s.cyan[700],s.cyan[500],s.cyan[300],s.cyan[100]],[s.teal[900],s.teal[700],s.teal[500],s.teal[300],s.teal[100]],["#194D33",s.green[700],s.green[500],s.green[300],s.green[100]],[s.lightGreen[900],s.lightGreen[700],s.lightGreen[500],s.lightGreen[300],s.lightGreen[100]],[s.lime[900],s.lime[700],s.lime[500],s.lime[300],s.lime[100]],[s.yellow[900],s.yellow[700],s.yellow[500],s.yellow[300],s.yellow[100]],[s.amber[900],s.amber[700],s.amber[500],s.amber[300],s.amber[100]],[s.orange[900],s.orange[700],s.orange[500],s.orange[300],s.orange[100]],[s.deepOrange[900],s.deepOrange[700],s.deepOrange[500],s.deepOrange[300],s.deepOrange[100]],[s.brown[900],s.brown[700],s.brown[500],s.brown[300],s.brown[100]],[s.blueGrey[900],s.blueGrey[700],s.blueGrey[500],s.blueGrey[300],s.blueGrey[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]]},t.default=(0,d.ColorWrap)(h)},385638:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwatchesColor=void 0;var n=l(a(667294)),o=l(a(579941)),r=l(a(264809)),i=a(1150);function l(e){return e&&e.__esModule?e:{default:e}}var s=t.SwatchesColor=function(e){var t=e.color,a=e.onClick,l=void 0===a?function(){}:a,s=e.onSwatchHover,d=e.first,c=e.last,u=e.active,h=(0,o.default)({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:t,marginBottom:"1px"},check:{fill:r.default.getContrastingColor(t),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{fill:"#333"}},transparent:{check:{fill:"#333"}}},{first:d,last:c,active:u,"color-#FFFFFF":"#FFFFFF"===t,transparent:"transparent"===t});return n.default.createElement(i.Swatch,{color:t,style:h.color,onClick:l,onHover:s,focusStyle:{boxShadow:"0 0 4px "+t}},n.default.createElement("div",{style:h.check},n.default.createElement("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},n.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))))};t.default=s},923088:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwatchesGroup=void 0;var n=l(a(667294)),o=l(a(579941)),r=l(a(435161)),i=l(a(385638));function l(e){return e&&e.__esModule?e:{default:e}}var s=t.SwatchesGroup=function(e){var t=e.onClick,a=e.onSwatchHover,l=e.group,s=e.active,d=(0,o.default)({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return n.default.createElement("div",{style:d.group},(0,r.default)(l,(function(e,o){return n.default.createElement(i.default,{key:e,color:e,active:e.toLowerCase()===s,first:0===o,last:o===l.length-1,onClick:t,onSwatchHover:a})})))};t.default=s},764503:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Twitter=void 0;var n=d(a(667294)),o=d(a(45697)),r=d(a(579941)),i=d(a(435161)),l=d(a(264809)),s=a(1150);function d(e){return e&&e.__esModule?e:{default:e}}var c=t.Twitter=function(e){var t=e.onChange,a=e.onSwatchHover,o=e.hex,d=e.colors,c=e.width,u=e.triangle,h=e.className,p=void 0===h?"":h,f=(0,r.default)({default:{card:{width:c,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},{"hide-triangle":"hide"===u,"top-left-triangle":"top-left"===u,"top-right-triangle":"top-right"===u}),g=function(e,a){l.default.isValidHex(e)&&t({hex:e,source:"hex"},a)};return n.default.createElement("div",{style:f.card,className:"twitter-picker "+p},n.default.createElement("div",{style:f.triangleShadow}),n.default.createElement("div",{style:f.triangle}),n.default.createElement("div",{style:f.body},(0,i.default)(d,(function(e,t){return n.default.createElement(s.Swatch,{key:t,color:e,hex:e,style:f.swatch,onClick:g,onHover:a,focusStyle:{boxShadow:"0 0 4px "+e}})})),n.default.createElement("div",{style:f.hash},"#"),n.default.createElement(s.EditableInput,{style:{input:f.input},value:o.replace("#",""),onChange:g}),n.default.createElement("div",{style:f.clear})))};c.propTypes={width:o.default.oneOfType([o.default.string,o.default.number]),triangle:o.default.oneOf(["hide","top-left","top-right"]),colors:o.default.arrayOf(o.default.string)},c.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left"},t.default=(0,s.ColorWrap)(c)},66713:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateChange=function(e,t,a,n){e.preventDefault();var o=n.clientWidth,r=n.clientHeight,i="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,l="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,s=i-(n.getBoundingClientRect().left+window.pageXOffset),d=l-(n.getBoundingClientRect().top+window.pageYOffset);if("vertical"===a.direction){var c;if(c=d<0?0:d>r?1:Math.round(100*d/r)/100,a.hsl.a!==c)return{h:a.hsl.h,s:a.hsl.s,l:a.hsl.l,a:c,source:"rgb"}}else{var u;if(u=s<0?0:s>o?1:Math.round(100*s/o)/100,a.a!==u)return{h:a.hsl.h,s:a.hsl.s,l:a.hsl.l,a:u,source:"rgb"}}return null}},945704:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={},n=t.render=function(e,t,a,n){if("undefined"==typeof document&&!n)return null;var o=n?new n:document.createElement("canvas");o.width=2*a,o.height=2*a;var r=o.getContext("2d");return r?(r.fillStyle=e,r.fillRect(0,0,o.width,o.height),r.fillStyle=t,r.fillRect(0,0,a,a),r.translate(a,a),r.fillRect(0,0,a,a),o.toDataURL()):null};t.get=function(e,t,o,r){var i=e+"-"+t+"-"+o+(r?"-server":""),l=n(e,t,o,r);return a[i]?a[i]:(a[i]=l,l)}},264809:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.red=void 0;var n=r(a(966073)),o=r(a(717621));function r(e){return e&&e.__esModule?e:{default:e}}t.default={simpleCheckForValidColor:function(e){var t=0,a=0;return(0,n.default)(["r","g","b","a","h","s","l","v"],(function(n){e[n]&&(t+=1,isNaN(e[n])||(a+=1),"s"===n||"l"===n)&&/^\d+%$/.test(e[n])&&(a+=1)})),t===a&&e},toState:function(e,t){var a=e.hex?(0,o.default)(e.hex):(0,o.default)(e),n=a.toHsl(),r=a.toHsv(),i=a.toRgb(),l=a.toHex();return 0===n.s&&(n.h=t||0,r.h=t||0),{hsl:n,hex:"000000"===l&&0===i.a?"transparent":"#"+l,rgb:i,hsv:r,oldHue:e.h||t||n.h,source:e.source}},isValidHex:function(e){var t="#"===String(e).charAt(0)?1:0;return e.length!==4+t&&e.length<7+t&&(0,o.default)(e).isValid()},getContrastingColor:function(e){if(!e)return"#fff";var t=this.toState(e);return"transparent"===t.hex?"rgba(0,0,0,0.4)":(299*t.rgb.r+587*t.rgb.g+114*t.rgb.b)/1e3>=128?"#000":"#fff"}},t.red={hsl:{a:1,h:0,l:.5,s:1},hex:"#ff0000",rgb:{r:255,g:0,b:0,a:1},hsv:{h:0,s:1,v:1,a:1}}},933716:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateChange=function(e,t,a,n){e.preventDefault();var o=n.clientWidth,r=n.clientHeight,i="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,l="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,s=i-(n.getBoundingClientRect().left+window.pageXOffset),d=l-(n.getBoundingClientRect().top+window.pageYOffset);if("vertical"===a.direction){var c=void 0;if(c=d<0?359:d>r?0:360*(-100*d/r+100)/100,a.hsl.h!==c)return{h:c,s:a.hsl.s,l:a.hsl.l,a:a.hsl.a,source:"rgb"}}else{var u=void 0;if(u=s<0?0:s>o?359:100*s/o*360/100,a.hsl.h!==u)return{h:u,s:a.hsl.s,l:a.hsl.l,a:a.hsl.a,source:"rgb"}}return null}},182538:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleFocus=void 0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=(n=a(667294))&&n.__esModule?n:{default:n};function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.handleFocus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(a){function n(){var e,t,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];return t=a=l(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(r))),a.state={focus:!1},a.handleFocus=function(){return a.setState({focus:!0})},a.handleBlur=function(){return a.setState({focus:!1})},l(a,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,a),r(n,[{key:"render",value:function(){return i.default.createElement(t,{onFocus:this.handleFocus,onBlur:this.handleBlur},i.default.createElement(e,o({},this.props,this.state)))}}]),n}(i.default.Component)}},37599:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateChange=function(e,t,a,n){e.preventDefault();var o=n.getBoundingClientRect(),r=o.width,i=o.height,l="number"==typeof e.pageX?e.pageX:e.touches[0].pageX,s="number"==typeof e.pageY?e.pageY:e.touches[0].pageY,d=l-(n.getBoundingClientRect().left+window.pageXOffset),c=s-(n.getBoundingClientRect().top+window.pageYOffset);d<0?d=0:d>r?d=r:c<0?c=0:c>i&&(c=i);var u=100*d/r,h=-100*c/i+100;return{h:a.hsl.h,s:u,v:h,a:a.hsl.a,source:"rgb"}}},24198:(e,t,a)=>{"use strict";t.xS=t.Ie=void 0;a(609563),a(788858),a(209703);var n=a(53891),o=a(399766);Object.defineProperty(t,"Ie",{enumerable:!0,get:function(){return i(o).default}});a(19700),a(110565),a(166142),a(33165);var r=a(889753);Object.defineProperty(t,"xS",{enumerable:!0,get:function(){return i(r).default}});a(749857),a(993926),a(764503),a(388288);function i(e){return e&&e.__esModule?e:{default:e}}i(n).default},524754:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoprefix=void 0;var n,o=(n=a(402525))&&n.__esModule?n:{default:n},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i={borderRadius:function(e){return{msBorderRadius:e,MozBorderRadius:e,OBorderRadius:e,WebkitBorderRadius:e,borderRadius:e}},boxShadow:function(e){return{msBoxShadow:e,MozBoxShadow:e,OBoxShadow:e,WebkitBoxShadow:e,boxShadow:e}},userSelect:function(e){return{WebkitTouchCallout:e,KhtmlUserSelect:e,MozUserSelect:e,msUserSelect:e,WebkitUserSelect:e,userSelect:e}},flex:function(e){return{WebkitBoxFlex:e,MozBoxFlex:e,WebkitFlex:e,msFlex:e,flex:e}},flexBasis:function(e){return{WebkitFlexBasis:e,flexBasis:e}},justifyContent:function(e){return{WebkitJustifyContent:e,justifyContent:e}},transition:function(e){return{msTransition:e,MozTransition:e,OTransition:e,WebkitTransition:e,transition:e}},transform:function(e){return{msTransform:e,MozTransform:e,OTransform:e,WebkitTransform:e,transform:e}},absolute:function(e){var t=e&&e.split(" ");return{position:"absolute",top:t&&t[0],right:t&&t[1],bottom:t&&t[2],left:t&&t[3]}},extend:function(e,t){return t[e]||{extend:e}}},l=t.autoprefix=function(e){var t={};return(0,o.default)(e,(function(e,a){var n={};(0,o.default)(e,(function(e,t){var a=i[t];a?n=r({},n,a(e)):n[t]=e})),t[a]=n})),t};t.default=l},636002:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.active=void 0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=(n=a(667294))&&n.__esModule?n:{default:n};function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=t.active=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(a){function n(){var a,l,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var d=arguments.length,c=Array(d),u=0;u<d;u++)c[u]=arguments[u];return l=s=i(this,(a=n.__proto__||Object.getPrototypeOf(n)).call.apply(a,[this].concat(c))),s.state={active:!1},s.handleMouseDown=function(){return s.setState({active:!0})},s.handleMouseUp=function(){return s.setState({active:!1})},s.render=function(){return r.default.createElement(t,{onMouseDown:s.handleMouseDown,onMouseUp:s.handleMouseUp},r.default.createElement(e,o({},s.props,s.state)))},i(s,l)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,a),n}(r.default.Component)};t.default=l},591765:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hover=void 0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=(n=a(667294))&&n.__esModule?n:{default:n};function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=t.hover=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return function(a){function n(){var a,l,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var d=arguments.length,c=Array(d),u=0;u<d;u++)c[u]=arguments[u];return l=s=i(this,(a=n.__proto__||Object.getPrototypeOf(n)).call.apply(a,[this].concat(c))),s.state={hover:!1},s.handleMouseOver=function(){return s.setState({hover:!0})},s.handleMouseOut=function(){return s.setState({hover:!1})},s.render=function(){return r.default.createElement(t,{onMouseOver:s.handleMouseOver,onMouseOut:s.handleMouseOut},r.default.createElement(e,o({},s.props,s.state)))},i(s,l)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,a),n}(r.default.Component)};t.default=l},214147:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flattenNames=void 0;var n=l(a(747037)),o=l(a(402525)),r=l(a(968630)),i=l(a(435161));function l(e){return e&&e.__esModule?e:{default:e}}var s=t.flattenNames=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=[];return(0,i.default)(t,(function(t){Array.isArray(t)?e(t).map((function(e){return a.push(e)})):(0,r.default)(t)?(0,o.default)(t,(function(e,t){!0===e&&a.push(t),a.push(t+"-"+e)})):(0,n.default)(t)&&a.push(t)})),a};t.default=s},579941:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReactCSS=t.loop=t.handleActive=t.handleHover=t.hover=void 0;var n=d(a(214147)),o=d(a(218556)),r=d(a(524754)),i=d(a(591765)),l=d(a(636002)),s=d(a(657742));function d(e){return e&&e.__esModule?e:{default:e}}t.hover=i.default,t.handleHover=i.default,t.handleActive=l.default,t.loop=s.default;var c=t.ReactCSS=function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];var l=(0,n.default)(a),s=(0,o.default)(e,l);return(0,r.default)(s)};t.default=c},657742:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a={},n=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a[e]=t};return 0===e&&n("first-child"),e===t-1&&n("last-child"),(0===e||e%2==0)&&n("even"),1===Math.abs(e%2)&&n("odd"),n("nth-child",e),a}},218556:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeClasses=void 0;var n=i(a(402525)),o=i(a(150361)),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function i(e){return e&&e.__esModule?e:{default:e}}var l=t.mergeClasses=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=e.default&&(0,o.default)(e.default)||{};return t.map((function(t){var o=e[t];return o&&(0,n.default)(o,(function(e,t){a[t]||(a[t]={}),a[t]=r({},a[t],o[t])})),t})),a};t.default=l},376826:e=>{var t={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Ấ:"A",Ắ:"A",Ẳ:"A",Ẵ:"A",Ặ:"A",Æ:"AE",Ầ:"A",Ằ:"A",Ȃ:"A",Ả:"A",Ạ:"A",Ẩ:"A",Ẫ:"A",Ậ:"A",Ç:"C",Ḉ:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ế:"E",Ḗ:"E",Ề:"E",Ḕ:"E",Ḝ:"E",Ȇ:"E",Ẻ:"E",Ẽ:"E",Ẹ:"E",Ể:"E",Ễ:"E",Ệ:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ḯ:"I",Ȋ:"I",Ỉ:"I",Ị:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",Ố:"O",Ṍ:"O",Ṓ:"O",Ȏ:"O",Ỏ:"O",Ọ:"O",Ổ:"O",Ỗ:"O",Ộ:"O",Ờ:"O",Ở:"O",Ỡ:"O",Ớ:"O",Ợ:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ủ:"U",Ụ:"U",Ử:"U",Ữ:"U",Ự:"U",Ý:"Y",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",ấ:"a",ắ:"a",ẳ:"a",ẵ:"a",ặ:"a",æ:"ae",ầ:"a",ằ:"a",ȃ:"a",ả:"a",ạ:"a",ẩ:"a",ẫ:"a",ậ:"a",ç:"c",ḉ:"c",è:"e",é:"e",ê:"e",ë:"e",ế:"e",ḗ:"e",ề:"e",ḕ:"e",ḝ:"e",ȇ:"e",ẻ:"e",ẽ:"e",ẹ:"e",ể:"e",ễ:"e",ệ:"e",ì:"i",í:"i",î:"i",ï:"i",ḯ:"i",ȋ:"i",ỉ:"i",ị:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ố:"o",ṍ:"o",ṓ:"o",ȏ:"o",ỏ:"o",ọ:"o",ổ:"o",ỗ:"o",ộ:"o",ờ:"o",ở:"o",ỡ:"o",ớ:"o",ợ:"o",ù:"u",ú:"u",û:"u",ü:"u",ủ:"u",ụ:"u",ử:"u",ữ:"u",ự:"u",ý:"y",ÿ:"y",Ā:"A",ā:"a",Ă:"A",ă:"a",Ą:"A",ą:"a",Ć:"C",ć:"c",Ĉ:"C",ĉ:"c",Ċ:"C",ċ:"c",Č:"C",č:"c",C̆:"C",c̆:"c",Ď:"D",ď:"d",Đ:"D",đ:"d",Ē:"E",ē:"e",Ĕ:"E",ĕ:"e",Ė:"E",ė:"e",Ę:"E",ę:"e",Ě:"E",ě:"e",Ĝ:"G",Ǵ:"G",ĝ:"g",ǵ:"g",Ğ:"G",ğ:"g",Ġ:"G",ġ:"g",Ģ:"G",ģ:"g",Ĥ:"H",ĥ:"h",Ħ:"H",ħ:"h",Ḫ:"H",ḫ:"h",Ĩ:"I",ĩ:"i",Ī:"I",ī:"i",Ĭ:"I",ĭ:"i",Į:"I",į:"i",İ:"I",ı:"i",Ĳ:"IJ",ĳ:"ij",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",Ḱ:"K",ḱ:"k",K̆:"K",k̆:"k",Ĺ:"L",ĺ:"l",Ļ:"L",ļ:"l",Ľ:"L",ľ:"l",Ŀ:"L",ŀ:"l",Ł:"l",ł:"l",Ḿ:"M",ḿ:"m",M̆:"M",m̆:"m",Ń:"N",ń:"n",Ņ:"N",ņ:"n",Ň:"N",ň:"n",ŉ:"n",N̆:"N",n̆:"n",Ō:"O",ō:"o",Ŏ:"O",ŏ:"o",Ő:"O",ő:"o",Œ:"OE",œ:"oe",P̆:"P",p̆:"p",Ŕ:"R",ŕ:"r",Ŗ:"R",ŗ:"r",Ř:"R",ř:"r",R̆:"R",r̆:"r",Ȓ:"R",ȓ:"r",Ś:"S",ś:"s",Ŝ:"S",ŝ:"s",Ş:"S",Ș:"S",ș:"s",ş:"s",Š:"S",š:"s",Ţ:"T",ţ:"t",ț:"t",Ț:"T",Ť:"T",ť:"t",Ŧ:"T",ŧ:"t",T̆:"T",t̆:"t",Ũ:"U",ũ:"u",Ū:"U",ū:"u",Ŭ:"U",ŭ:"u",Ů:"U",ů:"u",Ű:"U",ű:"u",Ų:"U",ų:"u",Ȗ:"U",ȗ:"u",V̆:"V",v̆:"v",Ŵ:"W",ŵ:"w",Ẃ:"W",ẃ:"w",X̆:"X",x̆:"x",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Y̆:"Y",y̆:"y",Ź:"Z",ź:"z",Ż:"Z",ż:"z",Ž:"Z",ž:"z",ſ:"s",ƒ:"f",Ơ:"O",ơ:"o",Ư:"U",ư:"u",Ǎ:"A",ǎ:"a",Ǐ:"I",ǐ:"i",Ǒ:"O",ǒ:"o",Ǔ:"U",ǔ:"u",Ǖ:"U",ǖ:"u",Ǘ:"U",ǘ:"u",Ǚ:"U",ǚ:"u",Ǜ:"U",ǜ:"u",Ứ:"U",ứ:"u",Ṹ:"U",ṹ:"u",Ǻ:"A",ǻ:"a",Ǽ:"AE",ǽ:"ae",Ǿ:"O",ǿ:"o",Þ:"TH",þ:"th",Ṕ:"P",ṕ:"p",Ṥ:"S",ṥ:"s",X́:"X",x́:"x",Ѓ:"Г",ѓ:"г",Ќ:"К",ќ:"к",A̋:"A",a̋:"a",E̋:"E",e̋:"e",I̋:"I",i̋:"i",Ǹ:"N",ǹ:"n",Ồ:"O",ồ:"o",Ṑ:"O",ṑ:"o",Ừ:"U",ừ:"u",Ẁ:"W",ẁ:"w",Ỳ:"Y",ỳ:"y",Ȁ:"A",ȁ:"a",Ȅ:"E",ȅ:"e",Ȉ:"I",ȉ:"i",Ȍ:"O",ȍ:"o",Ȑ:"R",ȑ:"r",Ȕ:"U",ȕ:"u",B̌:"B",b̌:"b",Č̣:"C",č̣:"c",Ê̌:"E",ê̌:"e",F̌:"F",f̌:"f",Ǧ:"G",ǧ:"g",Ȟ:"H",ȟ:"h",J̌:"J",ǰ:"j",Ǩ:"K",ǩ:"k",M̌:"M",m̌:"m",P̌:"P",p̌:"p",Q̌:"Q",q̌:"q",Ř̩:"R",ř̩:"r",Ṧ:"S",ṧ:"s",V̌:"V",v̌:"v",W̌:"W",w̌:"w",X̌:"X",x̌:"x",Y̌:"Y",y̌:"y",A̧:"A",a̧:"a",B̧:"B",b̧:"b",Ḑ:"D",ḑ:"d",Ȩ:"E",ȩ:"e",Ɛ̧:"E",ɛ̧:"e",Ḩ:"H",ḩ:"h",I̧:"I",i̧:"i",Ɨ̧:"I",ɨ̧:"i",M̧:"M",m̧:"m",O̧:"O",o̧:"o",Q̧:"Q",q̧:"q",U̧:"U",u̧:"u",X̧:"X",x̧:"x",Z̧:"Z",z̧:"z",й:"и",Й:"И",ё:"е",Ё:"Е"},a=Object.keys(t).join("|"),n=new RegExp(a,"g"),o=new RegExp(a,"");function r(e){return t[e]}var i=function(e){return e.replace(n,r)};e.exports=i,e.exports.has=function(e){return!!e.match(o)},e.exports.remove=i},747710:(e,t,a)=>{"use strict";a.d(t,{W:()=>D});var n=a(747037),o=a.n(n),r=a(441609),i=a.n(r),l=a(667294),s=a(287183),d=a(104715),c=a(9875),u=a(774069),h=a(835932),p=a(751995),f=a(431069),g=a(61988),m=a(828216),v=a(730381),b=a.n(v),y=a(115926),x=a.n(y),w=a(611409),C=a(672570),S=a(928241),k=a(112515),E=a(340219),Z=a(427600),_=a(135944);const M=p.iK.div`
  .sdm-body {
    margin: 0 8px;
  }
  .sdm-input {
    margin-left: 45px;
    width: 401px;
  }
  .sdm-autocomplete {
    width: 401px;
    align-self: center;
  }
  .sdm-radio {
    display: block;
    height: 30px;
    margin: 10px 0px;
    line-height: 30px;
  }
  .sdm-overwrite-msg {
    margin: 7px;
  }
  .sdm-overwrite-container {
    flex: 1 1 auto;
    display: flex;
  }
`,T=async(e,t,a,n,o,r)=>{const i=`api/v1/dataset/${t}?override_columns=${r}`,l=JSON.stringify({sql:a,columns:n,owners:o,database_id:e});return(await f.Z.put({endpoint:i,headers:{"Content-Type":"application/json"},body:l})).json.result},O=(0,g.t)("Untitled Dataset"),D=({visible:e,onHide:t,buttonTextOnSave:a,buttonTextOnOverwrite:n,modalDescription:r,datasource:p,openWindow:v=!0,formData:y={}})=>{const D=(0,m.v9)((e=>{var t,a;return(null==(t=e.common)||null==(a=t.conf)?void 0:a.DEFAULT_VIZ_TYPE)||"table"})),R=()=>`${(null==p?void 0:p.name)||O} ${b()().format("L HH:mm:ss")}`,[B,P]=(0,l.useState)(R()),[N,I]=(0,l.useState)(S.fT.SaveNew),[A,L]=(0,l.useState)(!1),[$,F]=(0,l.useState)({}),[j,H]=(0,l.useState)(void 0),[z,X]=(0,l.useState)(!1),W=(0,m.v9)((e=>e.user)),U=(0,m.I0)(),q=e=>{v?window.open(e,"_blank","noreferrer"):window.location.href=e},V={...S.C9,...y||{}},G=(0,l.useCallback)((async(e="")=>{const{userId:t}=W,a=x().encode({filters:[{col:"table_name",opr:"ct",value:e},{col:"owners",opr:"rel_m_m",value:t}],order_column:"changed_on_delta_humanized",order_direction:"desc"});return f.Z.get({endpoint:`/api/v1/dataset/?q=${a}`}).then((e=>({data:e.json.result.map((e=>({value:e.table_name,label:e.table_name,datasetid:e.id,owners:e.owners}))),totalCount:e.json.count})))}),[W]),K=N===S.fT.SaveNew&&0===B.length||N===S.fT.OverwriteDataset&&i()(j);return(0,_.tZ)(u.default,{show:e,title:(0,g.t)("Save or Overwrite Dataset"),onHide:t,footer:(0,_.BX)(_.HY,{children:[N===S.fT.SaveNew&&(0,_.tZ)(h.Z,{disabled:K,buttonStyle:"primary",onClick:()=>{var e,a;X(!0);const n=null!=(e=null==p?void 0:p.columns)?e:[];let r;if(o()(null==p?void 0:p.templateParams)){const e=JSON.parse(p.templateParams);e._filters&&(delete e._filters,r=JSON.stringify(e))}U((0,w.createDatasource)({sql:p.sql,dbId:p.dbId||(null==p||null==(a=p.database)?void 0:a.id),catalog:null==p?void 0:p.catalog,schema:null==p?void 0:p.schema,templateParams:r,datasourceName:B})).then((e=>(0,E.nv)(e.id,"table",{...V,datasource:`${e.id}__table`,..."table"===D&&{all_columns:n.map((e=>e.column_name))}}))).then((e=>{X(!1);const a=(0,k.y8)(null,{[Z.KD.formDataKey.name]:e});q(a),P(R()),t()})).catch((()=>{X(!1),(0,C.Gb)((0,g.t)("An error occurred saving dataset"))}))},loading:z,children:a}),N===S.fT.OverwriteDataset&&(0,_.BX)(_.HY,{children:[A&&(0,_.tZ)(h.Z,{onClick:()=>{L(!1),F({})},children:(0,g.t)("Back")}),(0,_.tZ)(h.Z,{className:"md",buttonStyle:"primary",onClick:async()=>{var e,a,n;if(!A)return void L(!0);X(!0);const[,o]=await Promise.all([T(null==p?void 0:p.dbId,null==$?void 0:$.datasetid,null==p?void 0:p.sql,null==p||null==(e=p.columns)?void 0:e.map((e=>({column_name:e.column_name,type:e.type,is_dttm:e.is_dttm}))),null==$||null==(a=$.owners)?void 0:a.map((e=>e.id)),!0),(0,E.nv)($.datasetid,"table",{...V,datasource:`${$.datasetid}__table`,..."table"===D&&{all_columns:null==p||null==(n=p.columns)?void 0:n.map((e=>e.column_name))}})]);X(!1);const r=(0,k.y8)(null,{[Z.KD.formDataKey.name]:o});q(r),L(!1),P(R()),t()},disabled:K,loading:z,children:n})]})]}),children:(0,_.BX)(M,{children:[!A&&(0,_.BX)("div",{className:"sdm-body",children:[r&&(0,_.tZ)("div",{className:"sdm-prompt",children:r}),(0,_.BX)(s.Y.Group,{onChange:e=>{I(Number(e.target.value))},value:N,children:[(0,_.BX)(s.Y,{className:"sdm-radio",value:1,children:[(0,g.t)("Save as new"),(0,_.tZ)(c.II,{className:"sdm-input",value:B,onChange:e=>{P(e.target.value)},disabled:1!==N})]}),(0,_.BX)("div",{className:"sdm-overwrite-container",children:[(0,_.tZ)(s.Y,{className:"sdm-radio",value:2,children:(0,g.t)("Overwrite existing")}),(0,_.tZ)("div",{className:"sdm-autocomplete",children:(0,_.tZ)(d.qb,{allowClear:!0,showSearch:!0,placeholder:(0,g.t)("Select or type dataset name"),ariaLabel:(0,g.t)("Existing dataset"),onChange:(e,t)=>{F(t),H(e)},options:e=>G(e),value:j,filterOption:(e,t)=>t.value.toLowerCase().includes(e.toLowerCase()),disabled:2!==N,getPopupContainer:()=>document.body})})]})]})]}),A&&(0,_.tZ)("div",{className:"sdm-overwrite-msg",children:(0,g.t)("Are you sure you want to overwrite this dataset?")})]})})}},305492:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var n=a(667294),o=a(751995),r=a(737921),i=a(444814),l=a(135944);const s=(0,o.iK)(r.Z)`
  text-align: left;
  font-family: ${({theme:e})=>e.typography.families.monospace};
`;function d({endTime:e,isRunning:t,startTime:a,status:o="success"}){const[r,d]=(0,n.useState)("00:00:00.00"),c=(0,n.useRef)();return(0,n.useEffect)((()=>{const n=()=>{c.current&&(clearInterval(c.current),c.current=void 0)};return t&&(c.current=setInterval((()=>{if(a){const o=e||(0,i.zO)();a<o&&d((0,i.zQ)(a,o)),t||n()}}),30)),n}),[e,t,a]),(0,l.tZ)(s,{type:o,role:"timer",children:r})}},708976:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Js});var n=a(667294),o=a(828216),r=a(616550),i=a(237731),l=a(522102),s=a(61988),d=a(844818),c=a(677205),u=a(838703),h=a(672570),p=a(23525),f=a(427600),g=a(991914),m=a(643399);const v={form_data:{name:"form_data",parser:e=>{const t=JSON.parse(e);if(t.datasource){const[e,a]=t.datasource.split("__");t.datasource_id=e,t.datasource_type=a,delete t.datasource}return t}},slice_id:{name:"slice_id"},datasource_id:{name:"datasource_id"},datasource_type:{name:"datasource_type"},datasource:{name:"datasource",parser:e=>{const[t,a]=e.split("__");return{datasource_id:t,datasource_type:a}}},form_data_key:{name:"form_data_key"},permalink_key:{name:"permalink_key"},viz_type:{name:"viz_type"},dashboard_id:{name:"dashboard_id"}},b={p:"permalink_key",table:"datasource_id"},y=e=>{const t=new URLSearchParams(e);return Array.from(t.keys()).reduce(((e,a)=>{var n;const o=t.get(a);if(null===o)return e;let r;try{var i,l,s;r=null!=(i=null==(l=(s=v[a]).parser)?void 0:l.call(s,o))?i:o}catch{r=o}if("object"==typeof r)return{...e,...r};const d=(null==(n=v[a])?void 0:n.name)||a;return{...e,[d]:r}}),{})},x=(e=window.location)=>{return new URLSearchParams(Object.entries({...y(e.search),...(t=e.pathname,Object.keys(b).reduce(((e,a)=>{const n=new RegExp(`/(${a})/(\\w+)`),o=t.match(n);return null!=o&&o[2]?{...e,[b[a]]:o[2]}:e}),{}))}).map((e=>e.join("="))).join("&"));var t};var w=a(476445),C=a(478718),S=a.n(C),k=a(957557),E=a.n(k),Z=a(637005),_=a.n(Z),M=a(618446),T=a.n(M),O=a(23279),D=a.n(O),R=a(45697),B=a.n(R),P=a(14890),N=a(751995),I=a(211965),A=a(68492),L=a(785716),$=a(504756),F=a(28291),j=a(929119),H=a(514278),z=a(358593),X=a(313322),W=a(961337),U=a(269856),q=a(599543),V=a(797381),G=a(203741),K=a(693967),Y=a.n(K),Q=a(452256),J=a(550810),ee=a(602275),te=a(301510),ae=a(340219),ne=a(199068),oe=a(112515),re=a(410331),ie=a(200651),le=a(955633),se=a(906954),de=a(414114),ce=a(240323),ue=a(593185),he=a(311064),pe=a(46078),fe=a(355786),ge=a(431069),me=a(140730),ve=a(229487),be=a(747710),ye=a(479217),xe=a(775701),we=a(21496),Ce=a(989555),Se=a(737921),ke=a(730381),Ee=a.n(ke),Ze=a(135944);const _e=({cachedTimestamp:e})=>{const t=e?(0,Ze.BX)("span",{children:[(0,s.t)("Loaded data cached"),(0,Ze.BX)("b",{children:[" ",Ee().utc(e).fromNow()]})]}):(0,s.t)("Loaded from cache");return(0,Ze.BX)("span",{children:[t,". ",(0,s.t)("Click to force-refresh")]})},Me=({className:e,onClick:t,cachedTimestamp:a})=>{const[o,r]=(0,n.useState)(!1),i=o?"primary":"default";return(0,Ze.tZ)(z.u,{title:(0,Ze.tZ)(_e,{cachedTimestamp:a}),id:"cache-desc-tooltip",children:(0,Ze.BX)(Se.Z,{className:`${e}`,type:i,onClick:t,onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),children:[(0,s.t)("Cached")," ",(0,Ze.tZ)("i",{className:"fa fa-refresh"})]})})};var Te=a(305492);const Oe={failed:"danger",loading:"warning",success:"success"},De=(0,n.forwardRef)((({queriesResponse:e,chartStatus:t,chartUpdateStartTime:a,chartUpdateEndTime:n,refreshCachedQuery:o,rowLimit:r},i)=>{const l="loading"===t,s=null==e?void 0:e[0];return(0,Ze.tZ)("div",{ref:i,children:(0,Ze.BX)("div",{css:e=>I.iv`
            display: flex;
            justify-content: flex-end;
            padding-bottom: ${4*e.gridUnit}px;
            & .ant-tag:last-of-type {
              margin: 0;
            }
          `,children:[!l&&s&&(0,Ze.tZ)(Ce.Z,{rowcount:Number(s.sql_rowcount)||0,limit:Number(r)||0}),!l&&(null==s?void 0:s.is_cached)&&(0,Ze.tZ)(Me,{onClick:o,cachedTimestamp:s.cached_dttm}),(0,Ze.tZ)(Te.Z,{startTime:a,endTime:n,isRunning:l,status:Oe[t]})]})})}));var Re=a(835932);const Be=N.iK.div`
  ${({theme:e})=>I.iv`
    margin: ${4*e.gridUnit}px;
    padding: ${4*e.gridUnit}px;

    border: 1px solid ${e.colors.info.base};
    background-color: ${e.colors.info.light2};
    border-radius: 2px;

    color: ${e.colors.info.dark2};
    font-size: ${e.typography.sizes.m}px;

    p {
      margin-bottom: ${e.gridUnit}px;
    }

    & a,
    & span[role='button'] {
      color: inherit;
      text-decoration: underline;
      &:hover {
        color: ${e.colors.info.dark1};
      }
    }

    &.alert-type-warning {
      border-color: ${e.colors.alert.base};
      background-color: ${e.colors.alert.light2};

      p {
        color: ${e.colors.alert.dark2};
      }

      & a:hover,
      & span[role='button']:hover {
        color: ${e.colors.alert.dark1};
      }
    }
  `}
`,Pe=N.iK.div`
  display: flex;
  justify-content: flex-end;
  button {
    line-height: 1;
  }
`,Ne=N.iK.p`
  font-weight: ${({theme:e})=>e.typography.weights.bold};
`,Ie={warning:"warning",danger:"danger"},Ae=(0,n.forwardRef)((({title:e,bodyText:t,primaryButtonAction:a,secondaryButtonAction:n,primaryButtonText:o,secondaryButtonText:r,type:i="info",className:l=""},s)=>(0,Ze.BX)(Be,{className:`alert-type-${i} ${l}`,ref:s,children:[(0,Ze.tZ)(Ne,{children:e}),(0,Ze.tZ)("p",{children:t}),o&&a&&(0,Ze.BX)(Pe,{children:[n&&r&&(0,Ze.tZ)(Re.Z,{buttonStyle:"link",buttonSize:"small",onClick:n,children:r}),(0,Ze.tZ)(Re.Z,{buttonStyle:i in Ie?Ie[i]:"primary",buttonSize:"small",onClick:a,children:o})]})]})));var Le=a(899612);const $e={actions:B().object.isRequired,onQuery:B().func,can_overwrite:B().bool.isRequired,can_download:B().bool.isRequired,datasource:B().object,dashboardId:B().number,column_formats:B().object,containerId:B().string.isRequired,isStarred:B().bool.isRequired,slice:B().object,sliceName:B().string,table_name:B().string,vizType:B().string.isRequired,form_data:B().object,ownState:B().object,standalone:B().bool,force:B().bool,timeout:B().number,chartIsStale:B().bool,chart:ee.$6,errorMessage:B().node,triggerRender:B().bool},Fe=1.25,je=[100,0],He=[300,65],ze=N.iK.div`
  display: flex;
  flex-direction: column;
  align-items: stretch;
  align-content: stretch;
  overflow: auto;
  box-shadow: none;
  height: 100%;

  & > div {
    height: 100%;
  }

  .gutter {
    border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    border-bottom: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    width: ${({theme:e})=>9*e.gridUnit}px;
    margin: ${({theme:e})=>e.gridUnit*Fe}px auto;
  }

  .gutter.gutter-vertical {
    display: ${({showSplite:e})=>e?"block":"none"};
    cursor: row-resize;
  }

  .ant-collapse {
    .ant-tabs {
      height: 100%;
      .ant-tabs-nav {
        padding-left: ${({theme:e})=>5*e.gridUnit}px;
        margin: 0;
      }
      .ant-tabs-content-holder {
        overflow: hidden;
        .ant-tabs-content {
          height: 100%;
        }
      }
    }
  }
`;var Xe={name:"1wbll7q",styles:"text-decoration:underline"};const We=({chart:e,slice:t,vizType:a,ownState:o,triggerRender:r,force:i,datasource:l,errorMessage:d,form_data:c,onQuery:u,actions:h,timeout:p,standalone:f,chartIsStale:g,chartAlert:m,can_download:v})=>{var b;const y=(0,N.Fg)(),x=y.gridUnit*Fe,w=y.gridUnit*Fe,{ref:C,observerRef:S,width:k,height:E}=function(){const e=(0,n.useRef)(),[{width:t,height:a},o]=(0,n.useState)({}),r=(0,n.useCallback)((()=>{if(e.current){const{width:t,height:a}=(null==e.current.getBoundingClientRect?void 0:e.current.getBoundingClientRect())||{};o({width:t,height:a})}}),[]),{ref:i}=(0,Le.NB)({refreshMode:"debounce",refreshRate:300,onResize:r});return{ref:e,observerRef:i,width:t,height:a}}(),[Z,_]=(0,n.useState)((0,ue.cr)(ue.TT.DatapanelClosedByDefault)?je:(0,W.rV)(W.dR.ChartSplitSizes,je)),[M,T]=(0,n.useState)(!(0,ue.cr)(ue.TT.DatapanelClosedByDefault)&&(0,W.rV)(W.dR.IsDatapanelOpen,!1)),[O,D]=(0,n.useState)(!1),R=(0,he.Z)(),{useLegacyApi:B}=null!=(b=R.get(a))?b:{},P=B&&l.type!==pe.i9.Table,A=!m&&g&&!P&&"failed"!==e.chartStatus&&(0,fe.Z)(e.queriesResponse).length>0,L=(0,n.useCallback)((async function(){if(t&&null===t.query_context){const e=(0,oe.u)({formData:t.form_data,force:i,resultFormat:"json",resultType:"full",setDataMask:null,ownState:null});await ge.Z.put({endpoint:`/api/v1/chart/${t.slice_id}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({query_context:JSON.stringify(e),query_context_generation:!0})})}}),[t]);(0,n.useEffect)((()=>{L()}),[L]),(0,n.useEffect)((()=>{(0,W.LS)(W.dR.ChartSplitSizes,Z)}),[Z]);const $=(0,n.useCallback)((e=>{_(e)}),[]),F=(0,n.useCallback)((()=>{h.setForceQuery(!0),h.postChartFormData(c,!0,p,e.id,void 0,o),h.updateQueryFormData(c,e.id)}),[h,e.id,c,o,p]),j=(0,n.useCallback)((e=>{let t;t=e?[60,40]:je,_(t),T(e)}),[]),H=(0,n.useCallback)((()=>(0,Ze.tZ)("div",{css:I.iv`
          min-height: 0;
          flex: 1;
          overflow: auto;
        `,ref:C,children:k&&E&&(0,Ze.tZ)(me.Z,{width:Math.floor(k),height:E,ownState:o,annotationData:e.annotationData,chartAlert:e.chartAlert,chartStackTrace:e.chartStackTrace,chartId:e.id,chartStatus:e.chartStatus,triggerRender:r,force:i,datasource:l,errorMessage:d,formData:c,latestQueryFormData:e.latestQueryFormData,onQuery:u,queriesResponse:e.queriesResponse,chartIsStale:g,setControlValue:h.setControlValue,timeout:p,triggerQuery:e.triggerQuery,vizType:a})})),[h.setControlValue,e.annotationData,e.chartAlert,e.chartStackTrace,e.chartStatus,e.id,e.latestQueryFormData,e.queriesResponse,e.triggerQuery,g,E,C,k,l,d,i,c,u,o,p,r,a]),z=(0,n.useMemo)((()=>(0,Ze.BX)("div",{className:"panel-body",css:I.iv`
          display: flex;
          flex-direction: column;
        `,ref:S,children:[P&&(0,Ze.tZ)(ve.Z,{message:(0,s.t)("Chart type requires a dataset"),type:"error",css:e=>I.iv`
              margin: 0 0 ${4*e.gridUnit}px 0;
            `,description:(0,Ze.BX)(Ze.HY,{children:[(0,s.t)("This chart type is not supported when using an unsaved query as a chart source. "),(0,Ze.tZ)("span",{role:"button",tabIndex:0,onClick:()=>D(!0),css:Xe,children:(0,s.t)("Create a dataset")}),(0,s.t)(" to visualize your data.")]})}),A&&(0,Ze.tZ)(Ae,{title:d?(0,s.t)("Required control values have been removed"):(0,s.t)("Your chart is not up to date"),bodyText:d?(0,xe.J)(!1):(0,Ze.BX)("span",{children:[(0,s.t)('You updated the values in the control panel, but the chart was not updated automatically. Run the query by clicking on the "Update chart" button or')," ",(0,Ze.tZ)("span",{role:"button",tabIndex:0,onClick:u,children:(0,s.t)("click here")}),"."]}),type:"warning",css:e=>I.iv`
              margin: 0 0 ${4*e.gridUnit}px 0;
            `}),(0,Ze.tZ)(De,{queriesResponse:e.queriesResponse,chartStatus:e.chartStatus,chartUpdateStartTime:e.chartUpdateStartTime,chartUpdateEndTime:e.chartUpdateEndTime,refreshCachedQuery:F,rowLimit:null==c?void 0:c.row_limit}),H()]})),[S,A,d,u,e.queriesResponse,e.chartStatus,e.chartUpdateStartTime,e.chartUpdateEndTime,F,null==c?void 0:c.row_limit,H]),X=(0,n.useMemo)((()=>H()),[H]),[U,q]=(0,n.useState)(e.latestQueryFormData);(0,n.useEffect)((()=>{r||q(e.latestQueryFormData)}),[e.latestQueryFormData]);const V=(0,n.useCallback)(((e,t,a)=>({[e]:`calc(${t}% - ${a+x}px)`})),[x]);if(f){const e="background-transparent";return document.body.className.split(" ").includes(e)||(document.body.className+=` ${e}`),(0,Ze.tZ)("div",{id:"app",ref:S,children:X})}return(0,Ze.BX)(ze,{className:"panel panel-default chart-container",showSplite:M,children:[(0,Ze.BX)(ce.Z,{sizes:Z,minSize:He,direction:"vertical",gutterSize:w,onDragEnd:$,elementStyle:V,expandToMin:!0,children:[z,(0,Ze.tZ)(we.c9,{ownState:o,queryFormData:U,datasource:l,queryForce:i,onCollapseChange:j,chartStatus:e.chartStatus,errorMessage:d,actions:h,canDownload:v})]}),O&&(0,Ze.tZ)(be.W,{visible:O,onHide:()=>D(!1),buttonTextOnSave:(0,s.t)("Save"),buttonTextOnOverwrite:(0,s.t)("Overwrite"),datasource:(0,ye.z)(l),openWindow:!1,formData:c})]})};We.propTypes=$e;const Ue=We;var qe=a(121804),Ve=a.n(qe),Ge=a(5364),Ke=a(837687),Ye=a(463610),Qe=a(945211),Je=a(349484),et=a(843700),tt=a(171262),at=a(774069);function nt({controls:e}){const t=(0,n.useCallback)((e=>{const t=e&&"shouldStash"in e.props?e.props.children.props:null==e?void 0:e.props;return"HiddenControl"===(null==t?void 0:t.type)||!1===(null==t?void 0:t.isVisible)}),[]),a=e.filter((e=>!t(e))),o=a.length?12/a.length:12;return(0,Ze.tZ)("div",{className:"row",children:e.map(((e,a)=>(0,Ze.tZ)("div",{className:`col-lg-${o} col-xs-12`,style:{display:t(e)?"none":"block"},children:e},a)))})}var ot=a(657368),rt=a(593362),it=a(104715),lt=a(468135),st=a(409882),dt=a(967913);function ct(e){const{selectable:t,children:a,...n}=e,o=(0,N.Fg)(),r={"&.ant-list-item":{padding:`${o.gridUnit+2}px ${3*o.gridUnit}px`,":first-of-type":{borderTopLeftRadius:o.gridUnit,borderTopRightRadius:o.gridUnit},":last-of-type":{borderBottomLeftRadius:o.gridUnit,borderBottomRightRadius:o.gridUnit}}};return t&&(r["&:hover"]={cursor:"pointer",backgroundColor:o.colors.grayscale.light4}),(0,Ze.tZ)(it.aV.Item,{...n,css:r,children:a})}var ut=a(927845);const ht=(0,dt.Z)((()=>a.e(4199).then(a.bind(a,131997))),(()=>(0,Ze.tZ)("div",{style:{width:450,height:368}}))),pt={colorScheme:B().string.isRequired,annotationError:B().object,annotationQuery:B().object,vizType:B().string,validationErrors:B().array,name:B().string.isRequired,actions:B().object,value:B().arrayOf(B().object),onChange:B().func,refreshAnnotationData:B().func};class ft extends n.PureComponent{constructor(e){super(e),this.state={popoverVisible:{},addedAnnotationIndex:null},this.addAnnotationLayer=this.addAnnotationLayer.bind(this),this.removeAnnotationLayer=this.removeAnnotationLayer.bind(this),this.handleVisibleChange=this.handleVisibleChange.bind(this)}componentDidMount(){ht.preload()}UNSAFE_componentWillReceiveProps(e){const{name:t,annotationError:a,validationErrors:n,value:o}=e;Object.keys(a).length&&!n.length&&this.props.actions.setControlValue(t,o,Object.keys(a)),!Object.keys(a).length&&n.length&&this.props.actions.setControlValue(t,o,[])}addAnnotationLayer(e,t){let a=this.props.value;a.includes(e)?a=a.map((a=>a===e?t:a)):(a=[...a,t],this.setState({addedAnnotationIndex:a.length-1})),this.props.refreshAnnotationData({annotation:t,force:!0}),this.props.onChange(a)}handleVisibleChange(e,t){this.setState((a=>({popoverVisible:{...a.popoverVisible,[t]:e}})))}removeAnnotationLayer(e){const t=this.props.value.filter((t=>t!==e)),a=(0,ut.j)();a&&a.style.setProperty("overflow-y","auto","important"),this.props.onChange(t)}renderPopover(e,t,a){const n=(null==t?void 0:t.name)||"_new";return(0,Ze.tZ)("div",{id:`annotation-pop-${n}`,children:(0,Ze.tZ)(ht,{...t,error:a,colorScheme:this.props.colorScheme,vizType:this.props.vizType,addAnnotationLayer:e=>this.addAnnotationLayer(t,e),removeAnnotationLayer:()=>this.removeAnnotationLayer(t),close:()=>{this.handleVisibleChange(!1,e),this.setState({addedAnnotationIndex:null})}})})}renderInfo(e){const{annotationError:t,annotationQuery:a,theme:n}=this.props;return a[e.name]?(0,Ze.tZ)("i",{className:"fa fa-refresh",style:{color:n.colors.primary.base},"aria-hidden":!0}):t[e.name]?(0,Ze.tZ)(st.V,{label:"validation-errors",bsStyle:"danger",tooltip:t[e.name]}):e.show?"":(0,Ze.tZ)("span",{style:{color:n.colors.error.base},children:" Hidden "})}render(){const{addedAnnotationIndex:e}=this.state,t=this.props.value[e],a=this.props.value.map(((e,t)=>(0,Ze.tZ)(ut.Z,{trigger:"click",title:(0,s.t)("Edit annotation layer"),css:e=>({"&:hover":{cursor:"pointer",backgroundColor:e.colors.grayscale.light4}}),content:this.renderPopover(t,e,this.props.annotationError[e.name]),visible:this.state.popoverVisible[t],onVisibleChange:e=>this.handleVisibleChange(e,t),children:(0,Ze.BX)(ct,{selectable:!0,children:[(0,Ze.tZ)("span",{children:e.name}),(0,Ze.tZ)("span",{style:{float:"right"},children:this.renderInfo(e)})]})},t))),n="add";return(0,Ze.tZ)("div",{children:(0,Ze.BX)(it.aV,{bordered:!0,css:e=>({borderRadius:e.gridUnit}),children:[a,(0,Ze.tZ)(ut.Z,{trigger:"click",content:this.renderPopover(n,t),title:(0,s.t)("Add annotation layer"),visible:this.state.popoverVisible[n],destroyTooltipOnHide:!0,onVisibleChange:e=>this.handleVisibleChange(e,n),children:(0,Ze.BX)(ct,{selectable:!0,children:[(0,Ze.tZ)("i",{className:"fa fa-plus"})," ","  ",(0,s.t)("Add annotation layer")]})})]})})}}ft.propTypes=pt,ft.defaultProps={vizType:"",value:[],annotationError:{},annotationQuery:{},onChange:()=>{}};const gt=(0,lt.b)(ft),mt=(0,o.$j)((function({charts:e,explore:t}){var a,n;const o=e[(0,oe.Jp)(t)]||e[0]||{};return{colorScheme:null==(a=t.controls)||null==(n=a.color_scheme)?void 0:n.value,annotationError:o.annotationError,annotationQuery:o.annotationQuery,vizType:t.controls.viz_type.value}}),(function(e){return{refreshAnnotationData:t=>e((0,Q.runAnnotationQuery)(t))}}))(gt);var vt=a(422701),bt=a.n(vt),yt=a(9875),xt=a(482342);const wt=N.iK.div`
  display: flex;
`,Ct=(0,N.iK)(yt.Rn)`
  flex: 1;
  margin-right: ${({theme:e})=>e.gridUnit}px;
`,St=(0,N.iK)(yt.Rn)`
  flex: 1;
  margin-left: ${({theme:e})=>e.gridUnit}px;
`,kt=e=>null==e||"string"==typeof e&&Number.isNaN(bt()(e))?null:Number(e);function Et({onChange:e=(()=>{}),value:t=[null,null],...a}){const[o,r]=(0,n.useState)([kt(t[0]),kt(t[1])]),i=t[0],l=t[1],d=(0,n.useRef)(D()(e,300)).current,c=e=>{r(e),d([void 0===e[0]?null:e[0],void 0===e[1]?null:e[1]])};return(0,n.useEffect)((()=>{r([kt(i),kt(l)])}),[i,l]),(0,Ze.BX)("div",{children:[(0,Ze.tZ)(xt.Z,{...a}),(0,Ze.BX)(wt,{children:[(0,Ze.tZ)(Ct,{placeholder:(0,s.t)("Min"),onChange:e=>{c([kt(e),o[1]])},value:null===o[0]?void 0:o[0]}),(0,Ze.tZ)(St,{placeholder:(0,s.t)("Max"),onChange:e=>{c([o[0],kt(e)])},value:null===o[1]?void 0:o[1]})]})]})}var Zt=a(379069),_t=a(964296),Mt=a(487462),Tt=a(529439),Ot=a(394334),Dt=a(215671),Rt=a(143144),Bt=a(182963),Pt=a(661120),Nt=a(360136),It=a(497326),At=a(204942),Lt=a(590731),$t=a(441143),Ft=a.n($t),jt=a(93433),Ht=function(){function e(){(0,Dt.Z)(this,e),(0,At.Z)(this,"refs",{})}return(0,Rt.Z)(e,[{key:"add",value:function(e,t){this.refs[e]||(this.refs[e]=[]),this.refs[e].push(t)}},{key:"remove",value:function(e,t){var a=this.getIndex(e,t);-1!==a&&this.refs[e].splice(a,1)}},{key:"isActive",value:function(){return this.active}},{key:"getActive",value:function(){var e=this;return this.refs[this.active.collection].find((function(t){return t.node.sortableInfo.index==e.active.index}))}},{key:"getIndex",value:function(e,t){return this.refs[e].indexOf(t)}},{key:"getOrderedRefs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.active.collection;return this.refs[e].sort(zt)}}]),e}();function zt(e,t){return e.node.sortableInfo.index-t.node.sortableInfo.index}function Xt(e,t){return Object.keys(e).reduce((function(a,n){return-1===t.indexOf(n)&&(a[n]=e[n]),a}),{})}var Wt={end:["touchend","touchcancel","mouseup"],move:["touchmove","mousemove"],start:["touchstart","mousedown"]},Ut=function(){if("undefined"==typeof window||"undefined"==typeof document)return"";var e=window.getComputedStyle(document.documentElement,"")||["-moz-hidden-iframe"],t=(Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1];return"ms"===t?"ms":t&&t.length?t[0].toUpperCase()+t.substr(1):""}();function qt(e,t){Object.keys(t).forEach((function(a){e.style[a]=t[a]}))}function Vt(e,t){e.style["".concat(Ut,"Transform")]=null==t?"":"translate3d(".concat(t.x,"px,").concat(t.y,"px,0)")}function Gt(e,t){e.style["".concat(Ut,"TransitionDuration")]=null==t?"":"".concat(t,"ms")}function Kt(e,t){for(;e;){if(t(e))return e;e=e.parentNode}return null}function Yt(e,t,a){return Math.max(e,Math.min(a,t))}function Qt(e){return"px"===e.substr(-2)?parseFloat(e):0}function Jt(e,t){var a=t.displayName||t.name;return a?"".concat(e,"(").concat(a,")"):e}function ea(e,t){var a=e.getBoundingClientRect();return{top:a.top+t.top,left:a.left+t.left}}function ta(e){return e.touches&&e.touches.length?{x:e.touches[0].pageX,y:e.touches[0].pageY}:e.changedTouches&&e.changedTouches.length?{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}:{x:e.pageX,y:e.pageY}}function aa(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{left:0,top:0};if(e){var n={left:a.left+e.offsetLeft,top:a.top+e.offsetTop};return e.parentNode===t?n:aa(e.parentNode,t,n)}}function na(e){var t=e.lockOffset,a=e.width,n=e.height,o=t,r=t,i="px";if("string"==typeof t){var l=/^[+-]?\d*(?:\.\d*)?(px|%)$/.exec(t);Ft()(null!==l,'lockOffset value should be a number or a string of a number followed by "px" or "%". Given %s',t),o=parseFloat(t),r=parseFloat(t),i=l[1]}return Ft()(isFinite(o)&&isFinite(r),"lockOffset value should be a finite. Given %s",t),"%"===i&&(o=o*a/100,r=r*n/100),{x:o,y:r}}function oa(e){return e instanceof HTMLElement?function(e){var t=window.getComputedStyle(e),a=/(auto|scroll)/;return["overflow","overflowX","overflowY"].find((function(e){return a.test(t[e])}))}(e)?e:oa(e.parentNode):null}var ra={Anchor:"A",Button:"BUTTON",Canvas:"CANVAS",Input:"INPUT",Option:"OPTION",Textarea:"TEXTAREA",Select:"SELECT"};function ia(e){return null!=e.sortableHandle}var la=function(){function e(t,a){(0,Dt.Z)(this,e),this.container=t,this.onScrollCallback=a}return(0,Rt.Z)(e,[{key:"clear",value:function(){null!=this.interval&&(clearInterval(this.interval),this.interval=null)}},{key:"update",value:function(e){var t=this,a=e.translate,n=e.minTranslate,o=e.maxTranslate,r=e.width,i=e.height,l={x:0,y:0},s={x:1,y:1},d=this.container,c=d.scrollTop,u=d.scrollLeft,h=d.scrollHeight,p=d.scrollWidth,f=0===c,g=h-c-d.clientHeight==0,m=0===u,v=p-u-d.clientWidth==0;a.y>=o.y-i/2&&!g?(l.y=1,s.y=10*Math.abs((o.y-i/2-a.y)/i)):a.x>=o.x-r/2&&!v?(l.x=1,s.x=10*Math.abs((o.x-r/2-a.x)/r)):a.y<=n.y+i/2&&!f?(l.y=-1,s.y=10*Math.abs((a.y-i/2-n.y)/i)):a.x<=n.x+r/2&&!m&&(l.x=-1,s.x=10*Math.abs((a.x-r/2-n.x)/r)),this.interval&&(this.clear(),this.isAutoScrolling=!1),0===l.x&&0===l.y||(this.interval=setInterval((function(){t.isAutoScrolling=!0;var e={left:s.x*l.x,top:s.y*l.y};t.container.scrollTop+=e.top,t.container.scrollLeft+=e.left,t.onScrollCallback(e)}),5))}}]),e}(),sa={axis:B().oneOf(["x","y","xy"]),contentWindow:B().any,disableAutoscroll:B().bool,distance:B().number,getContainer:B().func,getHelperDimensions:B().func,helperClass:B().string,helperContainer:B().oneOfType([B().func,"undefined"==typeof HTMLElement?B().any:B().instanceOf(HTMLElement)]),hideSortableGhost:B().bool,keyboardSortingTransitionDuration:B().number,lockAxis:B().string,lockOffset:B().oneOfType([B().number,B().string,B().arrayOf(B().oneOfType([B().number,B().string]))]),lockToContainerEdges:B().bool,onSortEnd:B().func,onSortMove:B().func,onSortOver:B().func,onSortStart:B().func,pressDelay:B().number,pressThreshold:B().number,keyCodes:B().shape({lift:B().arrayOf(B().number),drop:B().arrayOf(B().number),cancel:B().arrayOf(B().number),up:B().arrayOf(B().number),down:B().arrayOf(B().number)}),shouldCancelStart:B().func,transitionDuration:B().number,updateBeforeSortStart:B().func,useDragHandle:B().bool,useWindowAsScrollContainer:B().bool},da={lift:[32],drop:[32],cancel:[27],up:[38,37],down:[40,39]},ca={axis:"y",disableAutoscroll:!1,distance:0,getHelperDimensions:function(e){var t=e.node;return{height:t.offsetHeight,width:t.offsetWidth}},hideSortableGhost:!0,lockOffset:"50%",lockToContainerEdges:!1,pressDelay:0,pressThreshold:5,keyCodes:da,shouldCancelStart:function(e){return-1!==[ra.Input,ra.Textarea,ra.Select,ra.Option,ra.Button].indexOf(e.target.tagName)||!!Kt(e.target,(function(e){return"true"===e.contentEditable}))},transitionDuration:300,useWindowAsScrollContainer:!1},ua=Object.keys(sa),ha=(0,n.createContext)({manager:{}}),pa={index:B().number.isRequired,collection:B().oneOfType([B().number,B().string]),disabled:B().bool},fa=Object.keys(pa),ga=a(427478);const ma={name:B().string.isRequired,label:B().string,description:B().string,placeholder:B().string,addTooltip:B().string,itemGenerator:B().func,keyAccessor:B().func,onChange:B().func,value:B().oneOfType([B().array]),isFloat:B().bool,isInt:B().bool,controlName:B().string.isRequired},va={label:null,description:null,onChange:()=>{},placeholder:(0,s.t)("Empty collection"),itemGenerator:()=>({key:(0,_t.x0)(11)}),keyAccessor:e=>e.key,value:[],addTooltip:(0,s.t)("Add an item")},ba=function(e){var t,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{withRef:!1};return a=t=function(t){function a(){var e,t;(0,Dt.Z)(this,a);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return t=(0,Bt.Z)(this,(e=(0,Pt.Z)(a)).call.apply(e,[this].concat(r))),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"wrappedInstance",(0,n.createRef)()),t}return(0,Nt.Z)(a,t),(0,Rt.Z)(a,[{key:"componentDidMount",value:function(){this.register()}},{key:"componentDidUpdate",value:function(e){this.node&&(e.index!==this.props.index&&(this.node.sortableInfo.index=this.props.index),e.disabled!==this.props.disabled&&(this.node.sortableInfo.disabled=this.props.disabled)),e.collection!==this.props.collection&&(this.unregister(e.collection),this.register())}},{key:"componentWillUnmount",value:function(){this.unregister()}},{key:"register",value:function(){var e=this.props,t=e.collection,a=e.disabled,n=e.index,o=(0,Lt.findDOMNode)(this);o.sortableInfo={collection:t,disabled:a,index:n,manager:this.context.manager},this.node=o,this.ref={node:o},this.context.manager.add(t,this.ref)}},{key:"unregister",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.collection;this.context.manager.remove(e,this.ref)}},{key:"getWrappedInstance",value:function(){return Ft()(o.withRef,"To access the wrapped instance, you need to pass in {withRef: true} as the second argument of the SortableElement() call"),this.wrappedInstance.current}},{key:"render",value:function(){var t=o.withRef?this.wrappedInstance:null;return(0,n.createElement)(e,(0,Mt.Z)({ref:t},Xt(this.props,fa)))}}]),a}(n.Component),(0,At.Z)(t,"displayName",Jt("sortableElement",e)),(0,At.Z)(t,"contextType",ha),(0,At.Z)(t,"propTypes",pa),(0,At.Z)(t,"defaultProps",{collection:0}),a}(ct),ya=function(e){var t,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{withRef:!1};return a=t=function(t){function a(e){var t;(0,Dt.Z)(this,a),t=(0,Bt.Z)(this,(0,Pt.Z)(a).call(this,e)),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"state",{}),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"handleStart",(function(e){var a=t.props,n=a.distance,o=a.shouldCancelStart;if(2!==e.button&&!o(e)){t.touched=!0,t.position=ta(e);var r=Kt(e.target,(function(e){return null!=e.sortableInfo}));if(r&&r.sortableInfo&&t.nodeIsChild(r)&&!t.state.sorting){var i=t.props.useDragHandle,l=r.sortableInfo,s=l.index,d=l.collection;if(l.disabled)return;if(i&&!Kt(e.target,ia))return;t.manager.active={collection:d,index:s},function(e){return e.touches&&e.touches.length||e.changedTouches&&e.changedTouches.length}(e)||e.target.tagName!==ra.Anchor||e.preventDefault(),n||(0===t.props.pressDelay?t.handlePress(e):t.pressTimer=setTimeout((function(){return t.handlePress(e)}),t.props.pressDelay))}}})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"nodeIsChild",(function(e){return e.sortableInfo.manager===t.manager})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"handleMove",(function(e){var a=t.props,n=a.distance,o=a.pressThreshold;if(!t.state.sorting&&t.touched&&!t._awaitingUpdateBeforeSortStart){var r=ta(e),i={x:t.position.x-r.x,y:t.position.y-r.y},l=Math.abs(i.x)+Math.abs(i.y);t.delta=i,n||o&&!(l>=o)?n&&l>=n&&t.manager.isActive()&&t.handlePress(e):(clearTimeout(t.cancelTimer),t.cancelTimer=setTimeout(t.cancel,0))}})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"handleEnd",(function(){t.touched=!1,t.cancel()})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"cancel",(function(){var e=t.props.distance;t.state.sorting||(e||clearTimeout(t.pressTimer),t.manager.active=null)})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"handlePress",(function(e){try{var a=t.manager.getActive(),n=function(){if(a){var n=function(){var a,n,o,d,g=h.sortableInfo.index,m=function(e){var t=window.getComputedStyle(e);return{bottom:Qt(t.marginBottom),left:Qt(t.marginLeft),right:Qt(t.marginRight),top:Qt(t.marginTop)}}(h),v=function(e){var t=window.getComputedStyle(e);return"grid"===t.display?{x:Qt(t.gridColumnGap),y:Qt(t.gridRowGap)}:{x:0,y:0}}(t.container),b=t.scrollContainer.getBoundingClientRect(),y=i({index:g,node:h,collection:p});if(t.node=h,t.margin=m,t.gridGap=v,t.width=y.width,t.height=y.height,t.marginOffset={x:t.margin.left+t.margin.right+t.gridGap.x,y:Math.max(t.margin.top,t.margin.bottom,t.gridGap.y)},t.boundingClientRect=h.getBoundingClientRect(),t.containerBoundingRect=b,t.index=g,t.newIndex=g,t.axis={x:r.indexOf("x")>=0,y:r.indexOf("y")>=0},t.offsetEdge=aa(h,t.container),t.initialOffset=ta(f?(0,Ot.Z)({},e,{pageX:t.boundingClientRect.left,pageY:t.boundingClientRect.top}):e),t.initialScroll={left:t.scrollContainer.scrollLeft,top:t.scrollContainer.scrollTop},t.initialWindowScroll={left:window.pageXOffset,top:window.pageYOffset},t.helper=t.helperContainer.appendChild((n="input, textarea, select, canvas, [contenteditable]",o=(a=h).querySelectorAll(n),d=a.cloneNode(!0),(0,jt.Z)(d.querySelectorAll(n)).forEach((function(e,t){"file"!==e.type&&(e.value=o[t].value),"radio"===e.type&&e.name&&(e.name="__sortableClone__".concat(e.name)),e.tagName===ra.Canvas&&o[t].width>0&&o[t].height>0&&e.getContext("2d").drawImage(o[t],0,0)})),d)),qt(t.helper,{boxSizing:"border-box",height:"".concat(t.height,"px"),left:"".concat(t.boundingClientRect.left-m.left,"px"),pointerEvents:"none",position:"fixed",top:"".concat(t.boundingClientRect.top-m.top,"px"),width:"".concat(t.width,"px")}),f&&t.helper.focus(),s&&(t.sortableGhost=h,qt(h,{opacity:0,visibility:"hidden"})),t.minTranslate={},t.maxTranslate={},f){var x=u?{top:0,left:0,width:t.contentWindow.innerWidth,height:t.contentWindow.innerHeight}:t.containerBoundingRect,w=x.top,C=x.left,S=x.width,k=w+x.height,E=C+S;t.axis.x&&(t.minTranslate.x=C-t.boundingClientRect.left,t.maxTranslate.x=E-(t.boundingClientRect.left+t.width)),t.axis.y&&(t.minTranslate.y=w-t.boundingClientRect.top,t.maxTranslate.y=k-(t.boundingClientRect.top+t.height))}else t.axis.x&&(t.minTranslate.x=(u?0:b.left)-t.boundingClientRect.left-t.width/2,t.maxTranslate.x=(u?t.contentWindow.innerWidth:b.left+b.width)-t.boundingClientRect.left-t.width/2),t.axis.y&&(t.minTranslate.y=(u?0:b.top)-t.boundingClientRect.top-t.height/2,t.maxTranslate.y=(u?t.contentWindow.innerHeight:b.top+b.height)-t.boundingClientRect.top-t.height/2);l&&l.split(" ").forEach((function(e){return t.helper.classList.add(e)})),t.listenerNode=e.touches?e.target:t.contentWindow,f?(t.listenerNode.addEventListener("wheel",t.handleKeyEnd,!0),t.listenerNode.addEventListener("mousedown",t.handleKeyEnd,!0),t.listenerNode.addEventListener("keydown",t.handleKeyDown)):(Wt.move.forEach((function(e){return t.listenerNode.addEventListener(e,t.handleSortMove,!1)})),Wt.end.forEach((function(e){return t.listenerNode.addEventListener(e,t.handleSortEnd,!1)}))),t.setState({sorting:!0,sortingIndex:g}),c&&c({node:h,index:g,collection:p,isKeySorting:f,nodes:t.manager.getOrderedRefs(),helper:t.helper},e),f&&t.keyMove(0)},o=t.props,r=o.axis,i=o.getHelperDimensions,l=o.helperClass,s=o.hideSortableGhost,d=o.updateBeforeSortStart,c=o.onSortStart,u=o.useWindowAsScrollContainer,h=a.node,p=a.collection,f=t.manager.isKeySorting,g=function(){if("function"==typeof d){t._awaitingUpdateBeforeSortStart=!0;var a=function(t,a){try{var n=(o=h.sortableInfo.index,Promise.resolve(d({collection:p,index:o,node:h,isKeySorting:f},e)).then((function(){})))}catch(e){return a(!0,e)}var o;return n&&n.then?n.then(a.bind(null,!1),a.bind(null,!0)):a(!1,value)}(0,(function(e,a){if(t._awaitingUpdateBeforeSortStart=!1,e)throw a;return a}));if(a&&a.then)return a.then((function(){}))}}();return g&&g.then?g.then(n):n()}}();return Promise.resolve(n&&n.then?n.then((function(){})):void 0)}catch(e){return Promise.reject(e)}})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"handleSortMove",(function(e){var a=t.props.onSortMove;"function"==typeof e.preventDefault&&e.cancelable&&e.preventDefault(),t.updateHelperPosition(e),t.animateNodes(),t.autoscroll(),a&&a(e)})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"handleSortEnd",(function(e){var a=t.props,n=a.hideSortableGhost,o=a.onSortEnd,r=t.manager,i=r.active.collection,l=r.isKeySorting,s=t.manager.getOrderedRefs();t.listenerNode&&(l?(t.listenerNode.removeEventListener("wheel",t.handleKeyEnd,!0),t.listenerNode.removeEventListener("mousedown",t.handleKeyEnd,!0),t.listenerNode.removeEventListener("keydown",t.handleKeyDown)):(Wt.move.forEach((function(e){return t.listenerNode.removeEventListener(e,t.handleSortMove)})),Wt.end.forEach((function(e){return t.listenerNode.removeEventListener(e,t.handleSortEnd)})))),t.helper.parentNode.removeChild(t.helper),n&&t.sortableGhost&&qt(t.sortableGhost,{opacity:"",visibility:""});for(var d=0,c=s.length;d<c;d++){var u=s[d],h=u.node;u.edgeOffset=null,u.boundingClientRect=null,Vt(h,null),Gt(h,null),u.translate=null}t.autoScroller.clear(),t.manager.active=null,t.manager.isKeySorting=!1,t.setState({sorting:!1,sortingIndex:null}),"function"==typeof o&&o({collection:i,newIndex:t.newIndex,oldIndex:t.index,isKeySorting:l,nodes:s},e),t.touched=!1})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"autoscroll",(function(){var e=t.props.disableAutoscroll,a=t.manager.isKeySorting;if(e)t.autoScroller.clear();else{if(a){var n=(0,Ot.Z)({},t.translate),o=0,r=0;return t.axis.x&&(n.x=Math.min(t.maxTranslate.x,Math.max(t.minTranslate.x,t.translate.x)),o=t.translate.x-n.x),t.axis.y&&(n.y=Math.min(t.maxTranslate.y,Math.max(t.minTranslate.y,t.translate.y)),r=t.translate.y-n.y),t.translate=n,Vt(t.helper,t.translate),t.scrollContainer.scrollLeft+=o,void(t.scrollContainer.scrollTop+=r)}t.autoScroller.update({height:t.height,maxTranslate:t.maxTranslate,minTranslate:t.minTranslate,translate:t.translate,width:t.width})}})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"onAutoScroll",(function(e){t.translate.x+=e.left,t.translate.y+=e.top,t.animateNodes()})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"handleKeyDown",(function(e){var a=e.keyCode,n=t.props,o=n.shouldCancelStart,r=n.keyCodes,i=void 0===r?{}:r,l=(0,Ot.Z)({},da,i);t.manager.active&&!t.manager.isKeySorting||!(t.manager.active||l.lift.includes(a)&&!o(e)&&t.isValidSortingTarget(e))||(e.stopPropagation(),e.preventDefault(),l.lift.includes(a)&&!t.manager.active?t.keyLift(e):l.drop.includes(a)&&t.manager.active?t.keyDrop(e):l.cancel.includes(a)?(t.newIndex=t.manager.active.index,t.keyDrop(e)):l.up.includes(a)?t.keyMove(-1):l.down.includes(a)&&t.keyMove(1))})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"keyLift",(function(e){var a=e.target,n=Kt(a,(function(e){return null!=e.sortableInfo})).sortableInfo,o=n.index,r=n.collection;t.initialFocusedNode=a,t.manager.isKeySorting=!0,t.manager.active={index:o,collection:r},t.handlePress(e)})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"keyMove",(function(e){var a=t.manager.getOrderedRefs(),n=a[a.length-1].node.sortableInfo.index,o=t.newIndex+e,r=t.newIndex;if(!(o<0||o>n)){t.prevIndex=r,t.newIndex=o;var i=function(e,t,a){return e<a&&e>t?e-1:e>a&&e<t?e+1:e}(t.newIndex,t.prevIndex,t.index),l=a.find((function(e){return e.node.sortableInfo.index===i})),s=l.node,d=t.containerScrollDelta,c=l.boundingClientRect||ea(s,d),u=l.translate||{x:0,y:0},h=c.top+u.y-d.top,p=c.left+u.x-d.left,f=r<o,g=f&&t.axis.x?s.offsetWidth-t.width:0,m=f&&t.axis.y?s.offsetHeight-t.height:0;t.handleSortMove({pageX:p+g,pageY:h+m,ignoreTransition:0===e})}})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"keyDrop",(function(e){t.handleSortEnd(e),t.initialFocusedNode&&t.initialFocusedNode.focus()})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"handleKeyEnd",(function(e){t.manager.active&&t.keyDrop(e)})),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"isValidSortingTarget",(function(e){var a=t.props.useDragHandle,n=e.target,o=Kt(n,(function(e){return null!=e.sortableInfo}));return o&&o.sortableInfo&&!o.sortableInfo.disabled&&(a?ia(n):n.sortableInfo)}));var o=new Ht;return function(e){Ft()(!(e.distance&&e.pressDelay),"Attempted to set both `pressDelay` and `distance` on SortableContainer, you may only use one or the other, not both at the same time.")}(e),t.manager=o,t.wrappedInstance=(0,n.createRef)(),t.sortableContextValue={manager:o},t.events={end:t.handleEnd,move:t.handleMove,start:t.handleStart},t}return(0,Nt.Z)(a,t),(0,Rt.Z)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.useWindowAsScrollContainer,a=this.getContainer();Promise.resolve(a).then((function(a){e.container=a,e.document=e.container.ownerDocument||document;var n=e.props.contentWindow||e.document.defaultView||window;e.contentWindow="function"==typeof n?n():n,e.scrollContainer=t?e.document.scrollingElement||e.document.documentElement:oa(e.container)||e.container,e.autoScroller=new la(e.scrollContainer,e.onAutoScroll),Object.keys(e.events).forEach((function(t){return Wt[t].forEach((function(a){return e.container.addEventListener(a,e.events[t],!1)}))})),e.container.addEventListener("keydown",e.handleKeyDown)}))}},{key:"componentWillUnmount",value:function(){var e=this;this.helper&&this.helper.parentNode&&this.helper.parentNode.removeChild(this.helper),this.container&&(Object.keys(this.events).forEach((function(t){return Wt[t].forEach((function(a){return e.container.removeEventListener(a,e.events[t])}))})),this.container.removeEventListener("keydown",this.handleKeyDown))}},{key:"updateHelperPosition",value:function(e){var t=this.props,a=t.lockAxis,n=t.lockOffset,o=t.lockToContainerEdges,r=t.transitionDuration,i=t.keyboardSortingTransitionDuration,l=void 0===i?r:i,s=this.manager.isKeySorting,d=e.ignoreTransition,c=ta(e),u={x:c.x-this.initialOffset.x,y:c.y-this.initialOffset.y};if(u.y-=window.pageYOffset-this.initialWindowScroll.top,u.x-=window.pageXOffset-this.initialWindowScroll.left,this.translate=u,o){var h=function(e){var t=e.height,a=e.width,n=e.lockOffset,o=Array.isArray(n)?n:[n,n];Ft()(2===o.length,"lockOffset prop of SortableContainer should be a single value or an array of exactly two values. Given %s",n);var r=(0,Tt.Z)(o,2),i=r[0],l=r[1];return[na({height:t,lockOffset:i,width:a}),na({height:t,lockOffset:l,width:a})]}({height:this.height,lockOffset:n,width:this.width}),p=(0,Tt.Z)(h,2),f=p[0],g=p[1],m={x:this.width/2-f.x,y:this.height/2-f.y},v={x:this.width/2-g.x,y:this.height/2-g.y};u.x=Yt(this.minTranslate.x+m.x,this.maxTranslate.x-v.x,u.x),u.y=Yt(this.minTranslate.y+m.y,this.maxTranslate.y-v.y,u.y)}"x"===a?u.y=0:"y"===a&&(u.x=0),s&&l&&!d&&Gt(this.helper,l),Vt(this.helper,u)}},{key:"animateNodes",value:function(){var e=this.props,t=e.transitionDuration,a=e.hideSortableGhost,n=e.onSortOver,o=this.containerScrollDelta,r=this.windowScrollDelta,i=this.manager.getOrderedRefs(),l=this.offsetEdge.left+this.translate.x+o.left,s=this.offsetEdge.top+this.translate.y+o.top,d=this.manager.isKeySorting,c=this.newIndex;this.newIndex=null;for(var u=0,h=i.length;u<h;u++){var p=i[u].node,f=p.sortableInfo.index,g=p.offsetWidth,m=p.offsetHeight,v={height:this.height>m?m/2:this.height/2,width:this.width>g?g/2:this.width/2},b=d&&f>this.index&&f<=c,y=d&&f<this.index&&f>=c,x={x:0,y:0},w=i[u].edgeOffset;w||(w=aa(p,this.container),i[u].edgeOffset=w,d&&(i[u].boundingClientRect=ea(p,o)));var C=u<i.length-1&&i[u+1],S=u>0&&i[u-1];C&&!C.edgeOffset&&(C.edgeOffset=aa(C.node,this.container),d&&(C.boundingClientRect=ea(C.node,o))),f!==this.index?(t&&Gt(p,t),this.axis.x?this.axis.y?y||f<this.index&&(l+r.left-v.width<=w.left&&s+r.top<=w.top+v.height||s+r.top+v.height<=w.top)?(x.x=this.width+this.marginOffset.x,w.left+x.x>this.containerBoundingRect.width-v.width&&C&&(x.x=C.edgeOffset.left-w.left,x.y=C.edgeOffset.top-w.top),null===this.newIndex&&(this.newIndex=f)):(b||f>this.index&&(l+r.left+v.width>=w.left&&s+r.top+v.height>=w.top||s+r.top+v.height>=w.top+m))&&(x.x=-(this.width+this.marginOffset.x),w.left+x.x<this.containerBoundingRect.left+v.width&&S&&(x.x=S.edgeOffset.left-w.left,x.y=S.edgeOffset.top-w.top),this.newIndex=f):b||f>this.index&&l+r.left+v.width>=w.left?(x.x=-(this.width+this.marginOffset.x),this.newIndex=f):(y||f<this.index&&l+r.left<=w.left+v.width)&&(x.x=this.width+this.marginOffset.x,null==this.newIndex&&(this.newIndex=f)):this.axis.y&&(b||f>this.index&&s+r.top+v.height>=w.top?(x.y=-(this.height+this.marginOffset.y),this.newIndex=f):(y||f<this.index&&s+r.top<=w.top+v.height)&&(x.y=this.height+this.marginOffset.y,null==this.newIndex&&(this.newIndex=f))),Vt(p,x),i[u].translate=x):a&&(this.sortableGhost=p,qt(p,{opacity:0,visibility:"hidden"}))}null==this.newIndex&&(this.newIndex=this.index),d&&(this.newIndex=c);var k=d?this.prevIndex:c;n&&this.newIndex!==k&&n({collection:this.manager.active.collection,index:this.index,newIndex:this.newIndex,oldIndex:k,isKeySorting:d,nodes:i,helper:this.helper})}},{key:"getWrappedInstance",value:function(){return Ft()(o.withRef,"To access the wrapped instance, you need to pass in {withRef: true} as the second argument of the SortableContainer() call"),this.wrappedInstance.current}},{key:"getContainer",value:function(){var e=this.props.getContainer;return"function"!=typeof e?(0,Lt.findDOMNode)(this):e(o.withRef?this.getWrappedInstance():void 0)}},{key:"render",value:function(){var t=o.withRef?this.wrappedInstance:null;return(0,n.createElement)(ha.Provider,{value:this.sortableContextValue},(0,n.createElement)(e,(0,Mt.Z)({ref:t},Xt(this.props,ua))))}},{key:"helperContainer",get:function(){var e=this.props.helperContainer;return"function"==typeof e?e():this.props.helperContainer||this.document.body}},{key:"containerScrollDelta",get:function(){return this.props.useWindowAsScrollContainer?{left:0,top:0}:{left:this.scrollContainer.scrollLeft-this.initialScroll.left,top:this.scrollContainer.scrollTop-this.initialScroll.top}}},{key:"windowScrollDelta",get:function(){return{left:this.contentWindow.pageXOffset-this.initialWindowScroll.left,top:this.contentWindow.pageYOffset-this.initialWindowScroll.top}}}]),a}(n.Component),(0,At.Z)(t,"displayName",Jt("sortableList",e)),(0,At.Z)(t,"defaultProps",ca),(0,At.Z)(t,"propTypes",sa),a}(it.aV),xa=function(e){var t,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{withRef:!1};return a=t=function(t){function a(){var e,t;(0,Dt.Z)(this,a);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return t=(0,Bt.Z)(this,(e=(0,Pt.Z)(a)).call.apply(e,[this].concat(r))),(0,At.Z)((0,It.Z)((0,It.Z)(t)),"wrappedInstance",(0,n.createRef)()),t}return(0,Nt.Z)(a,t),(0,Rt.Z)(a,[{key:"componentDidMount",value:function(){(0,Lt.findDOMNode)(this).sortableHandle=!0}},{key:"getWrappedInstance",value:function(){return Ft()(o.withRef,"To access the wrapped instance, you need to pass in {withRef: true} as the second argument of the SortableHandle() call"),this.wrappedInstance.current}},{key:"render",value:function(){var t=o.withRef?this.wrappedInstance:null;return(0,n.createElement)(e,(0,Mt.Z)({ref:t},this.props))}}]),a}(n.Component),(0,At.Z)(t,"displayName",Jt("sortableHandle",e)),a}((()=>(0,Ze.tZ)("i",{role:"img","aria-label":"drag",className:"fa fa-bars text-primary",style:{cursor:"ns-resize"}})));var wa={name:"11g6mpt",styles:"justify-content:flex-start"};class Ca extends n.Component{constructor(e){super(e),this.onAdd=this.onAdd.bind(this)}onChange(e,t){const a=[...this.props.value];a[e]={...this.props.value[e],...t},this.props.onChange(a)}onAdd(){this.props.onChange(this.props.value.concat([this.props.itemGenerator()]))}onSortEnd({oldIndex:e,newIndex:t}){var a,n,o;this.props.onChange((n=e,o=t,(a=(a=this.props.value).slice()).splice(o<0?a.length+o:o,0,a.splice(n,1)[0]),a))}removeItem(e){this.props.onChange(this.props.value.filter(((t,a)=>e!==a)))}renderList(){if(0===this.props.value.length)return(0,Ze.tZ)("div",{className:"text-muted",children:this.props.placeholder});const e=Tl[this.props.controlName];return(0,Ze.tZ)(ya,{useDragHandle:!0,lockAxis:"y",onSortEnd:this.onSortEnd.bind(this),bordered:!0,css:e=>({borderRadius:e.gridUnit}),children:this.props.value.map(((t,a)=>{const{label:n,...o}=this.props;return(0,Ze.BX)(ba,{className:"clearfix",css:wa,index:a,children:[(0,Ze.tZ)(xa,{}),(0,Ze.tZ)("div",{css:e=>({flex:1,marginLeft:2*e.gridUnit,marginRight:2*e.gridUnit}),children:(0,Ze.tZ)(e,{...o,...t,onChange:this.onChange.bind(this,a)})}),(0,Ze.tZ)(st.V,{icon:"times",label:"remove-item",tooltip:(0,s.t)("Remove item"),bsStyle:"primary",onClick:this.removeItem.bind(this,a)})]},this.props.keyAccessor(t))}))})}render(){const{theme:e}=this.props;return(0,Ze.BX)("div",{className:"CollectionControl",children:[(0,Ze.BX)(ga.gM,{children:[(0,Ze.tZ)(xt.Z,{...this.props}),(0,Ze.tZ)(ga.IG,{onClick:this.onAdd,children:(0,Ze.tZ)(X.Z.PlusLarge,{iconSize:"s",iconColor:e.colors.grayscale.light5})})]}),this.renderList()]})}}Ca.propTypes=ma,Ca.defaultProps=va;const Sa=(0,lt.b)(Ca);var ka=a(24198),Ea=a(281545),Za=a(999075);const _a={onChange:B().func,value:B().object},Ma={position:"absolute",width:"50px",height:"20px",top:"0px",left:"0px",right:"0px",bottom:"0px"},Ta=N.iK.div`
  ${({theme:e})=>`\n      width: 50px;\n      height: 20px;\n      position: relative;\n      padding: ${e.gridUnit}px;\n      borderRadius: ${e.borderRadius}px;\n      display: inline-block;\n      cursor: pointer;\n    `}
`,Oa={color:{...Ma,borderRadius:"2px"},checkerboard:{...Ma,background:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==") left center'}};class Da extends n.Component{constructor(e){super(e),this.onChange=this.onChange.bind(this)}onChange(e){this.props.onChange(e.rgb)}renderPopover(){const e=(0,Ea.Z)().get().colors.filter(((e,t)=>t<7));return(0,Ze.tZ)("div",{id:"filter-popover",className:"color-popover",children:(0,Ze.tZ)(ka.xS,{css:I.iv`
            // We need to use important here as these are element level styles
            padding: 0 !important;
            box-shadow: none !important;
          `,color:this.props.value,onChange:this.onChange,presetColors:e})})}render(){const e=this.props.value||{r:0,g:0,b:0,a:0},t={...Oa.color,background:`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`};return(0,Ze.BX)("div",{children:[(0,Ze.tZ)(xt.Z,{...this.props}),(0,Ze.tZ)(Za.J,{trigger:"click",placement:"right",content:this.renderPopover(),children:(0,Ze.BX)(Ta,{children:[(0,Ze.tZ)("div",{style:Oa.checkerboard}),(0,Ze.tZ)("div",{style:t})]})})]})}}Da.propTypes=_a,Da.defaultProps={onChange:()=>{}};var Ra=a(676787),Ba=a(747037),Pa=a.n(Ba),Na=a(683862),Ia=a(377775),Aa=a(891178),La=a(486057),$a=a(922318),Fa=a(601304),ja=a(513218),Ha=a.n(ja);const za=(0,s.t)("Close"),Xa=(0,s.t)("Save as Dataset"),Wa=(0,s.t)("Open in SQL Lab"),Ua=e=>{const t=(0,r.k6)();return(0,Ze.BX)("div",{children:[(0,Ze.tZ)(Re.Z,{onClick:()=>{null==e||null==e.closeModal||e.closeModal(),null==e||null==e.changeDatasource||e.changeDatasource()},children:Xa}),(0,Ze.tZ)(Re.Z,{onClick:({metaKey:a})=>(a=>{const{datasource:n}=e;if(Ha()(n)){const{id:e,type:o,sql:r}=n;((e,a,n,o)=>{const r={datasourceKey:`${a}__${n}`,sql:o};e?ge.Z.postForm("/sqllab/",r):t.push({pathname:"/sqllab",state:{requestedQuery:r}})})(a,e,o,r)}})(Boolean(a)),children:Wa}),(0,Ze.tZ)(Re.Z,{buttonStyle:"primary",onClick:()=>{null==e||null==e.closeModal||e.closeModal()},children:za})]})};var qa=a(985626),Va=a(309679),Ga=a(473727);const Ka={actions:B().object.isRequired,onChange:B().func,value:B().string,datasource:B().object.isRequired,form_data:B().object.isRequired,isEditable:B().bool,onDatasourceSave:B().func},Ya=N.iK.div`
  .data-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    padding: ${({theme:e})=>4*e.gridUnit}px;
    padding-right: ${({theme:e})=>2*e.gridUnit}px;
  }
  .error-alert {
    margin: ${({theme:e})=>2*e.gridUnit}px;
  }
  .ant-dropdown-trigger {
    margin-left: ${({theme:e})=>2*e.gridUnit}px;
    box-shadow: none;
    &:active {
      box-shadow: none;
    }
  }
  .btn-group .open .dropdown-toggle {
    box-shadow: none;
    &.button-default {
      background: none;
    }
  }
  i.angle {
    color: ${({theme:e})=>e.colors.primary.base};
  }
  svg.datasource-modal-trigger {
    color: ${({theme:e})=>e.colors.primary.base};
    cursor: pointer;
  }
  .title-select {
    flex: 1 1 100%;
    display: inline-block;
    background-color: ${({theme:e})=>e.colors.grayscale.light3};
    padding: ${({theme:e})=>2*e.gridUnit}px;
    border-radius: ${({theme:e})=>e.borderRadius}px;
    text-align: center;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }
  .datasource-svg {
    margin-right: ${({theme:e})=>2*e.gridUnit}px;
    flex: none;
  }
  span[aria-label='dataset-physical'] {
    color: ${({theme:e})=>e.colors.grayscale.base};
  }
  span[aria-label='more-vert'] {
    color: ${({theme:e})=>e.colors.primary.base};
  }
`,Qa="change_dataset",Ja="view_in_sql_lab",en="edit_dataset",tn="save_as_dataset",an={[pe.i9.Query]:(0,Ze.tZ)(X.Z.ConsoleSqlOutlined,{className:"datasource-svg"}),[pe.i9.Table]:(0,Ze.tZ)(X.Z.DatasetPhysical,{className:"datasource-svg"})},nn=(e,t)=>(null==e?void 0:e.length)>25?(0,Ze.tZ)(z.u,{title:t,children:(0,Ze.tZ)("span",{className:"title-select",children:e})}):(0,Ze.tZ)("span",{title:t,className:"title-select",children:e}),on=e=>{e.metaKey?e.preventDefault():e.stopPropagation()};class rn extends n.PureComponent{constructor(e){super(e),this.onDatasourceSave=e=>{var t,a,n;this.props.actions.changeDatasource(e);const{temporalColumns:o,defaultTemporalColumn:r}=(0,Qe.X)(e),{columns:i}=e,l=null==(t=this.props.form_data)?void 0:t.granularity_sqla,s=null==(a=i.find((({column_name:e})=>e===l)))?void 0:a.is_dttm,d=null==(n=i.find((({column_name:e})=>e===r)))?void 0:n.is_dttm;if("table"===e.type&&!s){const e=d?r:null==o?void 0:o[0];this.props.actions.setControlValue("granularity_sqla",e||null)}this.props.onDatasourceSave&&this.props.onDatasourceSave(e)},this.toggleShowDatasource=()=>{this.setState((({showDatasource:e})=>({showDatasource:!e})))},this.toggleChangeDatasourceModal=()=>{this.setState((({showChangeDatasourceModal:e})=>({showChangeDatasourceModal:!e})))},this.toggleEditDatasourceModal=()=>{this.setState((({showEditDatasourceModal:e})=>({showEditDatasourceModal:!e})))},this.toggleSaveDatasetModal=()=>{this.setState((({showSaveDatasetModal:e})=>({showSaveDatasetModal:!e})))},this.handleMenuItemClick=({key:e})=>{switch(e){case Qa:this.toggleChangeDatasourceModal();break;case en:this.toggleEditDatasourceModal();break;case Ja:{const{datasource:e}=this.props,t={datasourceKey:`${e.id}__${e.type}`,sql:e.sql};ge.Z.postForm("/sqllab/",{form_data:(0,Va.o)(t)})}break;case tn:this.toggleSaveDatasetModal()}},this.state={showEditDatasourceModal:!1,showChangeDatasourceModal:!1,showSaveDatasetModal:!1}}render(){var e,t;const{showChangeDatasourceModal:a,showEditDatasourceModal:n,showSaveDatasetModal:o}=this.state,{datasource:r,onChange:i,theme:l}=this.props,d=!(null!=r&&r.id);let c=!1;if(d){const e=(0,p.eY)(f.KD.datasourceId),t=(0,p.eY)(f.KD.sliceId);e||t||(c=!0)}const{user:u}=this.props,h=(null==(e=r.owners)?void 0:e.map((e=>e.id||e.value)).includes(u.userId))||(0,$a.i5)(u),g=(0,$a.N$)(u,"SQL Lab","menu_access"),m=(0,s.t)("Edit dataset"),v={datasourceKey:`${r.id}__${r.type}`,sql:r.sql},b=(0,Ze.BX)(Na.Menu,{onClick:this.handleMenuItemClick,children:[this.props.isEditable&&!d&&(0,Ze.tZ)(Na.Menu.Item,{disabled:!h,children:h?m:(0,Ze.tZ)(z.u,{title:(0,s.t)("You must be a dataset owner in order to edit. Please reach out to a dataset owner to request modifications or edit access."),children:m})},en),(0,Ze.tZ)(Na.Menu.Item,{children:(0,s.t)("Swap dataset")},Qa),!d&&g&&(0,Ze.tZ)(Na.Menu.Item,{children:(0,Ze.tZ)(Ga.rU,{to:{pathname:"/sqllab",state:{requestedQuery:v}},onClick:on,children:(0,s.t)("View in SQL Lab")})},Ja)]}),y=(0,Ze.BX)(Na.Menu,{onClick:this.handleMenuItemClick,children:[(0,Ze.tZ)(Na.Menu.Item,{children:(0,Ze.tZ)(Fa.Z,{triggerNode:(0,Ze.tZ)("span",{children:(0,s.t)("Query preview")}),modalTitle:(0,s.t)("Query preview"),modalBody:(0,Ze.tZ)(qa.Z,{sql:(null==r?void 0:r.sql)||(null==r?void 0:r.select_star)||""}),modalFooter:(0,Ze.tZ)(Ua,{changeDatasource:this.toggleSaveDatasetModal,datasource:r}),draggable:!1,resizable:!1,responsive:!0})},"query_preview"),g&&(0,Ze.tZ)(Na.Menu.Item,{children:(0,Ze.tZ)(Ga.rU,{to:{pathname:"/sqllab",state:{requestedQuery:v}},onClick:on,children:(0,s.t)("View in SQL Lab")})},Ja),(0,Ze.tZ)(Na.Menu.Item,{children:(0,s.t)("Save as dataset")},tn)]}),{health_check_message:x}=r;let w;if(null!=r&&r.extra)if(Pa()(r.extra))try{w=JSON.parse(r.extra)}catch{}else w=r.extra;const C=d?(0,s.t)("Missing dataset"):(e=>"query"===(null==e?void 0:e.type)?null==e?void 0:e.sql:(null==e?void 0:e.name)||"")(r),S=C;return(0,Ze.BX)(Ya,{className:"DatasourceControl",children:[(0,Ze.BX)("div",{className:"data-container",children:[an[null==r?void 0:r.type],nn(C,S),x&&(0,Ze.tZ)(z.u,{title:x,children:(0,Ze.tZ)(X.Z.AlertSolid,{iconColor:l.colors.warning.base})}),(null==(t=w)?void 0:t.warning_markdown)&&(0,Ze.tZ)(La.Z,{warningMarkdown:w.warning_markdown}),(0,Ze.tZ)(it.Gj,{overlay:r.type===pe.i9.Query?y:b,trigger:["click"],children:(0,Ze.tZ)(X.Z.MoreVert,{className:"datasource-modal-trigger"})})]}),d&&c&&(0,Ze.tZ)("div",{className:"error-alert",children:(0,Ze.tZ)(Aa.Z,{level:"warning",title:(0,s.t)("Missing URL parameters"),source:"explore",subtitle:(0,Ze.tZ)(Ze.HY,{children:(0,Ze.tZ)("p",{children:(0,s.t)("The URL is missing the dataset_id or slice_id parameters.")})})})}),d&&!c&&(0,Ze.tZ)("div",{className:"error-alert",children:(0,Ze.tZ)(Aa.Z,{level:"warning",title:(0,s.t)("Missing dataset"),source:"explore",subtitle:(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("p",{children:(0,s.t)("The dataset linked to this chart may have been deleted.")}),(0,Ze.tZ)("p",{children:(0,Ze.tZ)(Re.Z,{buttonStyle:"primary",onClick:()=>this.handleMenuItemClick({key:Qa}),children:(0,s.t)("Swap dataset")})})]})})}),n&&(0,Ze.tZ)(Ia.W,{datasource:r,show:n,onDatasourceSave:this.onDatasourceSave,onHide:this.toggleEditDatasourceModal}),a&&(0,Ze.tZ)(Ia.Q,{onDatasourceSave:this.onDatasourceSave,onHide:this.toggleChangeDatasourceModal,show:a,onChange:i}),o&&(0,Ze.tZ)(be.W,{visible:o,onHide:this.toggleSaveDatasetModal,buttonTextOnSave:(0,s.t)("Save"),buttonTextOnOverwrite:(0,s.t)("Overwrite"),modalDescription:(0,s.t)("Save this query as a virtual dataset to continue exploring"),datasource:(0,ye.z)(r),openWindow:!1,formData:this.props.form_data})]})}}rn.propTypes=Ka,rn.defaultProps={onChange:()=>{},onDatasourceSave:null,value:null,isEditable:!0};const ln=(0,lt.b)(rn);var sn=a(101090),dn=a(979684),cn=a(634087),un=a(642753),hn=a(819113),pn=a(627130);const fn=N.iK.span`
  display: inline-block;
  padding: 2px 0;
`,gn=(0,N.iK)(yt.II)`
  border-radius: ${({theme:e})=>e.borderRadius};
  height: 26px;
  padding-left: ${({theme:e})=>2.5*e.gridUnit}px;
`,mn=({title:e,isEditDisabled:t,onChange:a})=>{const[o,r]=(0,n.useState)(!1),[i,l]=(0,n.useState)(!1),d=(0,s.t)("My metric"),c=(0,n.useCallback)((()=>r(!0)),[]),u=(0,n.useCallback)((()=>r(!1)),[]),h=(0,n.useCallback)((()=>l(!0)),[]),p=(0,n.useCallback)((()=>l(!1)),[]),f=(0,n.useCallback)((e=>{"Enter"===e.key&&(e.preventDefault(),p())}),[p]),g=(0,n.useCallback)((e=>{""===e.target.value&&a(e),p()}),[a,p]);return t?(0,Ze.tZ)("span",{children:(null==e?void 0:e.label)||d}):i?(0,Ze.tZ)(gn,{type:"text",placeholder:null==e?void 0:e.label,value:null!=e&&e.hasCustomLabel?e.label:"",autoFocus:!0,onChange:a,onBlur:g,onKeyPress:f}):(0,Ze.tZ)(z.u,{placement:"top",title:(0,s.t)("Click to edit label"),children:(0,Ze.BX)("span",{className:"AdhocMetricEditPopoverTitle inline-editable",onMouseOver:c,onMouseOut:u,onClick:h,onBlur:p,role:"button",tabIndex:0,children:[(0,Ze.tZ)(fn,{children:(null==e?void 0:e.label)||d})," ",(0,Ze.tZ)("i",{className:"fa fa-pencil",style:{color:o?"black":"grey"}})]})})};var vn=a(563325),bn=a(94301),yn=a(49238),xn=a(749140),wn=a(233313),Cn=a(454076),Sn=a(699963),kn=a(52489);const En={onChange:B().func.isRequired,onClose:B().func.isRequired,onResize:B().func.isRequired,getCurrentTab:B().func,getCurrentLabel:B().func,adhocMetric:B().instanceOf(hn.Z).isRequired,columns:B().arrayOf(cn.Z),savedMetricsOptions:B().arrayOf(pn.Z),savedMetric:pn.Z,datasource:B().object,isNewMetric:B().bool,isLabelModified:B().bool},Zn={columns:[],getCurrentTab:Cn.EI,isNewMetric:!1},_n=(0,N.iK)(it.Ph)`
  .metric-option {
    & > svg {
      min-width: ${({theme:e})=>4*e.gridUnit+"px"};
    }
    & > .option-label {
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,Mn="SAVED";class Tn extends n.PureComponent{constructor(e){super(e),this.defaultActiveTabKey=this.getDefaultTab(),this.onSave=this.onSave.bind(this),this.onResetStateAndClose=this.onResetStateAndClose.bind(this),this.onColumnChange=this.onColumnChange.bind(this),this.onAggregateChange=this.onAggregateChange.bind(this),this.onSavedMetricChange=this.onSavedMetricChange.bind(this),this.onSqlExpressionChange=this.onSqlExpressionChange.bind(this),this.onDragDown=this.onDragDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTabChange=this.onTabChange.bind(this),this.handleAceEditorRef=this.handleAceEditorRef.bind(this),this.refreshAceEditor=this.refreshAceEditor.bind(this),this.getDefaultTab=this.getDefaultTab.bind(this),this.state={adhocMetric:this.props.adhocMetric,savedMetric:this.props.savedMetric,width:U.kc,height:U.H7},document.addEventListener("mouseup",this.onMouseUp)}componentDidMount(){this.props.getCurrentTab(this.defaultActiveTabKey)}componentDidUpdate(e,t){var a,n,o,r,i,l,s,d,c,u,h,p,f;(null==(a=t.adhocMetric)?void 0:a.sqlExpression)===(null==(n=this.state.adhocMetric)?void 0:n.sqlExpression)&&(null==(o=t.adhocMetric)?void 0:o.aggregate)===(null==(r=this.state.adhocMetric)?void 0:r.aggregate)&&(null==(i=t.adhocMetric)||null==(l=i.column)?void 0:l.column_name)===(null==(s=this.state.adhocMetric)||null==(d=s.column)?void 0:d.column_name)&&(null==(c=t.savedMetric)?void 0:c.metric_name)===(null==(u=this.state.savedMetric)?void 0:u.metric_name)||this.props.getCurrentLabel({savedMetricLabel:(null==(h=this.state.savedMetric)?void 0:h.verbose_name)||(null==(p=this.state.savedMetric)?void 0:p.metric_name),adhocMetricLabel:null==(f=this.state.adhocMetric)?void 0:f.getDefaultLabel()})}componentWillUnmount(){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove)}getDefaultTab(){const{adhocMetric:e,savedMetric:t,savedMetricsOptions:a,isNewMetric:n}=this.props;return(0,i.Z)(e.column)||(0,i.Z)(e.sqlExpression)?e.expressionType:(n||t.metric_name)&&Array.isArray(a)&&a.length>0?Mn:e.expressionType}onSave(){var e;const{adhocMetric:t,savedMetric:a}=this.state,n=null!=a&&a.metric_name?a:t,o=null!=(e=this.props.savedMetric)&&e.metric_name?this.props.savedMetric:this.props.adhocMetric;this.props.onChange({...n},o),this.props.onClose()}onResetStateAndClose(){this.setState({adhocMetric:this.props.adhocMetric,savedMetric:this.props.savedMetric},this.props.onClose)}onColumnChange(e){const t=this.props.columns.find((t=>t.column_name===e));this.setState((e=>({adhocMetric:e.adhocMetric.duplicateWith({column:t,expressionType:hn.v.SIMPLE}),savedMetric:void 0})))}onAggregateChange(e){this.setState((t=>({adhocMetric:t.adhocMetric.duplicateWith({aggregate:e,expressionType:hn.v.SIMPLE}),savedMetric:void 0})))}onSavedMetricChange(e){const t=this.props.savedMetricsOptions.find((t=>t.metric_name===e));this.setState((e=>({savedMetric:t,adhocMetric:e.adhocMetric.duplicateWith({column:void 0,aggregate:void 0,sqlExpression:void 0,expressionType:hn.v.SIMPLE})})))}onSqlExpressionChange(e){this.setState((t=>({adhocMetric:t.adhocMetric.duplicateWith({sqlExpression:e,expressionType:hn.v.SQL}),savedMetric:void 0})))}onDragDown(e){this.dragStartX=e.clientX,this.dragStartY=e.clientY,this.dragStartWidth=this.state.width,this.dragStartHeight=this.state.height,document.addEventListener("mousemove",this.onMouseMove)}onMouseMove(e){this.props.onResize(),this.setState({width:Math.max(this.dragStartWidth+(e.clientX-this.dragStartX),U.kc),height:Math.max(this.dragStartHeight+(e.clientY-this.dragStartY),U.H7)})}onMouseUp(){document.removeEventListener("mousemove",this.onMouseMove)}onTabChange(e){this.refreshAceEditor(),this.props.getCurrentTab(e)}handleAceEditorRef(e){e&&(this.aceEditorRef=e)}refreshAceEditor(){setTimeout((()=>{var e;this.aceEditorRef&&(null==(e=this.aceEditorRef.editor)||null==e.resize||e.resize())}),0)}renderColumnOption(e){const t={...e};return t.metric_name&&!t.verbose_name&&(t.verbose_name=t.metric_name),(0,Ze.tZ)(Sn.l,{column:t,showType:!0})}renderMetricOption(e){return(0,Ze.tZ)(Sn.B,{metric:e,showType:!0})}render(){var e;const{adhocMetric:t,savedMetric:a,columns:n,savedMetricsOptions:o,onChange:r,onClose:i,onResize:l,datasource:d,isNewMetric:c,isLabelModified:u,...h}=this.props,{adhocMetric:p,savedMetric:f}=this.state,g=wn.Z.concat((0,kn.j)(n)),m=p.column&&p.column.column_name||p.inferSqlExpressionColumn(),v={ariaLabel:(0,s.t)("Select column"),placeholder:(0,s.t)("%s column(s)",n.length),value:m,onChange:this.onColumnChange,allowClear:!0,autoFocus:!m},b={ariaLabel:(0,s.t)("Select aggregate options"),placeholder:(0,s.t)("%s aggregates(s)",U.Ps.length),value:p.aggregate||p.inferSqlExpressionAggregate(),onChange:this.onAggregateChange,allowClear:!0,autoFocus:!!m},y={ariaLabel:(0,s.t)("Select saved metrics"),placeholder:(0,s.t)("%s saved metric(s)",null!=(e=null==o?void 0:o.length)?e:0),value:null==f?void 0:f.metric_name,onChange:this.onSavedMetricChange,allowClear:!0,autoFocus:!0},x=p.isValid()||(null==f?void 0:f.metric_name),w=u||c||!p.equals(t)||!(void 0===(null==f?void 0:f.metric_name)&&void 0===(null==a?void 0:a.metric_name))&&(null==f?void 0:f.metric_name)!==(null==a?void 0:a.metric_name);let C={};if(null!=d&&d.extra)try{C=JSON.parse(d.extra)}catch{}return(0,Ze.BX)(yn.l0,{layout:"vertical",id:"metrics-edit-popover",...h,children:[(0,Ze.BX)(tt.ZP,{id:"adhoc-metric-edit-tabs",defaultActiveKey:this.defaultActiveTabKey,className:"adhoc-metric-edit-tabs",style:{height:this.state.height,width:this.state.width},onChange:this.onTabChange,allowOverflow:!0,children:[(0,Ze.tZ)(tt.ZP.TabPane,{tab:(0,s.t)("Saved"),children:(0,fe.Z)(o).length>0?(0,Ze.tZ)(yn.xJ,{label:(0,s.t)("Saved metric"),children:(0,Ze.tZ)(_n,{options:(0,fe.Z)(o).map((e=>({value:e.metric_name,label:e.metric_name,customLabel:this.renderMetricOption(e),key:e.id}))),...y})}):d.type===pe.i9.Table?(0,Ze.tZ)(bn.Tc,{image:"empty.svg",title:(0,s.t)("No saved metrics found"),description:(0,s.t)('Add metrics to dataset in "Edit datasource" modal')}):(0,Ze.tZ)(bn.Tc,{image:"empty.svg",title:(0,s.t)("No saved metrics found"),description:(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("span",{tabIndex:0,role:"button",onClick:()=>{this.props.handleDatasetModal(!0),this.props.onClose()},children:(0,s.t)("Create a dataset")}),(0,s.t)(" to add metrics")]})})},Mn),(0,Ze.BX)(tt.ZP.TabPane,{tab:C.disallow_adhoc_metrics?(0,Ze.tZ)(z.u,{title:(0,s.t)("Simple ad-hoc metrics are not enabled for this dataset"),children:(0,s.t)("Simple")}):(0,s.t)("Simple"),disabled:C.disallow_adhoc_metrics,children:[(0,Ze.tZ)(yn.xJ,{label:(0,s.t)("column"),children:(0,Ze.tZ)(it.Ph,{options:n.map((e=>({value:e.column_name,label:e.verbose_name||e.column_name,key:e.id,customLabel:this.renderColumnOption(e)}))),...v})}),(0,Ze.tZ)(yn.xJ,{label:(0,s.t)("aggregate"),children:(0,Ze.tZ)(it.Ph,{options:U.Ps.map((e=>({value:e,label:e,key:e}))),...b})})]},hn.v.SIMPLE),(0,Ze.tZ)(tt.ZP.TabPane,{tab:C.disallow_adhoc_metrics?(0,Ze.tZ)(z.u,{title:(0,s.t)("Custom SQL ad-hoc metrics are not enabled for this dataset"),children:(0,s.t)("Custom SQL")}):(0,s.t)("Custom SQL"),disabled:C.disallow_adhoc_metrics,children:(0,Ze.tZ)(xn.iO,{showLoadingForImport:!0,ref:this.handleAceEditorRef,keywords:g,height:this.state.height-80+"px",onChange:this.onSqlExpressionChange,width:"100%",showGutter:!1,value:p.sqlExpression||p.translateToSql({transformCountDistinct:!0}),editorProps:{$blockScrolling:!0},enableLiveAutocompletion:!0,className:"filter-sql-editor",wrapEnabled:!0})},hn.v.SQL)]}),(0,Ze.BX)("div",{children:[(0,Ze.tZ)(Re.Z,{buttonSize:"small",onClick:this.onResetStateAndClose,cta:!0,children:(0,s.t)("Close")}),(0,Ze.tZ)(Re.Z,{disabled:!x||!w,buttonStyle:"primary",buttonSize:"small",onClick:this.onSave,cta:!0,children:(0,s.t)("Save")}),(0,Ze.tZ)("i",{role:"button","aria-label":"Resize",tabIndex:0,onMouseDown:this.onDragDown,className:"fa fa-expand edit-popover-resize text-muted"})]})]})}}Tn.propTypes=En,Tn.defaultProps=Zn;class On extends n.PureComponent{constructor(e){super(e),this.onPopoverResize=this.onPopoverResize.bind(this),this.onLabelChange=this.onLabelChange.bind(this),this.closePopover=this.closePopover.bind(this),this.togglePopover=this.togglePopover.bind(this),this.getCurrentTab=this.getCurrentTab.bind(this),this.getCurrentLabel=this.getCurrentLabel.bind(this),this.onChange=this.onChange.bind(this),this.handleDatasetModal=this.handleDatasetModal.bind(this),this.state={adhocMetric:e.adhocMetric,popoverVisible:!1,title:{label:e.adhocMetric.label,hasCustomLabel:e.adhocMetric.hasCustomLabel},currentLabel:"",labelModified:!1,isTitleEditDisabled:!1,showSaveDatasetModal:!1}}static getDerivedStateFromProps(e,t){return t.adhocMetric.optionName!==e.adhocMetric.optionName?{adhocMetric:e.adhocMetric,title:{label:e.adhocMetric.label,hasCustomLabel:e.adhocMetric.hasCustomLabel},currentLabel:"",labelModified:!1}:{adhocMetric:e.adhocMetric}}onLabelChange(e){var t;const{verbose_name:a,metric_name:n}=this.props.savedMetric,o=null==(t=this.props.adhocMetric)?void 0:t.getDefaultLabel(),r=e.target.value;this.setState((e=>({title:{label:r||e.currentLabel||a||n||o,hasCustomLabel:!!r},labelModified:!0})))}onPopoverResize(){this.forceUpdate()}handleDatasetModal(e){this.setState({showSaveDatasetModal:e})}closePopover(){this.togglePopover(!1),this.setState({labelModified:!1})}togglePopover(e){this.setState({popoverVisible:e})}getCurrentTab(e){this.setState({isTitleEditDisabled:e===Mn})}getCurrentLabel({savedMetricLabel:e,adhocMetricLabel:t}){const a=e||t;this.setState({currentLabel:a,labelModified:!0}),!e&&this.state.title.hasCustomLabel||this.setState({title:{label:a,hasCustomLabel:!1}})}onChange(e,t){this.props.onMetricEdit({...e,...this.state.title},t)}render(){const{adhocMetric:e,savedMetric:t,columns:a,savedMetricsOptions:n,datasource:o,isControlledComponent:r}=this.props,{verbose_name:i,metric_name:l}=t,{hasCustomLabel:d,label:c}=e,u=d?c:e.getDefaultLabel(),h=this.state.labelModified?this.state.title:{label:i||l||u,hasCustomLabel:d},{visible:p,togglePopover:f,closePopover:g}=r?{visible:this.props.visible,togglePopover:this.props.togglePopover,closePopover:this.props.closePopover}:{visible:this.state.popoverVisible,togglePopover:this.togglePopover,closePopover:this.closePopover},m=(0,Ze.tZ)(vn.b,{children:(0,Ze.tZ)(Tn,{adhocMetric:e,columns:a,savedMetricsOptions:n,savedMetric:t,datasource:o,handleDatasetModal:this.handleDatasetModal,onResize:this.onPopoverResize,onClose:g,onChange:this.onChange,getCurrentTab:this.getCurrentTab,getCurrentLabel:this.getCurrentLabel,isNewMetric:this.props.isNew,isLabelModified:this.state.labelModified&&u!==this.state.title.label})}),v=(0,Ze.tZ)(mn,{title:h,onChange:this.onLabelChange,isEditDisabled:this.state.isTitleEditDisabled});return(0,Ze.BX)(Ze.HY,{children:[this.state.showSaveDatasetModal&&(0,Ze.tZ)(be.W,{visible:this.state.showSaveDatasetModal,onHide:()=>this.handleDatasetModal(!1),buttonTextOnSave:(0,s.t)("Save"),buttonTextOnOverwrite:(0,s.t)("Overwrite"),modalDescription:(0,s.t)("Save this query as a virtual dataset to continue exploring"),datasource:o}),(0,Ze.tZ)(ut.Z,{placement:"right",trigger:"click",content:m,defaultVisible:p,visible:p,onVisibleChange:f,title:v,destroyTooltipOnHide:!0,children:this.props.children})]})}}const Dn=On,Rn={adhocMetric:B().instanceOf(hn.Z),onMetricEdit:B().func.isRequired,onRemoveMetric:B().func,columns:B().arrayOf(cn.Z),savedMetricsOptions:B().arrayOf(pn.Z),savedMetric:pn.Z,datasource:B().object,onMoveLabel:B().func,onDropLabel:B().func,index:B().number,type:B().string,multi:B().bool,datasourceWarningMessage:B().string};class Bn extends n.PureComponent{constructor(e){super(e),this.onRemoveMetric=this.onRemoveMetric.bind(this)}onRemoveMetric(e){null==e||e.stopPropagation(),this.props.onRemoveMetric(this.props.index)}render(){const{adhocMetric:e,onMetricEdit:t,columns:a,savedMetricsOptions:n,savedMetric:o,datasource:r,onMoveLabel:i,onDropLabel:l,index:s,type:d,multi:c,datasourceWarningMessage:u}=this.props,h=!o.error_text;return(0,Ze.tZ)(Dn,{adhocMetric:e,onMetricEdit:t,columns:a,savedMetricsOptions:n,savedMetric:o,datasource:r,children:(0,Ze.tZ)(ga.yz,{savedMetric:o,adhocMetric:e,label:e.label,onRemove:this.onRemoveMetric,onMoveLabel:i,onDropLabel:l,index:s,type:null!=d?d:un.g.AdhocMetricOption,withCaret:h,isFunction:!0,multi:c,datasourceWarningMessage:u})})}}const Pn=Bn;Bn.propTypes=Rn;const Nn={option:B().oneOfType([B().object,B().string]).isRequired,index:B().number.isRequired,onMetricEdit:B().func,onRemoveMetric:B().func,onMoveLabel:B().func,onDropLabel:B().func,columns:B().arrayOf(cn.Z),savedMetrics:B().arrayOf(pn.Z),savedMetricsOptions:B().arrayOf(pn.Z),multi:B().bool,datasource:B().object,datasourceWarningMessage:B().string};function In({option:e,onMetricEdit:t,onRemoveMetric:a,columns:n,savedMetrics:o,savedMetricsOptions:r,datasource:i,onMoveLabel:l,onDropLabel:s,index:d,type:c,multi:u,datasourceWarningMessage:h}){let p;var f;if("string"==typeof e?(f=e,p=o.find((e=>e.metric_name===f))):e.metric_name&&(p=e),e instanceof hn.Z||p){var g;const o={onMetricEdit:t,onRemoveMetric:a,columns:n,savedMetricsOptions:r,datasource:i,adhocMetric:e instanceof hn.Z?e:new hn.Z({}),onMoveLabel:l,onDropLabel:s,index:d,savedMetric:null!=(g=p)?g:{},type:c,multi:u,datasourceWarningMessage:h};return(0,Ze.tZ)(Pn,{...o})}return null}In.propTypes=Nn;var An=a(717536);const Ln={name:B().string.isRequired,onChange:B().func,value:B().oneOfType([B().arrayOf(B().oneOfType([B().string,An.Z])),B().oneOfType([B().string,An.Z])]),columns:B().arrayOf(cn.Z),savedMetrics:B().arrayOf(pn.Z),isLoading:B().bool,multi:B().bool,clearable:B().bool,datasource:B().object};function $n(e,t,a){var n;return null!=(n=null==e?void 0:e.filter((e=>Array.isArray(t)?!t.includes(e.metric_name)||e.metric_name===a:e)))?n:[]}function Fn(e){return e&&!(e instanceof hn.Z)&&e.expressionType}function jn(e){return e?Array.isArray(e)?e.map((e=>Fn(e)?new hn.Z(e):e)):Fn(e)?[new hn.Z(e)]:[e]:[]}const Hn={metric_name:"",expression:""},zn=({onChange:e,multi:t,value:a,columns:o,savedMetrics:r,datasource:i,...l})=>{const[d,c]=(0,n.useState)(jn(a)),u=(0,N.Fg)(),h=(0,L.D)(o),p=(0,L.D)(r),f=(0,n.useCallback)((a=>{if(null===a)return void e(null);const n=(0,fe.Z)(a).map((e=>e.metric_name?e.metric_name:e)).filter((e=>e));e(t?n:n[0])}),[t,e]),g=(0,n.useCallback)((e=>{const t=[...d,e];c(t),f(t)}),[f,d]),m=(0,n.useCallback)(((e,t)=>{const a=d.map((a=>a!==t.metric_name&&void 0===a.optionName||a.optionName!==t.optionName?a:e));c(a),f(a)}),[f,d]),v=(0,n.useCallback)((e=>{if(!Array.isArray(d))return;const t=[...d];t.splice(e,1),c(t),f(t)}),[f,d]),b=(0,n.useCallback)(((e,t)=>{const a=[...d];[a[t],a[e]]=[a[e],a[t]],c(a)}),[d]),y=(0,n.useCallback)((()=>!t&&d.length>0),[t,d.length]),x=(0,n.useMemo)((()=>$n(r,a,null)),[a,r]),w=(0,n.useMemo)((()=>new hn.Z({})),[d]),C=(0,n.useCallback)((e=>y()?e:(0,Ze.tZ)(Dn,{adhocMetric:w,onMetricEdit:g,columns:o,savedMetricsOptions:x,savedMetric:Hn,datasource:i,isNew:!0,children:e})),[o,i,y,w,g,x]);(0,n.useEffect)((()=>{if(a&&(!T()(h,o)||!T()(p,r))){const e=((e,t,a)=>(0,fe.Z)(e).filter((e=>"string"==typeof e||e.metric_name?null==a?void 0:a.some((t=>t.metric_name===e||t.metric_name===e.metric_name)):null==t?void 0:t.some((t=>!e.column||e.column.column_name===t.column_name)))))(a,o,r);T()(e,a)||f(e)}}),[o,f,r]),(0,n.useEffect)((()=>{c(jn(a))}),[a]);const S=(0,n.useCallback)((()=>f(d)),[f,d]),k=(0,n.useCallback)(((e,a)=>(0,Ze.tZ)(In,{index:a,option:e,onMetricEdit:m,onRemoveMetric:v,columns:o,datasource:i,savedMetrics:r,savedMetricsOptions:$n(r,d,null==d?void 0:d[a]),onMoveLabel:b,onDropLabel:S,multi:t},a)),[o,i,b,t,S,m,v,r,d]);return(0,Ze.BX)("div",{className:"metrics-select",children:[(0,Ze.BX)(ga.gM,{children:[(0,Ze.tZ)(xt.Z,{...l}),C((0,Ze.tZ)(ga.IG,{disabled:y(),children:(0,Ze.tZ)(X.Z.PlusLarge,{iconSize:"s",iconColor:u.colors.grayscale.light5})}))]}),(0,Ze.tZ)(ga.yj,{children:d.length>0?d.map(((e,t)=>k(e,t))):C((0,Ze.BX)(ga.SW,{children:[(0,Ze.tZ)(X.Z.PlusSmall,{iconColor:u.colors.grayscale.light1}),(0,s.t)("Add metric")]}))})]})};zn.propTypes=Ln,zn.defaultProps={onChange:()=>{},clearable:!0,savedMetrics:[],columns:[]};const Xn=zn;var Wn=a(883734);const Un="fix",qn="metric",Vn={onChange:B().func,value:B().object,isFloat:B().bool,datasource:B().object.isRequired,default:B().shape({type:B().oneOf(["fix","metric"]),value:B().oneOfType([B().string,B().number])})},Gn={onChange:()=>{},default:{type:Un,value:5}};class Kn extends n.Component{constructor(e){super(e),this.onChange=this.onChange.bind(this),this.setType=this.setType.bind(this),this.setFixedValue=this.setFixedValue.bind(this),this.setMetric=this.setMetric.bind(this);const t=(e.value?e.value.type:e.default.type)||Un,a=(e.value?e.value.value:e.default.value)||"100";this.state={type:t,fixedValue:t===Un?a:"",metricValue:t===qn?a:null}}onChange(){this.props.onChange({type:this.state.type,value:this.state.type===Un?this.state.fixedValue:this.state.metricValue})}setType(e){this.setState({type:e},this.onChange)}setFixedValue(e){this.setState({fixedValue:e},this.onChange)}setMetric(e){this.setState({metricValue:e},this.onChange)}render(){const e=(this.props.value||this.props.default).type||Un,t=this.props.datasource?this.props.datasource.columns:null,a=this.props.datasource?this.props.datasource.metrics:null;return(0,Ze.BX)("div",{children:[(0,Ze.tZ)(xt.Z,{...this.props}),(0,Ze.tZ)(et.Z,{ghost:!0,css:e=>(0,I.iv)("&.ant-collapse>.ant-collapse-item.ant-collapse-no-arrow>.ant-collapse-header{border:0px;padding:0px 0px ",2*e.gridUnit,"px 0px;display:inline-block;}&.ant-collapse-ghost>.ant-collapse-item>.ant-collapse-content>.ant-collapse-content-box{padding:0px;& .well{margin-bottom:0px;padding:",2*e.gridUnit,"px;}}",""),children:(0,Ze.tZ)(et.Z.Panel,{showArrow:!1,header:(0,Ze.BX)(Se.Z,{children:[this.state.type===Un&&(0,Ze.tZ)("span",{children:this.state.fixedValue}),this.state.type===qn&&(0,Ze.BX)("span",{children:[(0,Ze.BX)("span",{children:[(0,s.t)("metric"),": "]}),(0,Ze.tZ)("strong",{children:this.state.metricValue?this.state.metricValue.label:null})]})]}),children:(0,Ze.BX)("div",{className:"well",children:[(0,Ze.tZ)(Wn.Z,{title:(0,s.t)("Fixed"),isSelected:e===Un,onSelect:()=>{this.setType(Un)},children:(0,Ze.tZ)(dn.Z,{isFloat:!0,onChange:this.setFixedValue,onFocus:()=>{this.setType(Un)},value:this.state.fixedValue})}),(0,Ze.tZ)(Wn.Z,{title:(0,s.t)("Based on a metric"),isSelected:e===qn,onSelect:()=>{this.setType(qn)},children:(0,Ze.tZ)(Xn,{name:"metric",columns:t,savedMetrics:a,multi:!1,onFocus:()=>{this.setType(qn)},onChange:this.setMetric,value:this.state.metricValue,datasource:this.props.datasource})})]})})})]})}}function Yn(e){return void 0!==e.value}Kn.propTypes=Vn,Kn.defaultProps=Gn;const Qn=(0,de.ZP)((({addDangerToast:e,allowClear:t=!0,ariaLabel:a,dataEndpoint:o,multi:r=!0,mutator:i,onChange:l,placeholder:c,value:u,...h})=>{const[p,f]=(0,n.useState)([]);return(0,n.useEffect)((()=>{ge.Z.get({endpoint:o}).then((e=>{const t=i?i(e.json):e.json.result;f(t)})).catch((t=>(0,d.O$)(t).then((t=>{const{error:a}=t;e((0,s.t)("Error while fetching data: %s",a))}))))}),[e,o,i]),(0,Ze.tZ)(it.Ph,{allowClear:t,ariaLabel:a||(0,s.t)("Select ..."),value:(()=>{const e=u||(void 0!==h.default?h.default:void 0);if(null!==e||p.find((e=>null===e.value)))return e})(),header:(0,Ze.tZ)(xt.Z,{...h}),mode:r?"multiple":"single",onChange:e=>{let t=e;Array.isArray(e)&&(t=e.map((e=>Yn(e)?e.value:e))),Yn(e)&&(t=e.value),l(t)},options:p,placeholder:c})}));var Jn=a(182199),eo=a(601413),to=a(671002),ao=a(821770),no=a(891881),oo=a(580334),ro=a(145987);function io(e,t,a){return(e-t)/(a-t)}function lo(e,t,a,n){var o=io(t,a,n),r={};switch(e){case"rtl":r.right="".concat(100*o,"%"),r.transform="translateX(50%)";break;case"btt":r.bottom="".concat(100*o,"%"),r.transform="translateY(50%)";break;case"ttb":r.top="".concat(100*o,"%"),r.transform="translateY(-50%)";break;default:r.left="".concat(100*o,"%"),r.transform="translateX(-50%)"}return r}function so(e,t){return Array.isArray(e)?e[t]:e}var co=a(915105);const uo=n.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}});var ho=["prefixCls","value","valueIndex","onStartMove","style","render","dragging","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],po=n.forwardRef((function(e,t){var a,o=e.prefixCls,r=e.value,i=e.valueIndex,l=e.onStartMove,s=e.style,d=e.render,c=e.dragging,u=e.onOffsetChange,h=e.onChangeComplete,p=e.onFocus,f=e.onMouseEnter,g=(0,ro.Z)(e,ho),m=n.useContext(uo),v=m.min,b=m.max,y=m.direction,x=m.disabled,w=m.keyboard,C=m.range,S=m.tabIndex,k=m.ariaLabelForHandle,E=m.ariaLabelledByForHandle,Z=m.ariaValueTextFormatterForHandle,_=m.styles,M=m.classNames,T="".concat(o,"-handle"),O=function(e){x||l(e,i)},D=lo(y,r,v,b),R={};null!==i&&(R={tabIndex:x?null:so(S,i),role:"slider","aria-valuemin":v,"aria-valuemax":b,"aria-valuenow":r,"aria-disabled":x,"aria-label":so(k,i),"aria-labelledby":so(E,i),"aria-valuetext":null===(a=so(Z,i))||void 0===a?void 0:a(r),"aria-orientation":"ltr"===y||"rtl"===y?"horizontal":"vertical",onMouseDown:O,onTouchStart:O,onFocus:function(e){null==p||p(e,i)},onMouseEnter:function(e){f(e,i)},onKeyDown:function(e){if(!x&&w){var t=null;switch(e.which||e.keyCode){case co.Z.LEFT:t="ltr"===y||"btt"===y?-1:1;break;case co.Z.RIGHT:t="ltr"===y||"btt"===y?1:-1;break;case co.Z.UP:t="ttb"!==y?1:-1;break;case co.Z.DOWN:t="ttb"!==y?-1:1;break;case co.Z.HOME:t="min";break;case co.Z.END:t="max";break;case co.Z.PAGE_UP:t=2;break;case co.Z.PAGE_DOWN:t=-2}null!==t&&(e.preventDefault(),u(t,i))}},onKeyUp:function(e){switch(e.which||e.keyCode){case co.Z.LEFT:case co.Z.RIGHT:case co.Z.UP:case co.Z.DOWN:case co.Z.HOME:case co.Z.END:case co.Z.PAGE_UP:case co.Z.PAGE_DOWN:null==h||h()}}});var B=n.createElement("div",(0,Mt.Z)({ref:t,className:Y()(T,(0,At.Z)((0,At.Z)({},"".concat(T,"-").concat(i+1),null!==i&&C),"".concat(T,"-dragging"),c),M.handle),style:(0,eo.Z)((0,eo.Z)((0,eo.Z)({},D),s),_.handle)},R,g));return d&&(B=d(B,{index:i,prefixCls:o,value:r,dragging:c})),B}));const fo=po;var go=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","onFocus"],mo=n.forwardRef((function(e,t){var a=e.prefixCls,o=e.style,r=e.onStartMove,i=e.onOffsetChange,l=e.values,s=e.handleRender,d=e.activeHandleRender,c=e.draggingIndex,u=e.onFocus,h=(0,ro.Z)(e,go),p=n.useRef({});n.useImperativeHandle(t,(function(){return{focus:function(e){var t;null===(t=p.current[e])||void 0===t||t.focus()}}}));var f=n.useState(-1),g=(0,Tt.Z)(f,2),m=g[0],v=g[1],b=(0,eo.Z)({prefixCls:a,onStartMove:r,onOffsetChange:i,render:s,onFocus:function(e,t){v(t),null==u||u(e)},onMouseEnter:function(e,t){v(t)}},h);return n.createElement(n.Fragment,null,l.map((function(e,t){return n.createElement(fo,(0,Mt.Z)({ref:function(e){e?p.current[t]=e:delete p.current[t]},dragging:c===t,style:so(o,t),key:t,value:e,valueIndex:t},b))})),d&&n.createElement(fo,(0,Mt.Z)({key:"a11y"},b,{value:l[m],valueIndex:null,dragging:-1!==c,render:d,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}));const vo=mo,bo=function(e){var t=e.prefixCls,a=e.style,o=e.children,r=e.value,i=e.onClick,l=n.useContext(uo),s=l.min,d=l.max,c=l.direction,u=l.includedStart,h=l.includedEnd,p=l.included,f="".concat(t,"-text"),g=lo(c,r,s,d);return n.createElement("span",{className:Y()(f,(0,At.Z)({},"".concat(f,"-active"),p&&u<=r&&r<=h)),style:(0,eo.Z)((0,eo.Z)({},g),a),onMouseDown:function(e){e.stopPropagation()},onClick:function(){i(r)}},o)},yo=function(e){var t=e.prefixCls,a=e.marks,o=e.onClick,r="".concat(t,"-mark");return a.length?n.createElement("div",{className:r},a.map((function(e){var t=e.value,a=e.style,i=e.label;return n.createElement(bo,{key:t,prefixCls:r,style:a,value:t,onClick:o},i)}))):null},xo=function(e){var t=e.prefixCls,a=e.value,o=e.style,r=e.activeStyle,i=n.useContext(uo),l=i.min,s=i.max,d=i.direction,c=i.included,u=i.includedStart,h=i.includedEnd,p="".concat(t,"-dot"),f=c&&u<=a&&a<=h,g=(0,eo.Z)((0,eo.Z)({},lo(d,a,l,s)),"function"==typeof o?o(a):o);return f&&(g=(0,eo.Z)((0,eo.Z)({},g),"function"==typeof r?r(a):r)),n.createElement("span",{className:Y()(p,(0,At.Z)({},"".concat(p,"-active"),f)),style:g})},wo=function(e){var t=e.prefixCls,a=e.marks,o=e.dots,r=e.style,i=e.activeStyle,l=n.useContext(uo),s=l.min,d=l.max,c=l.step,u=n.useMemo((function(){var e=new Set;if(a.forEach((function(t){e.add(t.value)})),o&&null!==c)for(var t=s;t<=d;)e.add(t),t+=c;return Array.from(e)}),[s,d,c,o,a]);return n.createElement("div",{className:"".concat(t,"-step")},u.map((function(e){return n.createElement(xo,{prefixCls:t,key:e,value:e,style:r,activeStyle:i})})))},Co=function(e){var t=e.prefixCls,a=e.style,o=e.start,r=e.end,i=e.index,l=e.onStartMove,s=e.replaceCls,d=n.useContext(uo),c=d.direction,u=d.min,h=d.max,p=d.disabled,f=d.range,g=d.classNames,m="".concat(t,"-track"),v=io(o,u,h),b=io(r,u,h),y=function(e){!p&&l&&l(e,-1)},x={};switch(c){case"rtl":x.right="".concat(100*v,"%"),x.width="".concat(100*b-100*v,"%");break;case"btt":x.bottom="".concat(100*v,"%"),x.height="".concat(100*b-100*v,"%");break;case"ttb":x.top="".concat(100*v,"%"),x.height="".concat(100*b-100*v,"%");break;default:x.left="".concat(100*v,"%"),x.width="".concat(100*b-100*v,"%")}var w=s||Y()(m,(0,At.Z)((0,At.Z)({},"".concat(m,"-").concat(i+1),null!==i&&f),"".concat(t,"-track-draggable"),l),g.track);return n.createElement("div",{className:w,style:(0,eo.Z)((0,eo.Z)({},x),a),onMouseDown:y,onTouchStart:y})},So=function(e){var t=e.prefixCls,a=e.style,o=e.values,r=e.startPoint,i=e.onStartMove,l=n.useContext(uo),s=l.included,d=l.range,c=l.min,u=l.styles,h=l.classNames,p=n.useMemo((function(){if(!d){if(0===o.length)return[];var e=null!=r?r:c,t=o[0];return[{start:Math.min(e,t),end:Math.max(e,t)}]}for(var a=[],n=0;n<o.length-1;n+=1)a.push({start:o[n],end:o[n+1]});return a}),[o,d,r,c]);if(!s)return null;var f=h.tracks||u.tracks?n.createElement(Co,{index:null,prefixCls:t,start:p[0].start,end:p[p.length-1].end,replaceCls:Y()(h.tracks,"".concat(t,"-tracks")),style:u.tracks}):null;return n.createElement(n.Fragment,null,f,p.map((function(e,o){var r=e.start,l=e.end;return n.createElement(Co,{index:o,prefixCls:t,style:(0,eo.Z)((0,eo.Z)({},so(a,o)),u.track),start:r,end:l,key:o,onStartMove:i})})))};var ko=a(656790);function Eo(e){var t="touches"in e?e.touches[0]:e;return{pageX:t.pageX,pageY:t.pageY}}var Zo=n.forwardRef((function(e,t){var a=e.prefixCls,o=void 0===a?"rc-slider":a,r=e.className,i=e.style,l=e.classNames,s=e.styles,d=e.disabled,c=void 0!==d&&d,u=e.keyboard,h=void 0===u||u,p=e.autoFocus,f=e.onFocus,g=e.onBlur,m=e.min,v=void 0===m?0:m,b=e.max,y=void 0===b?100:b,x=e.step,w=void 0===x?1:x,C=e.value,S=e.defaultValue,k=e.range,E=e.count,Z=e.onChange,_=e.onBeforeChange,M=e.onAfterChange,T=e.onChangeComplete,O=e.allowCross,D=void 0===O||O,R=e.pushable,B=void 0!==R&&R,P=e.draggableTrack,N=e.reverse,I=e.vertical,A=e.included,L=void 0===A||A,$=e.startPoint,F=e.trackStyle,j=e.handleStyle,H=e.railStyle,z=e.dotStyle,X=e.activeDotStyle,W=e.marks,U=e.dots,q=e.handleRender,V=e.activeHandleRender,G=e.tabIndex,K=void 0===G?0:G,Q=e.ariaLabelForHandle,J=e.ariaLabelledByForHandle,ee=e.ariaValueTextFormatterForHandle,te=n.useRef(null),ae=n.useRef(null),ne=n.useMemo((function(){return I?N?"ttb":"btt":N?"rtl":"ltr"}),[N,I]),oe=n.useMemo((function(){return isFinite(v)?v:0}),[v]),re=n.useMemo((function(){return isFinite(y)?y:100}),[y]),ie=n.useMemo((function(){return null!==w&&w<=0?1:w}),[w]),le=n.useMemo((function(){return"boolean"==typeof B?!!B&&ie:B>=0&&B}),[B,ie]),se=n.useMemo((function(){return Object.keys(W||{}).map((function(e){var t=W[e],a={value:Number(e)};return t&&"object"===(0,to.Z)(t)&&!n.isValidElement(t)&&("label"in t||"style"in t)?(a.style=t.style,a.label=t.label):a.label=t,a})).filter((function(e){var t=e.label;return t||"number"==typeof t})).sort((function(e,t){return e.value-t.value}))}),[W]),de=function(e,t,a,o,r,i){var l=n.useCallback((function(a){return Math.max(e,Math.min(t,a))}),[e,t]),s=n.useCallback((function(n){if(null!==a){var o=e+Math.round((l(n)-e)/a)*a,r=function(e){return(String(e).split(".")[1]||"").length},i=Math.max(r(a),r(t),r(e)),s=Number(o.toFixed(i));return e<=s&&s<=t?s:null}return null}),[a,e,t,l]),d=n.useCallback((function(n){var r=l(n),i=o.map((function(e){return e.value}));null!==a&&i.push(s(n)),i.push(e,t);var d=i[0],c=t-e;return i.forEach((function(e){var t=Math.abs(r-e);t<=c&&(d=e,c=t)})),d}),[e,t,o,a,l,s]),c=function n(r,i,l){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unit";if("number"==typeof i){var c,u=r[l],h=u+i,p=[];o.forEach((function(e){p.push(e.value)})),p.push(e,t),p.push(s(u));var f=i>0?1:-1;"unit"===d?p.push(s(u+f*a)):p.push(s(h)),p=p.filter((function(e){return null!==e})).filter((function(e){return i<0?e<=u:e>=u})),"unit"===d&&(p=p.filter((function(e){return e!==u})));var g="unit"===d?u:h;c=p[0];var m=Math.abs(c-g);if(p.forEach((function(e){var t=Math.abs(e-g);t<m&&(c=e,m=t)})),void 0===c)return i<0?e:t;if("dist"===d)return c;if(Math.abs(i)>1){var v=(0,jt.Z)(r);return v[l]=c,n(v,i-f,l,d)}return c}return"min"===i?e:"max"===i?t:void 0},u=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unit",o=e[a],r=c(e,t,a,n);return{value:r,changed:r!==o}},h=function(e){return null===i&&0===e||"number"==typeof i&&e<i};return[d,function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unit",o=e.map(d),l=o[a],s=c(o,t,a,n);if(o[a]=s,!1===r){var p=i||0;a>0&&o[a-1]!==l&&(o[a]=Math.max(o[a],o[a-1]+p)),a<o.length-1&&o[a+1]!==l&&(o[a]=Math.min(o[a],o[a+1]-p))}else if("number"==typeof i||null===i){for(var f=a+1;f<o.length;f+=1)for(var g=!0;h(o[f]-o[f-1])&&g;){var m=u(o,1,f);o[f]=m.value,g=m.changed}for(var v=a;v>0;v-=1)for(var b=!0;h(o[v]-o[v-1])&&b;){var y=u(o,-1,v-1);o[v-1]=y.value,b=y.changed}for(var x=o.length-1;x>0;x-=1)for(var w=!0;h(o[x]-o[x-1])&&w;){var C=u(o,-1,x-1);o[x-1]=C.value,w=C.changed}for(var S=0;S<o.length-1;S+=1)for(var k=!0;h(o[S+1]-o[S])&&k;){var E=u(o,1,S+1);o[S+1]=E.value,k=E.changed}}return{value:o[a],values:o}}]}(oe,re,ie,se,D,le),ce=(0,Tt.Z)(de,2),ue=ce[0],he=ce[1],pe=(0,ao.Z)(S,{value:C}),fe=(0,Tt.Z)(pe,2),ge=fe[0],me=fe[1],ve=n.useMemo((function(){var e=null==ge?[]:Array.isArray(ge)?ge:[ge],t=(0,Tt.Z)(e,1)[0],a=null===ge?[]:[void 0===t?oe:t];if(k){if(a=(0,jt.Z)(e),E||void 0===ge){var n=E>=0?E+1:2;for(a=a.slice(0,n);a.length<n;){var o;a.push(null!==(o=a[a.length-1])&&void 0!==o?o:oe)}}a.sort((function(e,t){return e-t}))}return a.forEach((function(e,t){a[t]=ue(e)})),a}),[ge,k,oe,E,ue]),be=n.useRef(ve);be.current=ve;var ye=function(e){return k?e:e[0]},xe=function(e){var t=(0,jt.Z)(e).sort((function(e,t){return e-t}));Z&&!(0,no.Z)(t,be.current,!0)&&Z(ye(t)),me(t)},we=function(){var e=ye(be.current);null==M||M(e),(0,oo.ZP)(!M,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),null==T||T(e)},Ce=function(e,t,a,o,r,i,l,s,d){var c=n.useState(null),u=(0,Tt.Z)(c,2),h=u[0],p=u[1],f=n.useState(-1),g=(0,Tt.Z)(f,2),m=g[0],v=g[1],b=n.useState(a),y=(0,Tt.Z)(b,2),x=y[0],w=y[1],C=n.useState(a),S=(0,Tt.Z)(C,2),k=S[0],E=S[1],Z=n.useRef(null),_=n.useRef(null);n.useLayoutEffect((function(){-1===m&&w(a)}),[a,m]),n.useEffect((function(){return function(){document.removeEventListener("mousemove",Z.current),document.removeEventListener("mouseup",_.current),document.removeEventListener("touchmove",Z.current),document.removeEventListener("touchend",_.current)}}),[]);var M=function(e,t){x.some((function(t,a){return t!==e[a]}))&&(void 0!==t&&p(t),w(e),l(e))},T=(0,ko.zX)((function(e,t){if(-1===e){var a=k[0],n=k[k.length-1],l=o-a,s=r-n,c=t*(r-o);c=Math.max(c,l),c=Math.min(c,s);var u=i(a+c);c=u-a;var h=k.map((function(e){return e+c}));M(h)}else{var p=(r-o)*t,f=(0,jt.Z)(x);f[e]=k[e];var g=d(f,p,e,"dist");M(g.values,g.value)}})),O=n.useMemo((function(){var e=(0,jt.Z)(a).sort((function(e,t){return e-t})),t=(0,jt.Z)(x).sort((function(e,t){return e-t}));return e.every((function(e,a){return e===t[a]}))?x:a}),[a,x]);return[m,h,O,function(n,o,r){n.stopPropagation();var i=r||a,l=i[o];v(o),p(l),E(i);var d=Eo(n),c=d.pageX,u=d.pageY,h=function(a){a.preventDefault();var n,r=Eo(a),i=r.pageX,l=r.pageY,s=i-c,d=l-u,h=e.current.getBoundingClientRect(),p=h.width,f=h.height;switch(t){case"btt":n=-d/f;break;case"ttb":n=d/f;break;case"rtl":n=-s/p;break;default:n=s/p}T(o,n)},f=function e(t){t.preventDefault(),document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",h),document.removeEventListener("touchend",e),document.removeEventListener("touchmove",h),Z.current=null,_.current=null,v(-1),s()};document.addEventListener("mouseup",f),document.addEventListener("mousemove",h),document.addEventListener("touchend",f),document.addEventListener("touchmove",h),Z.current=h,_.current=f}]}(ae,ne,ve,oe,re,ue,xe,we,he),Se=(0,Tt.Z)(Ce,4),ke=Se[0],Ee=Se[1],Ze=Se[2],_e=Se[3],Me=function(e,t){if(!c){var a=0,n=re-oe;ve.forEach((function(t,o){var r=Math.abs(e-t);r<=n&&(n=r,a=o)}));var o,r,i=(0,jt.Z)(ve);i[a]=e,k&&!ve.length&&void 0===E&&i.push(e),null==_||_(ye(i)),xe(i),t&&(null===(o=document.activeElement)||void 0===o||null===(r=o.blur)||void 0===r||r.call(o),te.current.focus(a),_e(t,a,i))}},Te=n.useState(null),Oe=(0,Tt.Z)(Te,2),De=Oe[0],Re=Oe[1];n.useEffect((function(){if(null!==De){var e=ve.indexOf(De);e>=0&&te.current.focus(e)}Re(null)}),[De]);var Be=n.useMemo((function(){return(!P||null!==ie)&&P}),[P,ie]),Pe=function(e,t){_e(e,t),null==_||_(ye(be.current))},Ne=-1!==ke;n.useEffect((function(){if(!Ne){var e=ve.lastIndexOf(Ee);te.current.focus(e)}}),[Ne]);var Ie=n.useMemo((function(){return(0,jt.Z)(Ze).sort((function(e,t){return e-t}))}),[Ze]),Ae=n.useMemo((function(){return k?[Ie[0],Ie[Ie.length-1]]:[oe,Ie[0]]}),[Ie,k,oe]),Le=(0,Tt.Z)(Ae,2),$e=Le[0],Fe=Le[1];n.useImperativeHandle(t,(function(){return{focus:function(){te.current.focus(0)},blur:function(){var e,t=document.activeElement;null!==(e=ae.current)&&void 0!==e&&e.contains(t)&&(null==t||t.blur())}}})),n.useEffect((function(){p&&te.current.focus(0)}),[]);var je=n.useMemo((function(){return{min:oe,max:re,direction:ne,disabled:c,keyboard:h,step:ie,included:L,includedStart:$e,includedEnd:Fe,range:k,tabIndex:K,ariaLabelForHandle:Q,ariaLabelledByForHandle:J,ariaValueTextFormatterForHandle:ee,styles:s||{},classNames:l||{}}}),[oe,re,ne,c,h,ie,L,$e,Fe,k,K,Q,J,ee,s,l]);return n.createElement(uo.Provider,{value:je},n.createElement("div",{ref:ae,className:Y()(o,r,(0,At.Z)((0,At.Z)((0,At.Z)((0,At.Z)({},"".concat(o,"-disabled"),c),"".concat(o,"-vertical"),I),"".concat(o,"-horizontal"),!I),"".concat(o,"-with-marks"),se.length)),style:i,onMouseDown:function(e){e.preventDefault();var t,a=ae.current.getBoundingClientRect(),n=a.width,o=a.height,r=a.left,i=a.top,l=a.bottom,s=a.right,d=e.clientX,c=e.clientY;switch(ne){case"btt":t=(l-c)/o;break;case"ttb":t=(c-i)/o;break;case"rtl":t=(s-d)/n;break;default:t=(d-r)/n}Me(ue(oe+t*(re-oe)),e)}},n.createElement("div",{className:Y()("".concat(o,"-rail"),null==l?void 0:l.rail),style:(0,eo.Z)((0,eo.Z)({},H),null==s?void 0:s.rail)}),n.createElement(So,{prefixCls:o,style:F,values:Ie,startPoint:$,onStartMove:Be?Pe:void 0}),n.createElement(wo,{prefixCls:o,marks:se,dots:U,style:z,activeStyle:X}),n.createElement(vo,{ref:te,prefixCls:o,style:j,values:Ze,draggingIndex:ke,onStartMove:Pe,onOffsetChange:function(e,t){if(!c){var a=he(ve,e,t);null==_||_(ye(ve)),xe(a.values),Re(a.value)}},onFocus:f,onBlur:g,handleRender:q,activeHandleRender:V,onChangeComplete:we}),n.createElement(yo,{prefixCls:o,marks:se,onClick:Me})))}));const _o=Zo;var Mo=a(75164),To=a(58947),Oo=a(89183),Do=a(242550),Ro=a(703961);const Bo=n.forwardRef(((e,t)=>{const{open:a}=e,o=(0,n.useRef)(null),r=(0,n.useRef)(null);function i(){Mo.Z.cancel(r.current),r.current=null}return n.useEffect((()=>(a?r.current=(0,Mo.Z)((()=>{var e;null===(e=o.current)||void 0===e||e.forceAlign(),r.current=null})):i(),i)),[a,e.title]),n.createElement(Ro.Z,Object.assign({ref:(0,Do.sQ)(o,t)},e))}));var Po=a(439165),No=a(510274),Io=a(935336),Ao=a(701263),Lo=a(637221);const $o=e=>{const{componentCls:t,antCls:a,controlSize:n,dotSize:o,marginFull:r,marginPart:i,colorFillContentHover:l,handleColorDisabled:s,calc:d}=e;return{[t]:Object.assign(Object.assign({},(0,Io.Wf)(e)),{position:"relative",height:n,margin:`${(0,Po.bf)(i)} ${(0,Po.bf)(r)}`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${(0,Po.bf)(r)} ${(0,Po.bf)(i)}`},[`${t}-rail`]:{position:"absolute",backgroundColor:e.railBg,borderRadius:e.borderRadiusXS,transition:`background-color ${e.motionDurationMid}`},[`${t}-track,${t}-tracks`]:{position:"absolute",transition:`background-color ${e.motionDurationMid}`},[`${t}-track`]:{backgroundColor:e.trackBg,borderRadius:e.borderRadiusXS},[`${t}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${t}-rail`]:{backgroundColor:e.railHoverBg},[`${t}-track`]:{backgroundColor:e.trackHoverBg},[`${t}-dot`]:{borderColor:l},[`${t}-handle::after`]:{boxShadow:`0 0 0 ${(0,Po.bf)(e.handleLineWidth)} ${e.colorPrimaryBorderHover}`},[`${t}-dot-active`]:{borderColor:e.dotActiveBorderColor}},[`${t}-handle`]:{position:"absolute",width:e.handleSize,height:e.handleSize,outline:"none","&::before":{content:'""',position:"absolute",insetInlineStart:d(e.handleLineWidth).mul(-1).equal(),insetBlockStart:d(e.handleLineWidth).mul(-1).equal(),width:d(e.handleSize).add(d(e.handleLineWidth).mul(2)).equal(),height:d(e.handleSize).add(d(e.handleLineWidth).mul(2)).equal(),backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:e.handleSize,height:e.handleSize,backgroundColor:e.colorBgElevated,boxShadow:`0 0 0 ${(0,Po.bf)(e.handleLineWidth)} ${e.handleColor}`,borderRadius:"50%",cursor:"pointer",transition:`\n            inset-inline-start ${e.motionDurationMid},\n            inset-block-start ${e.motionDurationMid},\n            width ${e.motionDurationMid},\n            height ${e.motionDurationMid},\n            box-shadow ${e.motionDurationMid}\n          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:d(e.handleSizeHover).sub(e.handleSize).div(2).add(e.handleLineWidthHover).mul(-1).equal(),insetBlockStart:d(e.handleSizeHover).sub(e.handleSize).div(2).add(e.handleLineWidthHover).mul(-1).equal(),width:d(e.handleSizeHover).add(d(e.handleLineWidthHover).mul(2)).equal(),height:d(e.handleSizeHover).add(d(e.handleLineWidthHover).mul(2)).equal()},"&::after":{boxShadow:`0 0 0 ${(0,Po.bf)(e.handleLineWidthHover)} ${e.handleActiveColor}`,width:e.handleSizeHover,height:e.handleSizeHover,insetInlineStart:e.calc(e.handleSize).sub(e.handleSizeHover).div(2).equal(),insetBlockStart:e.calc(e.handleSize).sub(e.handleSizeHover).div(2).equal()}}},[`&-lock ${t}-handle`]:{"&::before, &::after":{transition:"none"}},[`${t}-mark`]:{position:"absolute",fontSize:e.fontSize},[`${t}-mark-text`]:{position:"absolute",display:"inline-block",color:e.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:e.colorText}},[`${t}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${t}-dot`]:{position:"absolute",width:o,height:o,backgroundColor:e.colorBgElevated,border:`${(0,Po.bf)(e.handleLineWidth)} solid ${e.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${e.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:e.dotActiveBorderColor}},[`&${t}-disabled`]:{cursor:"not-allowed",[`${t}-rail`]:{backgroundColor:`${e.railBg} !important`},[`${t}-track`]:{backgroundColor:`${e.trackBgDisabled} !important`},[`\n          ${t}-dot\n        `]:{backgroundColor:e.colorBgElevated,borderColor:e.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${t}-handle::after`]:{backgroundColor:e.colorBgElevated,cursor:"not-allowed",width:e.handleSize,height:e.handleSize,boxShadow:`0 0 0 ${(0,Po.bf)(e.handleLineWidth)} ${s}`,insetInlineStart:0,insetBlockStart:0},[`\n          ${t}-mark-text,\n          ${t}-dot\n        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${a}-tooltip-inner`]:{minWidth:"unset"}})}},Fo=(e,t)=>{const{componentCls:a,railSize:n,handleSize:o,dotSize:r,marginFull:i,calc:l}=e,s=t?"paddingBlock":"paddingInline",d=t?"width":"height",c=t?"height":"width",u=t?"insetBlockStart":"insetInlineStart",h=t?"top":"insetInlineStart",p=l(n).mul(3).sub(o).div(2).equal(),f=l(o).sub(n).div(2).equal(),g=t?{borderWidth:`${(0,Po.bf)(f)} 0`,transform:`translateY(${(0,Po.bf)(l(f).mul(-1).equal())})`}:{borderWidth:`0 ${(0,Po.bf)(f)}`,transform:`translateX(${(0,Po.bf)(e.calc(f).mul(-1).equal())})`};return{[s]:n,[c]:l(n).mul(3).equal(),[`${a}-rail`]:{[d]:"100%",[c]:n},[`${a}-track,${a}-tracks`]:{[c]:n},[`${a}-track-draggable`]:Object.assign({},g),[`${a}-handle`]:{[u]:p},[`${a}-mark`]:{insetInlineStart:0,top:0,[h]:l(n).mul(3).add(t?0:i).equal(),[d]:"100%"},[`${a}-step`]:{insetInlineStart:0,top:0,[h]:n,[d]:"100%",[c]:n},[`${a}-dot`]:{position:"absolute",[u]:l(n).sub(r).div(2).equal()}}},jo=e=>{const{componentCls:t,marginPartWithMark:a}=e;return{[`${t}-horizontal`]:Object.assign(Object.assign({},Fo(e,!0)),{[`&${t}-with-marks`]:{marginBottom:a}})}},Ho=e=>{const{componentCls:t}=e;return{[`${t}-vertical`]:Object.assign(Object.assign({},Fo(e,!1)),{height:"100%"})}},zo=(0,Ao.I$)("Slider",(e=>{const t=(0,Lo.TS)(e,{marginPart:e.calc(e.controlHeight).sub(e.controlSize).div(2).equal(),marginFull:e.calc(e.controlSize).div(2).equal(),marginPartWithMark:e.calc(e.controlHeightLG).sub(e.controlSize).equal()});return[$o(t),jo(t),Ho(t)]}),(e=>{const t=e.controlHeightLG/4;return{controlSize:t,railSize:4,handleSize:t,handleSizeHover:e.controlHeightSM/2,dotSize:8,handleLineWidth:e.lineWidth+1,handleLineWidthHover:e.lineWidth+3,railBg:e.colorFillTertiary,railHoverBg:e.colorFillSecondary,trackBg:e.colorPrimaryBorder,trackHoverBg:e.colorPrimaryBorderHover,handleColor:e.colorPrimaryBorder,handleActiveColor:e.colorPrimary,handleColorDisabled:new No.C(e.colorTextDisabled).onBackground(e.colorBgContainer).toHexShortString(),dotBorderColor:e.colorBorderSecondary,dotActiveBorderColor:e.colorPrimaryBorder,trackBgDisabled:e.colorBgContainerDisabled}}));function Xo(){const[e,t]=n.useState(!1),a=n.useRef(),o=()=>{Mo.Z.cancel(a.current)};return n.useEffect((()=>o),[]),[e,e=>{o(),e?t(e):a.current=(0,Mo.Z)((()=>{t(e)}))}]}const Wo=n.forwardRef(((e,t)=>{const{prefixCls:a,range:o,className:r,rootClassName:i,style:l,disabled:s,tooltipPrefixCls:d,tipFormatter:c,tooltipVisible:u,getTooltipPopupContainer:h,tooltipPlacement:p,tooltip:f={},onChangeComplete:g}=e,m=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a}(e,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement","tooltip","onChangeComplete"]),{vertical:v}=e,{direction:b,slider:y,getPrefixCls:x,getPopupContainer:w}=n.useContext(To.E_),C=n.useContext(Oo.Z),S=null!=s?s:C,[k,E]=Xo(),[Z,_]=Xo(),M=Object.assign({},f),{open:T,placement:O,getPopupContainer:D,prefixCls:R,formatter:B}=M,P=null!=T?T:u,N=(k||Z)&&!1!==P,I=function(e,t){return e||null===e?e:t||null===t?t:e=>"number"==typeof e?e.toString():""}(B,c),[A,L]=Xo(),$=(e,t)=>e||(t?"rtl"===b?"left":"right":"top"),F=x("slider",a),[j,H,z]=zo(F),X=Y()(r,null==y?void 0:y.className,i,{[`${F}-rtl`]:"rtl"===b,[`${F}-lock`]:A},H,z);"rtl"!==b||m.vertical||(m.reverse=!m.reverse);const[W,U]=n.useMemo((()=>o?"object"==typeof o?[!0,o.draggableTrack]:[!0,!1]:[!1]),[o]);n.useEffect((()=>{const e=()=>{(0,Mo.Z)((()=>{_(!1)}),1)};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}}),[]);const q=W&&!P,V=q?(e,t)=>{const a=n.cloneElement(e,{style:Object.assign(Object.assign({},e.props.style),{visibility:"hidden"})});return n.createElement(Bo,Object.assign({},M,{prefixCls:x("tooltip",null!=R?R:d),title:I?I(t.value):"",open:null!==I&&N,placement:$(null!=O?O:p,v),key:"tooltip",overlayClassName:`${F}-tooltip`,getPopupContainer:D||h||w}),a)}:void 0,G=Object.assign(Object.assign({},null==y?void 0:y.style),l);return j(n.createElement(_o,Object.assign({},m,{step:m.step,range:W,draggableTrack:U,className:X,style:G,disabled:S,ref:t,prefixCls:F,handleRender:(e,t)=>{const{index:a}=t,o=e.props,r=Object.assign(Object.assign({},o),{onMouseEnter:e=>{var t;E(!0),null===(t=o.onMouseEnter)||void 0===t||t.call(o,e)},onMouseLeave:e=>{var t;E(!1),null===(t=o.onMouseLeave)||void 0===t||t.call(o,e)},onMouseDown:e=>{var t;_(!0),L(!0),null===(t=o.onMouseDown)||void 0===t||t.call(o,e)},onFocus:e=>{var t,a;_(!0),null===(t=m.onFocus)||void 0===t||t.call(m,e),null===(a=o.onFocus)||void 0===a||a.call(o,e)},onBlur:e=>{var t,a;_(!1),null===(t=m.onBlur)||void 0===t||t.call(m,e),null===(a=o.onBlur)||void 0===a||a.call(o,e)}}),i=n.cloneElement(e,r),l=(!!P||N)&&null!==I;return q?i:n.createElement(Bo,Object.assign({},M,{prefixCls:x("tooltip",null!=R?R:d),title:I?I(t.value):"",open:l,placement:$(null!=O?O:p,v),key:a,overlayClassName:`${F}-tooltip`,getPopupContainer:D||h||w}),i)},activeHandleRender:V,onChangeComplete:e=>{null==g||g(e),L(!1)}})))})),Uo=Wo;function qo(e){return(0,Ze.tZ)(Uo,{...e})}var Vo=a(100665),Go=a(542878);const Ko={label:B().string,tooltip:B().string,colType:B().string,width:B().string,height:B().string,timeLag:B().oneOfType([B().string,B().number]),timeRatio:B().string,comparisonType:B().string,showYAxis:B().bool,yAxisBounds:B().array,bounds:B().array,d3format:B().string,dateFormat:B().string,onChange:B().func},Yo={label:(0,s.t)("Time series columns"),tooltip:"",colType:"",width:"",height:"",timeLag:"",timeRatio:"",comparisonType:"",showYAxis:!1,yAxisBounds:[null,null],bounds:[null,null],d3format:"",dateFormat:""},Qo=[{value:"value",label:(0,s.t)("Actual value"),key:"value"},{value:"diff",label:(0,s.t)("Difference"),key:"diff"},{value:"perc",label:(0,s.t)("Percentage"),key:"perc"},{value:"perc_change",label:(0,s.t)("Percentage change"),key:"perc_change"}],Jo=[{value:"time",label:(0,s.t)("Time comparison"),key:"time"},{value:"contrib",label:(0,s.t)("Contribution"),key:"contrib"},{value:"spark",label:(0,s.t)("Sparkline"),key:"spark"},{value:"avg",label:(0,s.t)("Period average"),key:"avg"}],er=(0,N.iK)(it.X2)`
  margin-top: ${({theme:e})=>2*e.gridUnit}px;
  display: flex;
  align-items: center;
`,tr=(0,N.iK)(it.JX)`
  display: flex;
  align-items: center;
`,ar=(0,N.iK)(st.V)`
  margin-left: ${({theme:e})=>e.gridUnit}px;
  color: ${({theme:e})=>e.colors.grayscale.light1};
`,nr=N.iK.div`
  margin-top: ${({theme:e})=>5*e.gridUnit}px;
  display: flex;
  justify-content: center;
`;class or extends n.Component{constructor(e){super(e),this.onSave=this.onSave.bind(this),this.onClose=this.onClose.bind(this),this.resetState=this.resetState.bind(this),this.initialState=this.initialState.bind(this),this.onPopoverVisibleChange=this.onPopoverVisibleChange.bind(this),this.state=this.initialState()}initialState(){return{label:this.props.label,tooltip:this.props.tooltip,colType:this.props.colType,width:this.props.width,height:this.props.height,timeLag:this.props.timeLag||0,timeRatio:this.props.timeRatio,comparisonType:this.props.comparisonType,showYAxis:this.props.showYAxis,yAxisBounds:this.props.yAxisBounds,bounds:this.props.bounds,d3format:this.props.d3format,dateFormat:this.props.dateFormat,popoverVisible:!1}}resetState(){const e=this.initialState();this.setState({...e})}onSave(){this.props.onChange(this.state),this.setState({popoverVisible:!1})}onClose(){this.resetState()}onSelectChange(e,t){this.setState({[e]:t})}onTextInputChange(e,t){this.setState({[e]:t.target.value})}onCheckboxChange(e,t){this.setState({[e]:t})}onBoundsChange(e){this.setState({bounds:e})}onPopoverVisibleChange(e){e?this.setState({popoverVisible:e}):this.resetState()}onYAxisBoundsChange(e){this.setState({yAxisBounds:e})}textSummary(){return`${this.props.label}`}formRow(e,t,a,n){return(0,Ze.BX)(er,{children:[(0,Ze.BX)(tr,{xs:24,md:11,children:[e,(0,Ze.tZ)(ar,{placement:"top",tooltip:t,label:a})]}),(0,Ze.tZ)(it.JX,{xs:24,md:13,children:n})]})}renderPopover(){return(0,Ze.BX)("div",{id:"ts-col-popo",style:{width:320},children:[this.formRow((0,s.t)("Label"),(0,s.t)("The column header label"),"time-lag",(0,Ze.tZ)(yt.II,{value:this.state.label,onChange:this.onTextInputChange.bind(this,"label"),placeholder:(0,s.t)("Label")})),this.formRow((0,s.t)("Tooltip"),(0,s.t)("Column header tooltip"),"col-tooltip",(0,Ze.tZ)(yt.II,{value:this.state.tooltip,onChange:this.onTextInputChange.bind(this,"tooltip"),placeholder:(0,s.t)("Tooltip")})),this.formRow((0,s.t)("Type"),(0,s.t)("Type of comparison, value difference or percentage"),"col-type",(0,Ze.tZ)(it.Ph,{ariaLabel:(0,s.t)("Type"),value:this.state.colType||void 0,onChange:this.onSelectChange.bind(this,"colType"),options:Jo})),(0,Ze.tZ)("hr",{}),"spark"===this.state.colType&&this.formRow((0,s.t)("Width"),(0,s.t)("Width of the sparkline"),"spark-width",(0,Ze.tZ)(yt.II,{value:this.state.width,onChange:this.onTextInputChange.bind(this,"width"),placeholder:(0,s.t)("Width")})),"spark"===this.state.colType&&this.formRow((0,s.t)("Height"),(0,s.t)("Height of the sparkline"),"spark-width",(0,Ze.tZ)(yt.II,{value:this.state.height,onChange:this.onTextInputChange.bind(this,"height"),placeholder:(0,s.t)("Height")})),["time","avg"].indexOf(this.state.colType)>=0&&this.formRow((0,s.t)("Time lag"),(0,s.t)("Number of periods to compare against. You can use negative numbers to compare from the beginning of the time range."),"time-lag",(0,Ze.tZ)(yt.II,{value:this.state.timeLag,onChange:this.onTextInputChange.bind(this,"timeLag"),placeholder:(0,s.t)("Time Lag")})),["spark"].indexOf(this.state.colType)>=0&&this.formRow((0,s.t)("Time ratio"),(0,s.t)("Number of periods to ratio against"),"time-ratio",(0,Ze.tZ)(yt.II,{value:this.state.timeRatio,onChange:this.onTextInputChange.bind(this,"timeRatio"),placeholder:(0,s.t)("Time Ratio")})),"time"===this.state.colType&&this.formRow((0,s.t)("Type"),(0,s.t)("Type of comparison, value difference or percentage"),"comp-type",(0,Ze.tZ)(it.Ph,{ariaLabel:(0,s.t)("Type"),value:this.state.comparisonType||void 0,onChange:this.onSelectChange.bind(this,"comparisonType"),options:Qo})),"spark"===this.state.colType&&this.formRow((0,s.t)("Show Y-axis"),(0,s.t)("Show Y-axis on the sparkline. Will display the manually set min/max if set or min/max values in the data otherwise."),"show-y-axis-bounds",(0,Ze.tZ)(Zt.Z,{value:this.state.showYAxis,onChange:this.onCheckboxChange.bind(this,"showYAxis")})),"spark"===this.state.colType&&this.formRow((0,s.t)("Y-axis bounds"),(0,s.t)("Manually set min/max values for the y-axis."),"y-axis-bounds",(0,Ze.tZ)(Et,{value:this.state.yAxisBounds,onChange:this.onYAxisBoundsChange.bind(this)})),"spark"!==this.state.colType&&this.formRow((0,s.t)("Color bounds"),(0,s.t)("Number bounds used for color encoding from red to blue.\n               Reverse the numbers for blue to red. To get pure red or blue,\n               you can enter either only min or max."),"bounds",(0,Ze.tZ)(Et,{value:this.state.bounds,onChange:this.onBoundsChange.bind(this)})),this.formRow((0,s.t)("Number format"),(0,s.t)("Optional d3 number format string"),"d3-format",(0,Ze.tZ)(yt.II,{value:this.state.d3format,onChange:this.onTextInputChange.bind(this,"d3format"),placeholder:(0,s.t)("Number format string")})),"spark"===this.state.colType&&this.formRow((0,s.t)("Date format"),(0,s.t)("Optional d3 date format string"),"date-format",(0,Ze.tZ)(yt.II,{value:this.state.dateFormat,onChange:this.onTextInputChange.bind(this,"dateFormat"),placeholder:(0,s.t)("Date format string")})),(0,Ze.BX)(nr,{children:[(0,Ze.tZ)(Re.Z,{buttonSize:"small",onClick:this.onClose,cta:!0,children:(0,s.t)("Close")}),(0,Ze.tZ)(Re.Z,{buttonStyle:"primary",buttonSize:"small",onClick:this.onSave,cta:!0,children:(0,s.t)("Save")})]})]})}render(){return(0,Ze.BX)("span",{children:[this.textSummary()," ",(0,Ze.tZ)(ut.Z,{trigger:"click",content:this.renderPopover(),title:(0,s.t)("Column Configuration"),visible:this.state.popoverVisible,onVisibleChange:this.onPopoverVisibleChange,children:(0,Ze.tZ)(st.V,{icon:"edit",className:"text-primary",label:"edit-ts-column"})})]})}}or.propTypes=Ko,or.defaultProps=Yo;var rr=a(441609),ir=a.n(rr),lr=a(891988),sr=a(221283),dr=a(360593);const cr="YYYY-MM-DD",ur=(e,t)=>T()(e,t),hr=(e,t)=>T()(e,t);var pr=a(279512);const fr=["longitude","latitude","zoom","bearing","pitch"],gr={onChange:B().func,value:B().shape({longitude:B().number,latitude:B().number,zoom:B().number,bearing:B().number,pitch:B().number}),default:B().object,name:B().string.isRequired};class mr extends n.Component{constructor(e){super(e),this.onChange=this.onChange.bind(this)}onChange(e,t){this.props.onChange({...this.props.value,[e]:t})}renderTextControl(e){return(0,Ze.BX)("div",{children:[(0,Ze.tZ)(yn.lX,{children:e}),(0,Ze.tZ)(dn.Z,{value:this.props.value[e],onChange:this.onChange.bind(this,e),isFloat:!0})]},e)}renderPopover(){return(0,Ze.tZ)("div",{id:`filter-popover-${this.props.name}`,children:fr.map((e=>this.renderTextControl(e)))})}renderLabel(){return this.props.value.longitude&&this.props.value.latitude?`${(0,pr.decimal2sexagesimal)(this.props.value.longitude)} | ${(0,pr.decimal2sexagesimal)(this.props.value.latitude)}`:"N/A"}render(){return(0,Ze.BX)("div",{children:[(0,Ze.tZ)(xt.Z,{...this.props}),(0,Ze.tZ)(Za.J,{container:document.body,trigger:"click",placement:"right",content:this.renderPopover(),title:(0,s.t)("Viewport"),children:(0,Ze.tZ)(Se.Z,{className:"pointer",children:this.renderLabel()})})]})}}mr.propTypes=gr,mr.defaultProps={onChange:()=>{},default:{type:"fix",value:5},value:{longitude:6.85236157047845,latitude:31.222656842808707,zoom:1,bearing:0,pitch:0}};var vr=a(920292),br=a(13284);const yr=[{name:"echarts_timeseries_line",icon:(0,Ze.tZ)(X.Z.LineChartTile,{})},{name:"echarts_timeseries_bar",icon:(0,Ze.tZ)(X.Z.BarChartTile,{})},{name:"echarts_area",icon:(0,Ze.tZ)(X.Z.AreaChartTile,{})},{name:"table",icon:(0,Ze.tZ)(X.Z.TableChartTile,{})},{name:"big_number_total",icon:(0,Ze.tZ)(X.Z.BigNumberChartTile,{})},{name:"pie",icon:(0,Ze.tZ)(X.Z.PieChartTile,{})}],xr={iconSize:"l",css:e=>I.iv`
    padding: ${e.gridUnit}px;
    & > * {
      line-height: 0;
    }
  `},wr=({isActive:e,isRendered:t,vizMeta:a,onTileClick:o})=>{var r;const{mountedPluginMetadata:i}=(0,H.gp)(),l=(0,n.useRef)(null),d=(0,N.Fg)(),c=2*d.transitionTiming,[u,h]=(0,n.useState)(!1),[p,f]=(0,n.useState)(!1),[g,m]=(0,n.useState)(!1),v=a.name?(null==(r=i[a.name])?void 0:r.name)||`${a.name}`:(0,s.t)("Select Viz Type"),b=(0,n.useCallback)((()=>{o(a.name),f(!0),h(!1),setTimeout((()=>{f(!1)}),1e3*c)}),[o,c,a.name]);(0,n.useEffect)((()=>{m(Boolean(!p&&(!e||l.current&&l.current.scrollWidth>l.current.clientWidth)))}),[e,p]);const y=(0,n.useMemo)((()=>e?{}:{role:"button",tabIndex:0,onClick:b}),[b,e]);let x=null;return g&&(x=t?(0,s.t)("Currently rendered: %s",v):v),(0,Ze.tZ)(z.u,{title:x,onVisibleChange:e=>h(e),visible:u&&!p,placement:"top",mouseEnterDelay:.4,children:(0,Ze.BX)("div",{...y,css:I.iv`
          display: flex;
          align-items: center;
          text-transform: uppercase;

          color: ${d.colors.grayscale.base};
          font-weight: ${d.typography.weights.bold};
          border-radius: 6px;
          white-space: nowrap;
          overflow: hidden;
          max-width: fit-content;

          ${!e&&I.iv`
            flex-shrink: 0;
            width: ${6*d.gridUnit}px;
            background-color: transparent;
            transition: none;
            &:hover svg path {
              fill: ${d.colors.primary.base};
              transition: fill ${d.transitionTiming}s ease-out;
            }
          `}

          ${e&&I.iv`
            width: 100%;
            background-color: ${d.colors.grayscale.light4};
            transition:
              width ${c}s ease-out,
              background-color ${c}s ease-out;
            cursor: default;
            svg path {
              fill: ${d.colors.primary.base};
            }
          `}
        `,children:[a.icon," ",(0,Ze.tZ)("span",{css:I.iv`
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: 0;
            padding-right: ${d.gridUnit}px;
          `,ref:l,children:v})]})})},Cr=(0,n.memo)((({currentSelection:e,onChange:t})=>{const a=(0,o.v9)((e=>{var t,a,n;return null==(t=e.charts)||null==(a=t[(0,oe.Jp)(e.explore)])||null==(n=a.latestQueryFormData)?void 0:n.viz_type})),r=(0,n.useMemo)((()=>{const t=[...yr];return e&&yr.every((t=>t.name!==e))&&e!==a&&t.unshift({name:e,icon:(0,Ze.tZ)(X.Z.MonitorOutlined,{...xr,"aria-label":"monitor"})}),a&&yr.every((e=>e.name!==a))&&t.unshift({name:a,icon:(0,Ze.tZ)(X.Z.CheckSquareOutlined,{...xr,"aria-label":"check-square"})}),t}),[e,a]);return(0,Ze.tZ)("div",{css:e=>I.iv`
          display: flex;
          justify-content: space-between;
          column-gap: ${e.gridUnit}px;
        `,children:r.map((n=>(0,Ze.tZ)(wr,{vizMeta:n,isActive:e===n.name,isRendered:a===n.name,onTileClick:t},n.name)))})})),Sr=((0,vr.Z)().common.conf.VIZ_TYPE_DENYLIST||[]).concat(Object.values(f.g2)),kr=(0,he.Z)();function Er({vizType:e}){return(0,H.gp)().loading||kr.has(e)?null:(0,Ze.BX)("div",{className:"text-danger",css:e=>I.iv`
        margin-top: ${e.gridUnit}px;
      `,children:[(0,Ze.tZ)("i",{className:"fa fa-exclamation-circle text-danger"})," ",(0,Ze.tZ)("small",{children:(0,s.t)("This visualization type is not supported.")})]})}const Zr=(0,N.iK)(at.default)`
  .ant-modal-body {
    padding: 0;
  }
`;var _r=a(361890),Mr=a(338575),Tr=a(480571),Or=a(281315);const Dr=(0,N.iK)(yt.Rn)`
  width: 100%;
`,Rr=N.iK.div`
  display: flex;
  justify-content: flex-end;
`,Br=[{value:Mr.s2.None,label:(0,s.t)("None")},{value:Mr.s2.GreaterThan,label:">"},{value:Mr.s2.LessThan,label:"<"},{value:Mr.s2.GreaterOrEqual,label:"≥"},{value:Mr.s2.LessOrEqual,label:"≤"},{value:Mr.s2.Equal,label:"="},{value:Mr.s2.NotEqual,label:"≠"},{value:Mr.s2.Between,label:"< x <"},{value:Mr.s2.BetweenOrEqual,label:"≤ x ≤"},{value:Mr.s2.BetweenOrLeftEqual,label:"≤ x <"},{value:Mr.s2.BetweenOrRightEqual,label:"< x ≤"}],Pr=(e,t)=>a=>(n,o)=>a&&o&&!e(Number(a),Number(o))?Promise.reject(new Error(t)):Promise.resolve(),Nr=Pr(((e,t)=>e>t),(0,s.t)("This value should be smaller than the right target value")),Ir=Pr(((e,t)=>e<t),(0,s.t)("This value should be greater than the left target value")),Ar=e=>e&&Mr.i3.includes(e),Lr=e=>!e||e===Mr.s2.None,$r=[{required:!0,message:(0,s.t)("Required")}],Fr=[{required:!0,message:(0,s.t)("Required")},({getFieldValue:e})=>({validator:Nr(e("targetValueRight"))})],jr=[{required:!0,message:(0,s.t)("Required")},({getFieldValue:e})=>({validator:Ir(e("targetValueLeft"))})],Hr=["targetValueRight"],zr=["targetValueLeft"],Xr=(e,t)=>Lr(e.operator)!==Lr(t.operator)||Ar(e.operator)!==Ar(t.operator),Wr=({showOnlyNone:e}={})=>(0,Ze.tZ)(yn.xJ,{name:"operator",label:(0,s.t)("Operator"),rules:$r,initialValue:Br[0].value,children:(0,Ze.tZ)(Or.Z,{ariaLabel:(0,s.t)("Operator"),options:e?[Br[0]]:Br})}),Ur=({getFieldValue:e})=>Lr(e("operator"))?(0,Ze.tZ)(it.X2,{gutter:12,children:(0,Ze.tZ)(it.JX,{span:6,children:Wr()})}):Ar(e("operator"))?(0,Ze.BX)(it.X2,{gutter:12,children:[(0,Ze.tZ)(it.JX,{span:9,children:(0,Ze.tZ)(yn.xJ,{name:"targetValueLeft",label:(0,s.t)("Left value"),rules:Fr,dependencies:Hr,validateTrigger:"onBlur",trigger:"onBlur",children:(0,Ze.tZ)(Dr,{})})}),(0,Ze.tZ)(it.JX,{span:6,children:Wr()}),(0,Ze.tZ)(it.JX,{span:9,children:(0,Ze.tZ)(yn.xJ,{name:"targetValueRight",label:(0,s.t)("Right value"),rules:jr,dependencies:zr,validateTrigger:"onBlur",trigger:"onBlur",children:(0,Ze.tZ)(Dr,{})})})]}):(0,Ze.BX)(it.X2,{gutter:12,children:[(0,Ze.tZ)(it.JX,{span:6,children:Wr()}),(0,Ze.tZ)(it.JX,{span:18,children:(0,Ze.tZ)(yn.xJ,{name:"targetValue",label:(0,s.t)("Target value"),rules:$r,children:(0,Ze.tZ)(Dr,{})})})]}),qr=({config:e,onChange:t,columns:a=[],extraColorChoices:o=[]})=>{var r;const i=[{value:(c=(0,N.Fg)()).colors.success.light1,label:(0,s.t)("success")},{value:c.colors.alert.light1,label:(0,s.t)("alert")},{value:c.colors.error.light1,label:(0,s.t)("error")},{value:c.colors.success.dark1,label:(0,s.t)("success dark")},{value:c.colors.alert.dark1,label:(0,s.t)("alert dark")},{value:c.colors.error.dark1,label:(0,s.t)("error dark")}],[l,d]=(0,n.useState)(void 0===e||(null==e?void 0:e.colorScheme)!==Tr.v.Green&&(null==e?void 0:e.colorScheme)!==Tr.v.Red);var c;return(0,Ze.BX)(yn.l0,{onFinish:t,initialValues:e,requiredMark:"optional",layout:"vertical",children:[(0,Ze.BX)(it.X2,{gutter:12,children:[(0,Ze.tZ)(it.JX,{span:12,children:(0,Ze.tZ)(yn.xJ,{name:"column",label:(0,s.t)("Column"),rules:$r,initialValue:null==(r=a[0])?void 0:r.value,children:(0,Ze.tZ)(Or.Z,{ariaLabel:(0,s.t)("Select column"),options:a})})}),(0,Ze.tZ)(it.JX,{span:12,children:(0,Ze.tZ)(yn.xJ,{name:"colorScheme",label:(0,s.t)("Color scheme"),rules:$r,initialValue:i[0].value,children:(0,Ze.tZ)(Or.Z,{onChange:e=>(e=>{d(!(e===Tr.v.Green||e===Tr.v.Red))})(e),ariaLabel:(0,s.t)("Color scheme"),options:[...i,...o]})})})]}),(0,Ze.tZ)(yn.xJ,{noStyle:!0,shouldUpdate:Xr,children:l?Ur:(0,Ze.tZ)(it.X2,{gutter:12,children:(0,Ze.tZ)(it.JX,{span:6,children:Wr({showOnlyNone:!0})})})}),(0,Ze.tZ)(yn.xJ,{children:(0,Ze.tZ)(Rr,{children:(0,Ze.tZ)(Re.Z,{htmlType:"submit",buttonStyle:"primary",children:(0,s.t)("Apply")})})})]})},Vr=({title:e,columns:t,onChange:a,config:o,children:r,extraColorChoices:i,...l})=>{const[s,d]=(0,n.useState)(!1),c=(0,n.useCallback)((e=>{d(!1),a(e)}),[a]);return(0,Ze.tZ)(Za.J,{title:e,content:(0,Ze.tZ)(qr,{onChange:c,config:o,columns:t,extraColorChoices:i}),visible:s,onVisibleChange:d,trigger:["click"],overlayStyle:{width:"450px"},...l,children:r})},Gr=N.iK.div`
  ${({theme:e})=>I.iv`
    padding: ${e.gridUnit}px;
    border: solid 1px ${e.colors.grayscale.light2};
    border-radius: ${e.gridUnit}px;
  `}
`,Kr=(0,N.iK)(ga.EQ)`
  &,
  & > div {
    margin-bottom: ${({theme:e})=>e.gridUnit}px;
    :last-child {
      margin-bottom: 0;
    }
  }
`,Yr=N.iK.button`
  ${({theme:e})=>I.iv`
    color: ${e.colors.grayscale.light1};
    height: 100%;
    width: ${6*e.gridUnit}px;
    border: none;
    border-right: solid 1px ${e.colors.grayscale.dark2}0C;
    padding: 0;
    outline: none;
    border-bottom-left-radius: 3px;
    border-top-left-radius: 3px;
  `}
`,Qr=({value:e,onChange:t,columnOptions:a,verboseMap:o,removeIrrelevantConditions:r,extraColorChoices:i,...l})=>{const d=(0,N.Fg)(),[c,u]=(0,n.useState)(null!=e?e:[]);(0,n.useEffect)((()=>{t&&t(c)}),[c,t]),(0,n.useEffect)((()=>{if(r){const e=c.filter((e=>a.some((t=>(null==t?void 0:t.value)===(null==e?void 0:e.column)))));e.length!==c.length&&r&&u(e)}}),[c,a,r]);const h=({column:e,operator:t,targetValue:a,targetValueLeft:n,targetValueRight:r})=>{var i;const l=null!=(i=e&&(null==o?void 0:o[e]))?i:e;switch(t){case Mr.s2.None:return`${l}`;case Mr.s2.Between:return`${n} ${Mr.s2.LessThan} ${l} ${Mr.s2.LessThan} ${r}`;case Mr.s2.BetweenOrEqual:return`${n} ${Mr.s2.LessOrEqual} ${l} ${Mr.s2.LessOrEqual} ${r}`;case Mr.s2.BetweenOrLeftEqual:return`${n} ${Mr.s2.LessOrEqual} ${l} ${Mr.s2.LessThan} ${r}`;case Mr.s2.BetweenOrRightEqual:return`${n} ${Mr.s2.LessThan} ${l} ${Mr.s2.LessOrEqual} ${r}`;default:return`${l} ${t} ${a}`}};return(0,Ze.BX)("div",{children:[(0,Ze.tZ)(xt.Z,{...l}),(0,Ze.BX)(Gr,{children:[c.map(((e,t)=>(0,Ze.BX)(Kr,{children:[(0,Ze.tZ)(Yr,{onClick:()=>(e=>{u((t=>t.filter(((t,a)=>a!==e))))})(t),children:(0,Ze.tZ)(X.Z.XSmall,{iconColor:d.colors.grayscale.light1})}),(0,Ze.tZ)(Vr,{title:(0,s.t)("Edit formatter"),config:e,columns:a,onChange:e=>((e,t)=>{const a=[...c];a.splice(t,1,e),u(a)})(e,t),destroyTooltipOnHide:!0,extraColorChoices:i,children:(0,Ze.BX)(ga.EQ,{withCaret:!0,children:[(0,Ze.tZ)(ga.__,{children:h(e)}),(0,Ze.tZ)(ga.Ne,{children:(0,Ze.tZ)(X.Z.CaretRight,{iconColor:d.colors.grayscale.light1})})]})})]},t))),(0,Ze.tZ)(Vr,{title:(0,s.t)("Add new formatter"),columns:a,onChange:e=>{u((t=>[...t,e]))},destroyTooltipOnHide:!0,extraColorChoices:i,children:(0,Ze.BX)(ga.SW,{children:[(0,Ze.tZ)(X.Z.PlusSmall,{iconColor:d.colors.grayscale.light1}),(0,s.t)("Add new color formatter")]})})]})]})};var Jr=a(822068),ei=a(40917);const ti=(0,n.createContext)(!1),ai=(0,n.createContext)([{},()=>{}]),ni=N.iK.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0;
`,oi=(e={},t)=>{if(t.canDrop)return{...e,[t.key]:t.canDrop};if(t.key){const a={...e};return delete a[t.key],a}return e},ri=({children:e})=>{const t=(0,ei.N)(),[a,o]=(0,n.useState)(t.getMonitor().isDragging());(0,n.useEffect)((()=>{const e=t.getMonitor(),a=e.subscribeToStateChange((()=>{if("dragIndex"in(e.getItem()||{}))return;const t=e.isDragging();o(t)}));return()=>{a()}}),[t]);const r=(0,n.useReducer)(oi,{});return(0,Ze.tZ)(ai.Provider,{value:r,children:(0,Ze.tZ)(ti.Provider,{value:a,children:(0,Ze.tZ)(ni,{children:e})})})};function ii({displayGhostButton:e=!0,accept:t,valuesRenderer:a,isLoading:o,...r}){const i=(0,N.Fg)(),l=r.canDrop,d=r.canDropValue,c=(0,n.useCallback)((e=>{var t;return l(e)&&(null==(t=null==d?void 0:d(e.value))||t)}),[l,d]),[{isOver:u,canDrop:h},p]=(0,Jr.L)({accept:o?[]:t,drop:e=>{r.onDrop(e),null==r.onDropValue||r.onDropValue(e.value)},canDrop:c,collect:e=>({isOver:e.isOver(),canDrop:e.canDrop(),type:e.getItemType()})}),f=(0,n.useContext)(ai)[1];(0,n.useEffect)((()=>(f({key:r.name,canDrop:c}),()=>{f({key:r.name})})),[f,r.name,c]);const g=(0,n.useContext)(ti),m=(0,n.useMemo)((()=>a()),[a]);return(0,Ze.BX)("div",{ref:p,children:[(0,Ze.tZ)(ga.gM,{children:(0,Ze.tZ)(xt.Z,{...r})}),(0,Ze.BX)(ga.H$,{canDrop:h,isOver:u,isDragging:g,isLoading:o,children:[m,e&&(0,Ze.BX)(ga.SW,{cancelHover:!r.onClickGhostButton,onClick:r.onClickGhostButton,children:[(0,Ze.tZ)(X.Z.PlusSmall,{iconColor:i.colors.grayscale.light1}),(0,s.t)(r.ghostButtonText)]})]})]})}var li,si=a(375294);!function(e){e.Isoline="ISOLINE",e.Isoband="ISOBAND"}(li||(li={}));const di=N.iK.div`
  margin-top: ${({theme:e})=>2*e.gridUnit}px;
`,ci=(0,N.iK)(it.X2)`
  width: 100%;
  gap: ${({theme:e})=>2*e.gridUnit}px;
`,ui=e=>e&&(e=>!(Object.keys(e).length<4)&&e.upperThreshold&&e.lowerThreshold)(e)?li.Isoband:li.Isoline,hi=(e,t)=>{const a={lowerThreshold:[],upperThreshold:[],strokeWidth:[],color:[]},n=(0,si.Z)(t.lowerThreshold);if(n&&a.lowerThreshold.push(n),e===li.Isoline){const e=(0,si.Z)(t.strokeWidth);e&&a.strokeWidth.push(e)}if(e===li.Isoband){const e=(0,si.Z)(t.upperThreshold);e&&a.upperThreshold.push(e),!e&&!n&&t.upperThreshold&&t.lowerThreshold&&parseFloat(t.lowerThreshold)>=parseFloat(t.upperThreshold)&&(a.lowerThreshold.push((0,s.t)("Lower threshold must be lower than upper threshold")),a.upperThreshold.push((0,s.t)("Upper threshold must be greater than lower threshold")))}return a},pi={lowerThreshold:void 0,upperThreshold:void 0,color:void 0,strokeWidth:void 0},fi=({value:e,onSave:t,onClose:a})=>{const[o,r]=(0,n.useState)(ui(e)),[i,l]=(0,n.useState)(e||pi),[d,c]=(0,n.useState)(hi(ui(e),e||pi)),[u,h]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=o===li.Isoband,t=Boolean(i.lowerThreshold)||0===i.lowerThreshold,a=Boolean(i.upperThreshold)||0===i.upperThreshold,n=Boolean(i.strokeWidth)||0===i.strokeWidth,r="object"==typeof i.color&&"r"in i.color&&"number"==typeof i.color.r&&"g"in i.color&&"number"==typeof i.color.g&&"b"in i.color&&"number"==typeof i.color.b&&"a"in i.color&&"number"==typeof i.color.a,l=hi(o,i);l!==d&&c(l);const s=e?t&&a&&r:t&&r&&n;s!==u&&h(s)}),[i,o]);const p=e=>{const t={...i};t.color={...e,a:100},l(t)},f=e=>{const t={...i};t.lowerThreshold=e,l(t)};return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.BX)(tt.ZP,{id:"contour-edit-tabs",onChange:e=>{r(e)},defaultActiveKey:ui(e),children:[(0,Ze.tZ)(tt.ZP.TabPane,{className:"adhoc-filter-edit-tab",tab:(0,s.t)("Isoline"),children:(0,Ze.BX)("div",{className:"isoline-popover-section",children:[(0,Ze.tZ)(ci,{children:(0,Ze.BX)(it.JX,{flex:"1",children:[(0,Ze.tZ)(xt.Z,{name:"isoline-threshold",label:(0,s.t)("Threshold"),description:(0,s.t)("Defines the value that determines the boundary between different regions or levels in the data "),validationErrors:d.lowerThreshold,hovered:!0}),(0,Ze.tZ)(dn.Z,{value:i.lowerThreshold,onChange:f})]})}),(0,Ze.BX)(ci,{children:[(0,Ze.BX)(it.JX,{flex:"1",children:[(0,Ze.tZ)(xt.Z,{name:"isoline-stroke-width",label:(0,s.t)("Stroke Width"),description:(0,s.t)("The width of the Isoline in pixels"),validationErrors:d.strokeWidth,hovered:!0}),(0,Ze.tZ)(dn.Z,{value:i.strokeWidth||"",onChange:e=>{const t={...i};t.strokeWidth=e,l(t)}})]}),(0,Ze.BX)(it.JX,{flex:"1",children:[(0,Ze.tZ)(xt.Z,{name:"isoline-color",label:(0,s.t)("Color"),description:(0,s.t)("The color of the isoline"),validationErrors:d.color,hovered:!0}),(0,Ze.tZ)(Da,{value:"object"==typeof i&&(null==i?void 0:i.color),onChange:p})]})]})]},li.Isoline)},li.Isoline),(0,Ze.tZ)(tt.ZP.TabPane,{className:"adhoc-filter-edit-tab",tab:(0,s.t)("Isoband"),children:(0,Ze.BX)("div",{className:"isoline-popover-section",children:[(0,Ze.BX)(ci,{children:[(0,Ze.BX)(it.JX,{flex:"1",children:[(0,Ze.tZ)(xt.Z,{name:"isoband-threshold-lower",label:(0,s.t)("Lower Threshold"),description:(0,s.t)("The lower limit of the threshold range of the Isoband"),validationErrors:d.lowerThreshold,hovered:!0}),(0,Ze.tZ)(dn.Z,{value:i.lowerThreshold||"",onChange:f})]}),(0,Ze.BX)(it.JX,{flex:"1",children:[(0,Ze.tZ)(xt.Z,{name:"isoband-threshold-upper",label:(0,s.t)("Upper Threshold"),description:(0,s.t)("The upper limit of the threshold range of the Isoband"),validationErrors:d.upperThreshold,hovered:!0}),(0,Ze.tZ)(dn.Z,{value:i.upperThreshold||"",onChange:e=>{const t={...i};t.upperThreshold=e,l(t)}})]})]}),(0,Ze.tZ)(ci,{children:(0,Ze.BX)(it.JX,{flex:"1",children:[(0,Ze.tZ)(xt.Z,{name:"isoband-color",label:(0,s.t)("Color"),description:(0,s.t)("The color of the isoband"),validationErrors:d.color,hovered:!0}),(0,Ze.tZ)(Da,{value:null==i?void 0:i.color,onChange:p})]})})]},li.Isoband)},li.Isoband)]}),(0,Ze.BX)(di,{children:[(0,Ze.tZ)(Re.Z,{buttonSize:"small",onClick:a,cta:!0,children:(0,s.t)("Close")}),(0,Ze.tZ)(Re.Z,{disabled:!u||Object.keys(d).some((e=>d[e].length>0)),buttonStyle:"primary",buttonSize:"small",className:"m-r-5",onClick:()=>{if(u&&t){const e=o===li.Isoline?(e=>({color:e.color,lowerThreshold:e.lowerThreshold,upperThreshold:void 0,strokeWidth:e.strokeWidth}))(i):(e=>({color:e.color,lowerThreshold:e.lowerThreshold,upperThreshold:e.upperThreshold,strokeWidth:void 0}))(i);t((e=>{const t={...e};return["lowerThreshold","upperThreshold","strokeWidth"].forEach((e=>{t[e]=Number(t[e])})),t})(e)),a&&a()}},cta:!0,children:(0,s.t)("Save")})]})]})},gi=({value:e,saveContour:t,isControlled:a,visible:o,toggleVisibility:r,...i})=>{const[l,s]=(0,n.useState)(!1),d=a?o:l,c=a&&r?r:s,u=(0,Ze.tZ)(fi,{value:e,onSave:t,onClose:()=>c(!1)});return(0,Ze.tZ)(ut.Z,{trigger:"click",content:u,defaultVisible:d,visible:d,onVisibleChange:c,destroyTooltipOnHide:!0,children:i.children})};var mi=a(727034),vi=a(472813);const bi=(0,N.iK)(st.V)`
  margin: 0 ${({theme:e})=>e.gridUnit}px;
`;function yi({children:e,index:t,clickClose:a,withCaret:o,isExtra:r,datasourceWarningMessage:i,canDelete:l=!0}){const d=(0,N.Fg)(),c=(0,n.useCallback)((e=>{e.stopPropagation(),a(t)}),[a,t]);return(0,Ze.BX)(ga.EQ,{withCaret:o,children:[l&&(0,Ze.tZ)(ga.gu,{role:"button",onClick:c,children:(0,Ze.tZ)(X.Z.XSmall,{iconColor:d.colors.grayscale.light1})}),(0,Ze.tZ)(ga.__,{children:e}),(!!i||r)&&(0,Ze.tZ)(bi,{icon:"exclamation-triangle",placement:"top",bsStyle:"warning",tooltip:i||(0,s.t)("\n                This filter was inherited from the dashboard's context.\n                It won't be saved when saving the chart.\n              ")}),o&&(0,Ze.tZ)(ga.Ne,{children:(0,Ze.tZ)(X.Z.CaretRight,{iconColor:d.colors.grayscale.light1})})]})}const xi=N.iK.div`
  width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;function wi(e){const{index:t,label:a,tooltipTitle:o,column:r,type:i,onShiftOptions:l,clickClose:s,withCaret:d,isExtra:c,datasourceWarningMessage:u,canDelete:h=!0,tooltipOverlay:p,...f}=e,g=(0,n.useRef)(null),m=(0,n.useRef)(null),[{isDragging:v},b]=(0,mi.c)({item:{type:i,dragIndex:t},collect:e=>({isDragging:e.isDragging()})}),[,y]=(0,Jr.L)({accept:i,hover:(e,a)=>{var n;if(!g.current)return;const{dragIndex:o}=e,r=t;if(o===r)return;const i=null==(n=g.current)?void 0:n.getBoundingClientRect(),s=(i.bottom-i.top)/2,d=a.getClientOffset(),c=d?d.y-i.top:0;o<r&&c<s||o>r&&c>s||(l(o,r),e.dragIndex=r)}}),x=!v&&o&&a&&o!==a||!v&&m&&m.current&&m.current.scrollWidth>m.current.clientWidth||!v&&p,w=()=>x?p?(0,Ze.tZ)(z.u,{overlay:p,children:(0,Ze.tZ)("span",{children:a})}):(0,Ze.tZ)(z.u,{title:o||a,children:(0,Ze.tZ)("span",{children:a})}):(0,Ze.tZ)("span",{children:a}),C=()=>{const e=r&&(0,vi.GA)(r)?{verbose_name:r.label,expression:r.sqlExpression}:r;return(0,Ze.tZ)(Sn.l,{column:e,labelRef:m,showType:!0})};return b(y(g)),(0,Ze.tZ)(ga.a7,{ref:g,...f,children:(0,Ze.tZ)(yi,{index:t,clickClose:s,withCaret:d,isExtra:c,datasourceWarningMessage:u,canDelete:h,children:(0,Ze.tZ)((()=>a?(0,Ze.tZ)(xi,{ref:m,children:(0,Ze.tZ)(w,{})}):r?(0,Ze.tZ)(xi,{children:(0,Ze.tZ)(C,{})}):null),{})})})}const Ci=(0,N.iK)(wi)`
  max-width: 100%;
  min-width: 100%;
`,Si=N.iK.li`
  display: flex;
  align-items: center;
`,ki=N.iK.div`
  background-color: ${({formattedColor:e})=>e};
  height: ${({theme:e})=>e.gridUnit}px;
  width: ${({theme:e})=>e.gridUnit}px;
  margin: 0 ${({theme:e})=>e.gridUnit}px;
`,Ei=({contour:e,index:t,saveContour:a,onClose:n,onShift:o})=>{const{lowerThreshold:r,upperThreshold:i,color:l,strokeWidth:d}=e,c=i,u=l?`rgba(${l.r}, ${l.g}, ${l.b}, 1)`:"undefined",h=c?(p=[r||-1,i],`${(0,s.t)("Threshold")}: [${p[0]}, ${p[1]}], color: ${u}`):((e,t)=>`${(0,s.t)("Threshold")}: ${e}, ${(0,s.t)("color")}: ${u}, ${(0,s.t)("stroke width")}: ${t}`)(r||-1,d);var p;const f=(0,Ze.BX)("div",{className:"contour-tooltip-overlay",children:[(0,Ze.BX)(Si,{children:[(0,s.t)("Threshold: "),c?`[${r}, ${i}]`:`${r}`]}),(0,Ze.BX)(Si,{children:[(0,s.t)("Color: "),(0,Ze.tZ)(ki,{formattedColor:u})," ",u]}),!c&&(0,Ze.tZ)(Si,{children:`${(0,s.t)("Stroke Width:")} ${d}`})]});return(0,Ze.tZ)(gi,{saveContour:a,value:e,children:(0,Ze.tZ)(Ci,{index:t,label:h,type:"ContourOption",withCaret:!0,clickClose:n,onShiftOptions:o,tooltipOverlay:f})})},Zi=[{lowerThreshold:4,color:{r:255,g:0,b:255,a:100},strokeWidth:1,zIndex:0},{lowerThreshold:5,color:{r:0,g:255,b:0,a:100},strokeWidth:2,zIndex:1},{lowerThreshold:6,upperThreshold:10,color:{r:0,g:0,b:255,a:100},zIndex:2}],_i=(0,N.iK)("div")`
  position: relative;
  width: calc(100% - ${({theme:e})=>e.gridUnit}px);
  bottom: ${({theme:e})=>4*e.gridUnit}px;
  left: 0;
`,Mi=e=>(0,Mr.xN)(e)?e.column_name:e;class Ti{constructor(e,t,a){this.values=void 0,this.options=void 0,this.multi=void 0,this.options=e,this.multi=t,this.values=(0,fe.Z)(a).map((t=>t&&(0,vi.s9)(t)&&t in e?e[t]:(0,vi.s9)(t)?{type_generic:"UNKNOWN",column_name:t,error_text:(0,s.t)("This column might be incompatible with current dataset")}:t)).filter(Boolean)}add(e){(0,vi.s9)(e)&&e in this.options?this.values.push(this.options[e]):(0,vi.s9)(e)||this.values.push(e)}del(e){this.values.splice(e,1)}replace(e,t){this.values[e]&&(this.values[e]=(0,vi.s9)(t)?this.options[t]:t)}swap(e,t){[this.values[e],this.values[t]]=[this.values[t],this.values[e]]}has(e){return this.values.some((t=>(0,vi.s9)(e)?t.column_name===e||t.label===e:t.column_name===e.label||t.label===e.label))}getValues(){return this.multi?this.values.map(Mi):this.values.length>0?Mi(this.values[0]):void 0}}var Oi=a(823493),Di=a.n(Oi);const Ri=(0,N.iK)(it.Ph)`
  .metric-option {
    & > svg {
      min-width: ${({theme:e})=>4*e.gridUnit+"px"};
    }
    & > .option-label {
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }
`,Bi=({columns:e,editedColumn:t,getCurrentTab:a,hasCustomLabel:r,isTemporal:i,label:l,onChange:d,onClose:c,setDatasetModal:u,setLabel:h,disabledTabs:p=new Set})=>{const f=(0,o.v9)((e=>e.explore.datasource.type)),[g]=(0,n.useState)(l),[m,v,b]=(e=>e?(0,vi.GA)(e)?[e,void 0,void 0]:(0,Mr.zy)(e)?[void 0,e,void 0]:[void 0,void 0,e]:[void 0,void 0,void 0])(t),[y,x]=(0,n.useState)(m),[w,C]=(0,n.useState)(v),[S,k]=(0,n.useState)(b),[E,Z]=(0,n.useState)(null),[_,M,T]=function(e,t){const[a,o]=(0,n.useState)(U.kc),[r,i]=(0,n.useState)(U.H7),[l,s]=(0,n.useState)(0),[d,c]=(0,n.useState)(0),[u,h]=(0,n.useState)(0),[p,f]=(0,n.useState)(0),[g,m]=(0,n.useState)(a),[v,b]=(0,n.useState)(r),[y,x]=(0,n.useState)(!1),w=(0,n.useCallback)((e=>{e.preventDefault(),s(e.clientX),c(e.clientY)}),[]),C=(0,n.useCallback)((()=>{x(!1)}),[]),S=(0,n.useCallback)((e=>{h(e.clientX),f(e.clientY),x(!0)}),[]);(0,n.useEffect)((()=>{y?document.addEventListener("mousemove",w):(m(a),b(r),document.removeEventListener("mousemove",w))}),[w,y]);const k=(0,n.useCallback)(Di()((({dragStartX:e,dragStartY:t,dragStartWidth:a,dragStartHeight:n,clientX:r,clientY:l,minWidth:s,minHeight:d})=>{o(Math.max(a+(r-e),s)),i(Math.max(n+(l-t),d))}),50),[i,o]);return(0,n.useEffect)((()=>{y&&k({dragStartX:u,dragStartY:p,dragStartWidth:g,dragStartHeight:v,clientX:l,clientY:d,minWidth:e,minHeight:t})}),[y,l,d,g,v,u,p]),(0,n.useEffect)((()=>(document.addEventListener("mouseup",C),()=>document.removeEventListener("mouseup",C))),[C]),[(0,Ze.tZ)("i",{role:"button","aria-label":"Resize",tabIndex:0,onMouseDown:S,className:"fa fa-expand edit-popover-resize text-muted"}),a,r]}(U.kc,U.H7),O=(0,n.useRef)(null),[D,R]=(0,n.useMemo)((()=>null==e?void 0:e.reduce(((e,t)=>(t.expression?e[0].push(t):e[1].push(t),e)),[[],[]])),[e]),B=(0,n.useCallback)((e=>{x({label:l,sqlExpression:e,expressionType:"SQL"}),k(void 0),C(void 0)}),[l]),P=(0,n.useCallback)((e=>{const t=D.find((t=>t.column_name===e));C(t),k(void 0),x(void 0),h((null==t?void 0:t.verbose_name)||(null==t?void 0:t.column_name)||"")}),[D,h]),N=(0,n.useCallback)((e=>{const t=R.find((t=>t.column_name===e));C(void 0),k(t),x(void 0),h((null==t?void 0:t.verbose_name)||(null==t?void 0:t.column_name)||"")}),[h,R]),A=m?"sqlExpression":w?"saved":"simple";(0,n.useEffect)((()=>{a(A),Z(A)}),[A,a,Z]),(0,n.useEffect)((()=>{if(void 0===y&&"sqlExpression"===E&&r){const e=(null==S?void 0:S.column_name)||(null==w?void 0:w.expression)||"";x({label:l,sqlExpression:e,expressionType:"SQL"})}}),[y,A,r,a,l,w,S,E]);const L=(0,n.useCallback)((()=>{y&&y.label!==l&&(y.label=l);const e=y||w||S;e&&(d(e),c())}),[y,l,d,c,w,S]),$=(0,n.useCallback)((()=>{C(v),k(b),x(m),c()}),[m,v,b,c]),F=(0,n.useCallback)((e=>{var t;a(e),Z(e),null==(t=O.current)||t.editor.focus()}),[a]),j=(0,n.useCallback)((()=>{var e;null==(e=O.current)||e.editor.resize()}),[]),H=()=>{u&&u(!0),c()},z=y||w||S,X=g!==l||(null==w?void 0:w.column_name)!==(null==v?void 0:v.column_name)||(null==S?void 0:S.column_name)!==(null==b?void 0:b.column_name)||(null==y?void 0:y.sqlExpression)!==(null==m?void 0:m.sqlExpression),W=(0,s.t)("Saved expressions"),q=(0,s.t)("Column"),V=(0,n.useMemo)((()=>wn.Z.concat((0,kn.j)(e))),[e]);return(0,Ze.BX)(yn.l0,{layout:"vertical",id:"metrics-edit-popover",children:[(0,Ze.BX)(tt.ZP,{id:"adhoc-metric-edit-tabs",defaultActiveKey:A,onChange:F,className:"adhoc-metric-edit-tabs",allowOverflow:!0,css:I.iv`
          height: ${T}px;
          width: ${M}px;
        `,children:[(0,Ze.tZ)(tt.ZP.TabPane,{tab:(0,s.t)("Saved"),disabled:p.has("saved"),children:D.length>0?(0,Ze.tZ)(yn.xJ,{label:W,children:(0,Ze.tZ)(Ri,{ariaLabel:W,value:null==w?void 0:w.column_name,onChange:P,allowClear:!0,autoFocus:!w,placeholder:(0,s.t)("%s column(s)",D.length),options:D.map((e=>({value:e.column_name,label:e.verbose_name||e.column_name,customLabel:(0,Ze.tZ)(Sn.l,{column:e,showType:!0}),key:e.column_name})))})}):f===pe.i9.Table?(0,Ze.tZ)(bn.Tc,{image:"empty.svg",title:i?(0,s.t)("No temporal columns found"):(0,s.t)("No saved expressions found"),description:i?(0,s.t)('Add calculated temporal columns to dataset in "Edit datasource" modal'):(0,s.t)('Add calculated columns to dataset in "Edit datasource" modal')}):(0,Ze.tZ)(bn.Tc,{image:"empty.svg",title:i?(0,s.t)("No temporal columns found"):(0,s.t)("No saved expressions found"),description:i?(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("span",{role:"button",tabIndex:0,onClick:H,children:(0,s.t)("Create a dataset")})," ",(0,s.t)(" to mark a column as a time column")]}):(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("span",{role:"button",tabIndex:0,onClick:H,children:(0,s.t)("Create a dataset")})," ",(0,s.t)(" to add calculated columns")]})})},"saved"),(0,Ze.tZ)(tt.ZP.TabPane,{tab:(0,s.t)("Simple"),disabled:p.has("simple"),children:i&&0===R.length?(0,Ze.tZ)(bn.Tc,{image:"empty.svg",title:(0,s.t)("No temporal columns found"),description:f===pe.i9.Table?(0,s.t)('Mark a column as temporal in "Edit datasource" modal'):(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("span",{role:"button",tabIndex:0,onClick:H,children:(0,s.t)("Create a dataset")})," ",(0,s.t)(" to mark a column as a time column")]})}):(0,Ze.tZ)(yn.xJ,{label:q,children:(0,Ze.tZ)(it.Ph,{ariaLabel:q,value:null==S?void 0:S.column_name,onChange:N,allowClear:!0,autoFocus:!S,placeholder:(0,s.t)("%s column(s)",R.length),options:R.map((e=>({value:e.column_name,label:e.verbose_name||e.column_name,customLabel:(0,Ze.tZ)(Sn.l,{column:e,showType:!0}),key:e.column_name})))})})},"simple"),(0,Ze.tZ)(tt.ZP.TabPane,{tab:(0,s.t)("Custom SQL"),disabled:p.has("sqlExpression"),children:(0,Ze.tZ)(xn.iO,{value:(null==y?void 0:y.sqlExpression)||(null==S?void 0:S.column_name)||(null==w?void 0:w.expression),onFocus:j,showLoadingForImport:!0,onChange:B,width:"100%",height:T-80+"px",showGutter:!1,editorProps:{$blockScrolling:!0},enableLiveAutocompletion:!0,className:"filter-sql-editor",wrapEnabled:!0,ref:O,keywords:V})},"sqlExpression")]}),(0,Ze.BX)("div",{children:[(0,Ze.tZ)(Re.Z,{buttonSize:"small",onClick:$,cta:!0,children:(0,s.t)("Close")}),(0,Ze.tZ)(Re.Z,{disabled:!z||!X,buttonStyle:"primary",buttonSize:"small",onClick:L,cta:!0,children:(0,s.t)("Save")}),_]})]})},Pi=(0,N.iK)(yt.II)`
  border-radius: ${({theme:e})=>e.borderRadius};
  height: 26px;
  padding-left: ${({theme:e})=>2.5*e.gridUnit}px;
`,Ni=({title:e,onChange:t,isEditDisabled:a,hasCustomLabel:o})=>{const[r,i]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),c=(0,n.useCallback)((()=>{i(!0)}),[]),u=(0,n.useCallback)((()=>{i(!1)}),[]),h=(0,n.useCallback)((()=>{d(!0)}),[]),p=(0,n.useCallback)((()=>{d(!1)}),[]),f=(0,n.useCallback)((e=>{""===e.target.value&&t(e),p()}),[p,t]),g=(0,s.t)("My column");return a?(0,Ze.tZ)("span",{children:e||g}):l?(0,Ze.tZ)(Pi,{type:"text",placeholder:e,value:o?e:"",autoFocus:!0,onChange:t,onBlur:f}):(0,Ze.tZ)(z.u,{placement:"top",title:(0,s.t)("Click to edit label"),children:(0,Ze.BX)("span",{className:"AdhocMetricEditPopoverTitle inline-editable",onMouseOver:c,onMouseOut:u,onClick:h,onBlur:p,role:"button",tabIndex:0,children:[e||g," ",(0,Ze.tZ)("i",{className:"fa fa-pencil",style:{color:r?"black":"grey"}})]})})},Ii=(0,s.t)("My column"),Ai=({columns:e,editedColumn:t,onColumnEdit:a,isControlledComponent:r,children:i,isTemporal:l,disabledTabs:d,...c})=>{const u=(0,o.v9)((e=>e.explore.datasource)),[h,p]=(0,n.useState)(Ii),[f,g]=(0,n.useState)(!1),[m,v]=(0,n.useState)(!0),[b,y]=(0,n.useState)(!1),[x,w]=(0,n.useState)(!1);let C=Ii;t&&(0,Mr.xN)(t)?C=t.verbose_name||t.column_name:t&&(0,vi.GA)(t)&&(C=t.label||Ii),(0,n.useEffect)((()=>{p(C)}),[C,f]);const S=(0,n.useCallback)((e=>{g(e)}),[]),k=(0,n.useCallback)((()=>{g(!1)}),[]),{visible:E,handleTogglePopover:Z,handleClosePopover:_}=r?{visible:c.visible,handleTogglePopover:c.togglePopover,handleClosePopover:c.closePopover}:{visible:f,handleTogglePopover:S,handleClosePopover:k},M=(0,n.useCallback)((e=>{v("sqlExpression"!==e)}),[]),T=(0,n.useMemo)((()=>(0,Ze.tZ)(vn.b,{children:(0,Ze.tZ)(Bi,{editedColumn:t,columns:e,setDatasetModal:w,onClose:_,onChange:a,hasCustomLabel:b,label:h,setLabel:p,getCurrentTab:M,isTemporal:l,disabledTabs:d})})),[e,t,M,b,_,l,a,h,d]),O=(0,n.useCallback)((e=>{p(e.target.value),y(!0)}),[p,y]),D=(0,n.useMemo)((()=>(0,Ze.tZ)(Ni,{title:h,onChange:O,isEditDisabled:m,hasCustomLabel:b})),[b,m,O,h]);return(0,Ze.BX)(Ze.HY,{children:[x&&(0,Ze.tZ)(be.W,{visible:x,onHide:()=>w(!1),buttonTextOnSave:(0,s.t)("Save"),buttonTextOnOverwrite:(0,s.t)("Overwrite"),modalDescription:(0,s.t)("Save this query as a virtual dataset to continue exploring"),datasource:u}),(0,Ze.tZ)(ut.Z,{trigger:"click",content:T,defaultVisible:E,visible:E,onVisibleChange:Z,title:D,destroyTooltipOnHide:!0,children:i})]})};var Li=a(96055),$i=a(328543),Fi=a(7848);function ji({adhocFilter:e,options:t,datasource:a,onFilterEdit:n,onShiftOptions:o,onClickClose:r,partitionColumn:i,index:l}){const{actualTimeRange:d,title:c}=(0,Fi.w)(e);return(0,Ze.tZ)(Li.Z,{adhocFilter:e,options:t,datasource:a,onFilterEdit:n,partitionColumn:i,children:(0,Ze.tZ)(wi,{index:l,label:null!=d?d:e.getDefaultLabel(),tooltipTitle:null!=c?c:e.getTooltipTitle(),clickClose:r,onShiftOptions:o,type:un.g.FilterOption,withCaret:!0,isExtra:e.isExtra,datasourceWarningMessage:e.datasourceWarning?(0,s.t)("This filter might be incompatible with current dataset"):void 0},l)},l)}var Hi=a(561314),zi=a(861641);const{warning:Xi}=at.default,Wi=[un.g.Column,un.g.Metric,un.g.MetricOption,un.g.AdhocMetricOption],Ui=e=>!(e instanceof $i.Z)&&(null==e?void 0:e.expressionType);var qi=a(62446),Vi=a(88889);const Gi={},Ki=[un.g.Column,un.g.Metric],Yi=(e,t,a)=>e?(0,fe.Z)(e).filter((e=>!(0,qi.nX)(e)||a.some((t=>t.column_name===e.column.column_name)))).map((e=>{if((0,qi.AG)(e)&&!t.some((t=>t.metric_name===e)))return{metric_name:e,error_text:(0,s.t)("This metric might be incompatible with current dataset")};if(!(e=>e&&!(e instanceof hn.Z)&&"string"!=typeof e&&e.expressionType)(e))return e;if((0,qi.nX)(e)){const t=a.find((t=>t.column_name===e.column.column_name));if(t)return new hn.Z({...e,column:t})}return new hn.Z(e)})):[],Qi=(e,t,a)=>{var n;return null!=(n=null==e?void 0:e.filter((e=>{var n;return Array.isArray(t)?!t.includes(null!=(n=e.metric_name)?n:"")||e.metric_name===a:e})))?n:[]};var Ji=a(209870),el=a(535622),tl=a(701455),al=a(300872),nl=a(558842);const ol={allowNewOptions:!0,controlType:"Select",label:(0,s.t)("D3 format"),description:nl.YD,options:nl.F6.map((e=>({value:e[0],label:e[1]}))),defaultValue:nl.F6[0][0],creatable:!0,minWidth:"14em",debounceDelay:500},rl={controlType:"Select",label:(0,s.t)("D3 format"),description:nl.oq,options:nl.HC.map((e=>({value:e[0],label:e[1]}))),defaultValue:nl.HC[0][0],creatable:!0,minWidth:"10em",debounceDelay:500},il={controlType:"Slider",label:(0,s.t)("Fraction digits"),description:(0,s.t)("Number of decimal digits to round numbers to"),min:0,step:1,max:100,defaultValue:100},ll={controlType:"InputNumber",label:(0,s.t)("Min Width"),description:(0,s.t)("Default minimal column width in pixels, actual width may still be larger than this if other columns don't need much space"),width:120,placeholder:(0,s.t)("auto"),debounceDelay:400,validators:[al.Z]},sl={controlType:"RadioButtonControl",label:(0,s.t)("Text align"),description:(0,s.t)("Horizontal alignment"),width:130,debounceDelay:50,defaultValue:"left",options:[["left",(0,Ze.tZ)(X.Z.AlignLeftOutlined,{iconSize:"m"})],["center",(0,Ze.tZ)(X.Z.AlignCenterOutlined,{iconSize:"m"})],["right",(0,Ze.tZ)(X.Z.AlignRightOutlined,{iconSize:"m"})]]},dl={controlType:"Checkbox",label:(0,s.t)("Show cell bars"),description:(0,s.t)("Whether to display a bar chart background in table columns"),defaultValue:!0,debounceDelay:200},cl={controlType:"Checkbox",label:(0,s.t)("Align +/-"),description:(0,s.t)("Whether to align positive and negative values in cell bar chart at 0"),defaultValue:!1,debounceDelay:200},ul={controlType:"Checkbox",label:(0,s.t)("Color +/-"),description:(0,s.t)("Whether to colorize numeric values by if they are positive or negative"),defaultValue:!1,debounceDelay:200},hl={controlType:"Checkbox",label:(0,s.t)("Truncate Cells"),description:(0,s.t)('Truncate long cells to the "min width" set above'),defaultValue:!1,debounceDelay:400},pl={controlType:"CurrencyControl",label:(0,s.t)("Currency format"),description:(0,s.t)("Customize chart metrics or columns with currency symbols as prefixes or suffixes. Choose a symbol from dropdown or type your own."),debounceDelay:200},fl={d3NumberFormat:ol,d3SmallNumberFormat:{...ol,label:(0,s.t)("Small number format"),description:(0,s.t)("D3 number format for numbers between -1.0 and 1.0, useful when you want to have different significant digits for small and large numbers")},d3TimeFormat:rl,fractionDigits:il,columnWidth:ll,truncateLongCells:hl,horizontalAlign:sl,showCellBars:dl,alignPositiveNegative:cl,colorPositiveNegative:ul,currencyFormat:pl},gl={[Vi.Z.String]:[["columnWidth",{name:"horizontalAlign",override:{defaultValue:"left"}}],["truncateLongCells"]],[Vi.Z.Numeric]:[{tab:(0,s.t)("Display"),children:[["columnWidth",{name:"horizontalAlign",override:{defaultValue:"right"}}],["showCellBars"],["alignPositiveNegative"],["colorPositiveNegative"]]},{tab:(0,s.t)("Number formatting"),children:[["d3NumberFormat"],["d3SmallNumberFormat"],["currencyFormat"]]}],[Vi.Z.Temporal]:[["columnWidth",{name:"horizontalAlign",override:{defaultValue:"left"}}],["d3TimeFormat"]],[Vi.Z.Boolean]:[["columnWidth",{name:"horizontalAlign",override:{defaultValue:"left"}}]]};function ml(e){return!(null==e||!e.tab)}var vl=a(668122);const bl={Slider:qo,InputNumber:yt.Rn,Input:yt.II,Select:it.Ph,Checkbox:Zt.Z,RadioButtonControl:rt.default.RadioButtonControl,CurrencyControl:Ji.Z};function yl({name:e,label:t,description:a,width:o,validators:r,onChange:i,value:l,defaultValue:s,controlType:d,...c}){const{gridUnit:u}=(0,N.Fg)(),[h,p]=(0,n.useState)(!1),[f,g]=(0,n.useState)(void 0===l?s:l),[m,v]=(0,n.useState)(),b=e=>{const t=e&&"object"==typeof e&&"target"in e?"checkbox"===e.target.type||"radio"===e.target.type?e.target.checked:e.target.value:e,a=(null==r?void 0:r.map((e=>!function(e){return null==e||""===e}(t)&&e(t))).filter((e=>!!e)))||[];v(a),g(t),0===a.length&&i&&i(t)},y=bl[d];return(0,Ze.tZ)("div",{css:(0,I.iv)({margin:2*u,width:o,maxWidth:"100%",flex:1},"",""),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:"Checkbox"===d?(0,Ze.tZ)(bl.Checkbox,{value:f,onChange:b,name:e,label:t,description:a,validationErrors:m,...c}):(0,Ze.BX)(Ze.HY,{children:[t&&(0,Ze.tZ)(xt.Z,{name:e,label:t,description:a,validationErrors:m,hovered:h}),(0,Ze.tZ)(y,{...c,value:f,onChange:b})]})})}function xl({children:e}){const{gridUnit:t}=(0,N.Fg)();return(0,Ze.tZ)("div",{css:(0,I.iv)({display:"flex",flexWrap:"nowrap",marginBottom:t,maxWidth:"100%"},"",""),children:e})}function wl({onChange:e,value:t,children:a}){const o=(0,N.Fg)(),r=(0,n.useMemo)((()=>({0:e,[vl.o]:D()(e,vl.o)})),[e]),i=n.Children.map(a,(a=>{if("children"in a.props){const o=Array.isArray(a.props.children)?100/a.props.children.length+"%":void 0;return(0,n.cloneElement)(a,{children:n.Children.map(a.props.children,(a=>{const{name:i,width:l,debounceDelay:s=vl.o,onChange:d}=a.props;return(0,n.cloneElement)(a,{width:l||o,value:null==t?void 0:t[i],debounceDelay:void 0,onChange(a){d&&d(a),s in r||(r[s]=D()(e,s)),r[s]({...t,[i]:a})}})}))})}return a}));return(0,Ze.tZ)("div",{css:(0,I.iv)({label:{textTransform:"uppercase",color:o.colors.text.label,fontSize:o.typography.sizes.s}},"",""),children:i})}function Cl({column:e,configFormLayout:t,onChange:a}){const n=(e,t)=>(0,Ze.tZ)(xl,{children:e.map((e=>{const t="string"==typeof e?e:e.name,a="string"==typeof e?{}:"override"in e?e.override:e.config,n={...t in fl?fl[t]:void 0,...a};return(0,Ze.tZ)(yl,{name:t,...n},t)}))},t),o=t[void 0===e.type?Vi.Z.String:e.type];return ml(o[0])?(0,Ze.tZ)(tt.ZP,{centered:!0,children:o.map(((t,o)=>ml(t)?(0,Ze.tZ)(tt.ZP.TabPane,{tab:t.tab,children:(0,Ze.tZ)(wl,{onChange:a,value:e.config,children:t.children.map(((e,t)=>n(e,t)))})},o):null))}):(0,Ze.tZ)(wl,{onChange:a,value:e.config,children:o.map(((e,t)=>n(e,t)))})}const Sl=(0,n.memo)((function({column:e,onChange:t,configFormLayout:a,width:n,height:o}){const{colors:r,gridUnit:i}=(0,N.Fg)(),l=6*i;return(0,Ze.tZ)(Za.J,{title:e.name,content:()=>(0,Ze.tZ)(Cl,{column:e,onChange:t,configFormLayout:a}),trigger:"click",placement:"right",overlayInnerStyle:{width:n,height:o},overlayClassName:"column-config-popover",children:(0,Ze.BX)("div",{css:(0,I.iv)({display:"flex",alignItems:"center",cursor:"pointer",padding:`${i}px ${2*i}px`,borderBottom:`1px solid ${r.grayscale.light2}`,position:"relative",paddingRight:l,"&:last-child":{borderBottom:"none"},"&:hover":{background:r.grayscale.light4},"> .fa":{color:r.grayscale.light2},"&:hover > .fa":{color:r.grayscale.light1}},"",""),children:[(0,Ze.tZ)(tl.j,{type:e.type}),e.name,(0,Ze.tZ)("i",{className:"fa fa-caret-right",css:(0,I.iv)({position:"absolute",right:3*i,top:3*i},"","")})]})})}));var kl=a(706882);const El=(e,t)=>T()(e,t),Zl=(e,t)=>T()(e,t),_l={r:"inherit",y:"1 year ago",m:"1 month ago",w:"1 week ago",c:"custom"},Ml={AnnotationLayerControl:mt,BoundsControl:Et,CheckboxControl:Zt.Z,CollectionControl:Sa,ColorPickerControl:Da,ColorSchemeControl:Ra.Z,ColumnConfigControl:function({queryResponse:e,appliedColumnNames:t=[],value:a,onChange:o,configFormLayout:r=gl,width:i,height:l,...d}){const{colnames:c,coltypes:u}=e||{};let h=[],p=[];if(0===t.length)h=c||[],p=u||[];else{const e=new Set(t);null==c||c.forEach(((t,a)=>{e.has(t)&&(h.push(t),p.push(null==u?void 0:u[a]))}))}const f=(0,N.Fg)(),g=(0,n.useMemo)((()=>{var e;const t={};return null==(e=h)||e.forEach(((e,n)=>{var o;t[e]={name:el.DS[e]||e,type:null==(o=p)?void 0:o[n],config:(null==a?void 0:a[e])||{}}})),t}),[a,h,p]),[m,v]=(0,n.useState)(!1),b=e=>g[e]||{};if(!h||0===h.length)return null;const y=h.length>12,x=y&&!m?h.slice(0,10):h;return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)(xt.Z,{...d}),(0,Ze.BX)("div",{css:(0,I.iv)({border:`1px solid ${f.colors.grayscale.light2}`,borderRadius:f.gridUnit},"",""),children:[x.map((e=>(0,Ze.tZ)(Sl,{column:b(e),onChange:t=>((e,t)=>{if(o){const n=h&&a?Object.fromEntries(Object.entries(a).filter((([e])=>h.includes(e)))):{...a};o({...n,[e]:t})}})(e,t),configFormLayout:r,width:i,height:l},e))),y&&(0,Ze.tZ)("div",{role:"button",tabIndex:-1,css:(0,I.iv)({padding:2*f.gridUnit,textAlign:"center",cursor:"pointer",textTransform:"uppercase",fontSize:f.typography.sizes.xs,color:f.colors.text.label,":hover":{backgroundColor:f.colors.grayscale.light4}},"",""),onClick:()=>v(!m),children:m?(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("i",{className:"fa fa-angle-up"}),"   ",(0,s.t)("Show less columns")]}):(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("i",{className:"fa fa-angle-down"}),"  ",(0,s.t)("Show all columns")]})})]})]})},CurrencyControl:Ji.Z,DatasourceControl:ln,DateFilterControl:sn.ZP,DndColumnSelectControl:ii,DndColumnSelect:function(e){const{value:t,options:a,multi:o=!0,onChange:r,canDelete:i=!0,ghostButtonText:l,name:d,label:c,isTemporal:u,disabledTabs:h}=e,[p,f]=(0,n.useState)(!1),g=(0,n.useMemo)((()=>{const e=Object.fromEntries(a.map((e=>[e.column_name,e])));return new Ti(e,o,t)}),[o,a,t]),m=(0,n.useCallback)((e=>{const t=e.value;g.multi||ir()(g.values)?g.add(t.column_name):g.replace(0,t.column_name),r(g.getValues())}),[r,g]),v=(0,n.useCallback)((e=>{const t=e.value.column_name;return t in g.options&&!g.has(t)}),[g]),b=(0,n.useCallback)((e=>{g.del(e),r(g.getValues())}),[r,g]),y=(0,n.useCallback)(((e,t)=>{g.swap(e,t),r(g.getValues())}),[r,g]),x=(0,n.useCallback)((()=>g.values.map(((e,t)=>{const n=(0,vi.GA)(e)&&e.datasourceWarning?(0,s.t)("This column might be incompatible with current dataset"):void 0,o=(0,vi.GA)(e)||!e.error_text;return(0,Ze.tZ)(Ai,{columns:a,onColumnEdit:e=>{(0,Mr.xN)(e)?g.replace(t,e.column_name):g.replace(t,e),r(g.getValues())},editedColumn:e,isTemporal:u,disabledTabs:h,children:(0,Ze.tZ)(wi,{index:t,clickClose:b,onShiftOptions:y,type:`${un.g.ColumnOption}_${d}_${c}`,canDelete:i,column:e,datasourceWarningMessage:n,withCaret:o},t)},t)}))),[i,u,c,d,r,b,y,g,a]),w=(0,n.useCallback)((e=>{(0,Mr.xN)(e)?g.add(e.column_name):g.add(e),r(g.getValues())}),[r,g]),C=(0,n.useCallback)((e=>{f(e)}),[]),S=(0,n.useCallback)((()=>{C(!1)}),[C]),k=(0,n.useCallback)((()=>{C(!0)}),[C]),E=(0,n.useMemo)((()=>null!=l?l:(0,s.tn)("Drop a column here or click","Drop columns here or click",o?2:1)),[l,o]);return(0,Ze.BX)("div",{children:[(0,Ze.tZ)(ii,{onDrop:m,canDrop:v,valuesRenderer:x,accept:un.g.Column,displayGhostButton:o||0===g.values.length,ghostButtonText:E,onClickGhostButton:k,...e}),(0,Ze.tZ)(Ai,{columns:a,onColumnEdit:w,isControlledComponent:!0,togglePopover:C,closePopover:S,visible:p,isTemporal:u,disabledTabs:h,children:(0,Ze.tZ)("div",{})})]})},DndFilterSelect:e=>{var t;const{datasource:a,onChange:o=(()=>{}),name:r,canDelete:i}=e,l=(0,n.useMemo)((()=>{let e={};if(null!=a&&a.extra)try{e=JSON.parse(a.extra)}catch{}return e}),[null==a?void 0:a.extra]),d=Array.from(null!=(t=e.value)?t:[]),[c,u]=(0,n.useState)(d.map((e=>Ui(e)?new $i.Z(e):e))),[h,f]=(0,n.useState)(void 0),[g,m]=(0,n.useState)(!1),[v,b]=(0,n.useState)({}),y=(e,t)=>[...e,...[...(null==t?void 0:t.metrics)||[],null==t?void 0:t.metric].map((e=>e&&("string"==typeof e?{saved_metric_name:e}:new hn.Z(e))))].filter((e=>e)).reduce(((e,t)=>("saved_metric_name"in t&&t.saved_metric_name?e.push({...t,filterOptionName:t.saved_metric_name}):"column_name"in t&&t.column_name?e.push({...t,filterOptionName:`_col_${t.column_name}`}):t instanceof hn.Z&&e.push({...t,filterOptionName:`_adhocmetric_${t.label}`}),e)),[]).sort(((e,t)=>{var a,n;return null!=(a=null==(n=e.saved_metric_name||e.column_name||e.label)?void 0:n.localeCompare(t.saved_metric_name||t.column_name||t.label||""))?a:0})),[x,w]=(0,n.useState)(y(e.columns,e.formData)),C=(0,n.useMemo)((()=>new Set(x.map((({column_name:e,filterOptionName:t})=>null!=e?e:t)))),[x]);(0,n.useEffect)((()=>{if(a&&"table"===a.type){var e;const t=null==(e=a.database)?void 0:e.id,{datasource_name:n,catalog:o,schema:r,is_sqllab_view:i}=a;!i&&t&&n&&r&&ge.Z.get({endpoint:`/api/v1/database/${t}/table_metadata/extra/${(0,p.UK)({name:n,catalog:o,schema:r})}`}).then((({json:e})=>{if(null!=e&&e.partitions){const{partitions:t}=e;null!=t&&t.cols&&1===Object.keys(t.cols).length&&f(t.cols[0])}})).catch((e=>{A.Z.error("fetch extra_table_metadata:",e.statusText)}))}}),[a]),(0,n.useEffect)((()=>{w(y(e.columns,e.formData))}),[e.columns,e.formData]),(0,n.useEffect)((()=>{u((e.value||[]).map((e=>Ui(e)?new $i.Z(e):e)))}),[e.value]);const S=(0,n.useCallback)((e=>{const t=[...c];t.splice(e,1),u(t),o(t)}),[o,c]),k=(0,n.useCallback)((e=>{const t=null==i?void 0:i(c[e],c);"string"!=typeof t?!0===t&&S(e):Xi({title:(0,s.t)("Warning"),content:t})}),[i,S,c]),E=(0,n.useCallback)(((e,t)=>{const a=[...c];[a[t],a[e]]=[a[e],a[t]],u(a)}),[c]),Z=(0,n.useCallback)((t=>{var a;return null==(a=e.savedMetrics.find((e=>e.metric_name===t)))?void 0:a.expression}),[e.savedMetrics]),_=(0,n.useCallback)((e=>{if(e instanceof $i.Z)return e;const t=e;return t.saved_metric_name?new $i.Z({expressionType:zi.p.Sql,subject:Z(t.saved_metric_name),operator:U.LT[U.d.GreaterThan].operation,operatorId:U.d.GreaterThan,comparator:0,clause:zi.N.Having}):t.label?new $i.Z({expressionType:zi.p.Sql,subject:new hn.Z(e).translateToSql(),operator:U.LT[U.d.GreaterThan].operation,operatorId:U.d.GreaterThan,comparator:0,clause:zi.N.Having}):t.column_name?new $i.Z({expressionType:zi.p.Simple,subject:t.column_name,operator:U.LT[U.d.Equals].operation,operatorId:U.d.Equals,comparator:"",clause:zi.N.Where,isNew:!0}):null}),[a.type,Z]),M=(0,n.useCallback)((e=>{o(c.map((t=>t.filterOptionName===e.filterOptionName?e:t)))}),[o,c]),T=(0,n.useCallback)((e=>{const t=_(e);if(t){const e=[...c,t];u(e),o(e)}}),[_,o,c]),O=(0,n.useCallback)((e=>{m(e)}),[]),D=(0,n.useCallback)((()=>{O(!1)}),[O]),R=(0,n.useCallback)((()=>c.map(((e,t)=>(0,Ze.tZ)(ji,{index:t,adhocFilter:e,options:x,datasource:a,onFilterEdit:M,partitionColumn:h,onClickClose:k,onShiftOptions:E})))),[k,M,E,x,h,a,c]),B=(0,n.useCallback)((()=>{b({}),O(!0)}),[O]),P=(0,Hi.Ct)(),N=(0,n.useMemo)((()=>{if(null==(t=v)?void 0:t.metric_name)return new $i.Z({expressionType:zi.p.Sql,clause:zi.N.Having,sqlExpression:null==v?void 0:v.expression});var t;if(v instanceof hn.Z)return new $i.Z({expressionType:zi.p.Sql,clause:zi.N.Having,sqlExpression:null==v?void 0:v.translateToSql()});const a={subject:null==v?void 0:v.column_name};return a.subject&&(a.operator=U.LT[U.d.In].operation,a.operatorId=U.d.In),(0,Mr.xN)(v)&&(0,Qe.x)(null==v?void 0:v.column_name,e.datasource)&&(a.operator=U.d.TemporalRange,a.operatorId=U.d.TemporalRange,a.comparator=P),new $i.Z(a)}),[v]),I=(0,n.useCallback)((e=>{if(l.disallow_adhoc_metrics&&(e.type!==un.g.Column||!C.has(e.value.column_name)))return!1;if(e.type===un.g.Column){const t=e.value.column_name;return C.has(t)}return!0}),[C,l]),L=(0,n.useCallback)((e=>{b(e.value),O(!0)}),[r,O]);return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)(ii,{onDrop:L,canDrop:I,valuesRenderer:R,accept:Wi,ghostButtonText:(0,s.t)("Drop columns/metrics here or click"),onClickGhostButton:B,...e}),(0,Ze.tZ)(Li.Z,{adhocFilter:N,options:x,datasource:a,onFilterEdit:T,partitionColumn:h,isControlledComponent:!0,visible:g,togglePopover:O,closePopover:D,requireSave:!!v})]})},DndMetricSelect:e=>{const{onChange:t,multi:a,datasource:o,savedMetrics:r}=e,i=(0,n.useMemo)((()=>{let e={};if(null!=o&&o.extra)try{e=JSON.parse(o.extra)}catch{}return e}),[null==o?void 0:o.extra]),l=(0,n.useMemo)((()=>new Set(r.map((({metric_name:e})=>e)))),[r]),d=(0,n.useCallback)((e=>{if(null===e)return void t(null);const n=(0,fe.Z)(e).map((e=>e.metric_name?e.metric_name:e)).filter((e=>e));t(a?n:n[0])}),[a,t]),[c,u]=(0,n.useState)(Yi(e.value,e.savedMetrics,e.columns)),[h,p]=(0,n.useState)({}),[f,g]=(0,n.useState)(!1);(0,n.useEffect)((()=>{u(Yi(e.value,e.savedMetrics,e.columns))}),[JSON.stringify(e.value),JSON.stringify(e.savedMetrics),JSON.stringify(e.columns)]);const m=(0,n.useCallback)((e=>!(i.disallow_adhoc_metrics&&(e.type!==un.g.Metric||!l.has(e.value.metric_name)))&&!("metric"===e.type&&c.includes(e.value.metric_name))),[c,i,l]),v=(0,n.useCallback)((t=>{const a=e.multi?[...c,t]:[t];u(a),d(a)}),[d,e.multi,c]),b=(0,n.useCallback)(((e,t)=>{if(t instanceof hn.Z&&t.equals(e))return;const a=c.map((a=>("metric_name"in t&&a===t.metric_name||void 0!==a.optionName)&&a.optionName===t.optionName?e:a));u(a),d(a)}),[d,c]),y=(0,n.useCallback)((e=>{if(!Array.isArray(c))return;const t=[...c];t.splice(e,1),u(t),d(t)}),[d,c]),x=(0,n.useCallback)(((e,t)=>{const a=[...c];[a[t],a[e]]=[a[e],a[t]],u(a)}),[c]),w=(0,n.useMemo)((()=>Qi(e.savedMetrics,e.value)),[e.savedMetrics,e.value]),C=(0,n.useCallback)((t=>{var a;return Qi(e.savedMetrics,e.value,null==(a=e.value)?void 0:a[t])}),[e.savedMetrics,e.value]),S=(0,n.useCallback)((()=>t(a?c:c[0])),[a,t,c]),k=(0,n.useCallback)(((t,n)=>(0,Ze.tZ)(In,{index:n,option:t,onMetricEdit:b,onRemoveMetric:y,columns:e.columns,savedMetrics:e.savedMetrics,savedMetricsOptions:C(n),datasource:e.datasource,onMoveLabel:x,onDropLabel:S,type:`${un.g.AdhocMetricOption}_${e.name}_${e.label}`,multi:a,datasourceWarningMessage:t instanceof hn.Z&&t.datasourceWarning?(0,s.t)("This metric might be incompatible with current dataset"):void 0},n)),[C,S,x,a,b,y,e.columns,e.datasource,e.label,e.name,e.savedMetrics]),E=(0,n.useCallback)((()=>c.map(((e,t)=>k(e,t)))),[c,k]),Z=(0,n.useCallback)((e=>{g(e)}),[]),_=(0,n.useCallback)((()=>{Z(!1)}),[Z]),M=(0,n.useCallback)((e=>{e.type===un.g.Metric&&v(e.value),e.type===un.g.Column&&(p(e),Z(!0))}),[v,Z]),T=(0,n.useCallback)((()=>{p({}),Z(!0)}),[Z]),O=(0,n.useMemo)((()=>{if((null==(e=h)?void 0:e.value)&&(null==e?void 0:e.type)&&h.type===un.g.Column){const e=h.value,t={column:e};return e.type_generic===Vi.Z.Numeric?t.aggregate=U.YY.SUM:e.type_generic!==Vi.Z.String&&e.type_generic!==Vi.Z.Boolean&&e.type_generic!==Vi.Z.Temporal||(t.aggregate=U.YY.COUNT_DISTINCT),new hn.Z(t)}var e;return new hn.Z({})}),[h]),D=(0,s.tn)("Drop a column/metric here or click","Drop columns/metrics here or click",a?2:1);return(0,Ze.BX)("div",{className:"metrics-select",children:[(0,Ze.tZ)(ii,{onDrop:M,canDrop:m,valuesRenderer:E,accept:Ki,ghostButtonText:D,displayGhostButton:a||0===c.length,onClickGhostButton:T,...e}),(0,Ze.tZ)(Dn,{adhocMetric:O,onMetricEdit:v,columns:e.columns,savedMetricsOptions:w,savedMetric:Gi,datasource:e.datasource,isControlledComponent:!0,visible:f,togglePopover:Z,closePopover:_,isNew:!0,children:(0,Ze.tZ)("div",{})})]})},FixedOrMetricControl:Kn,HiddenControl:function(e){return(0,Ze.tZ)(yt.II,{type:"hidden",value:e.value})},SelectAsyncControl:Qn,SelectControl:Jn.Z,SliderControl:function({default:e,name:t,label:a,description:n,renderTrigger:o,rightNode:r,leftNode:i,validationErrors:l,hovered:s,warning:d,danger:c,onClick:u,tooltipOnClick:h,onChange:p=(()=>{}),...f}){const g={name:t,label:a,description:n,renderTrigger:o,rightNode:r,leftNode:i,validationErrors:l,onClick:u,hovered:s,tooltipOnClick:h,warning:d,danger:c};return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)(xt.Z,{...g}),(0,Ze.tZ)(qo,{...f,onChange:p,defaultValue:e})]})},SpatialControl:Vo.Z,TextAreaControl:Go.Z,TextControl:dn.Z,TimeSeriesColumnControl:or,ViewportControl:mr,VizTypeControl:({value:e,onChange:t=Cn.EI,isModalOpenInit:a})=>{const[o,r]=(0,n.useState)(!!a),[i,l]=(0,n.useState)(0),[d,c]=(0,n.useState)(e),u=(0,n.useCallback)((()=>{r(!0)}),[]),h=(0,n.useCallback)((()=>{t(d),r(!1)}),[d,t]),p=(0,n.useCallback)((()=>{r(!1),l((e=>e+1)),c(e)}),[e]);return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.BX)("div",{css:e=>I.iv`
          min-width: ${72*e.gridUnit}px;
          max-width: fit-content;
        `,children:[(0,Ze.tZ)(Cr,{onChange:t,currentSelection:e}),e&&(0,Ze.tZ)(Er,{vizType:e})]}),(0,Ze.tZ)("div",{css:e=>I.iv`
          display: flex;
          justify-content: flex-end;
          margin-top: ${3*e.gridUnit}px;
          color: ${e.colors.grayscale.base};
          text-decoration: underline;
        `,children:(0,Ze.tZ)("span",{role:"button",tabIndex:0,onClick:u,children:(0,s.t)("View all charts")})}),(0,Ze.tZ)(Zr,{show:o,onHide:p,title:(0,s.t)("Select a visualization type"),primaryButtonName:(0,s.t)("Select"),disablePrimaryButton:!d,onHandledPrimaryAction:h,maxWidth:`${br.UB}px`,responsive:!0,children:(0,Ze.tZ)(br.ZP,{selectedViz:d,onChange:c,onDoubleClick:h,denyList:Sr},i)})]})},MetricsControl:Xn,AdhocFilterControl:_r.Z,ConditionalFormattingControl:Qr,XAxisSortControl:function(e){const[t,a]=(0,n.useState)(e.value);return(0,n.useEffect)((()=>{e.shouldReset&&(e.onChange(void 0),a(null))}),[e.shouldReset,e.value]),(0,Ze.tZ)(Jn.Z,{...e,value:t})},ContourControl:({onChange:e,...t})=>{const[a,o]=(0,n.useState)(!1),[r,i]=(0,n.useState)(null!=t&&t.value?null==t?void 0:t.value:Zi);(0,n.useEffect)((()=>{const t=r.map(((e,t)=>({...e,zIndex:10*(t+1)})));null==e||e(t)}),[e,r]);const l=e=>{o(e)},d=e=>{const t=[...r];t.splice(e,1),i(t)},c=(e,t)=>{const a=[...r];[a[e],a[t]]=[a[t],a[e]],i(a)},u=(0,s.t)("Click to add a contour");return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)(ii,{onDrop:()=>{},canDrop:()=>!0,valuesRenderer:()=>r.map(((e,t)=>(0,Ze.tZ)(Ei,{saveContour:e=>((e,t)=>{const a=[...r];a[t]=e,i(a)})(e,t),contour:e,index:t,onClose:d,onShift:c},t))),accept:[],ghostButtonText:u,onClickGhostButton:()=>{l(!0)},...t}),(0,Ze.tZ)(gi,{saveContour:e=>{i([...r,e]),l(!1)},isControlled:!0,visible:a,toggleVisibility:o,children:(0,Ze.tZ)(_i,{})})]})},ComparisonRangeLabel:({multi:e=!0})=>{const[t,a]=(0,n.useState)([]),r=(0,o.v9)((e=>e.explore.form_data.adhoc_filters.filter((e=>"TEMPORAL_RANGE"===e.operator))),El),i=(0,o.v9)((e=>{var t;return null==(t=e.explore.form_data.adhoc_custom)?void 0:t.filter((e=>"TEMPORAL_RANGE"===e.operator))}),El),l=(0,o.v9)((e=>{const t=e.explore.form_data||{};if(null==t||!t.time_compare){const e=t.time_comparison||"";if(_l.hasOwnProperty(e))return[_l[e]]}return null==t?void 0:t.time_compare}),Zl),d=(0,o.v9)((e=>e.explore.form_data.start_date_offset));return(0,n.useEffect)((()=>{const e=(0,fe.Z)(l);if(ir()(r)||ir()(e)&&!d)a([]);else if(!ir()(l)||d){let n=d;var t;d||ir()(i)||(n=null==(t=i[0])?void 0:t.comparator.split(" : ")[0],n=Ee()((0,sr.NM)(n)).format("YYYY-MM-DD"));const o=r.map((t=>{const a=(0,sr.dS)({timeRangeFilter:t,shifts:e,startDate:n,includeFutureOffsets:!1});return ir()(a)?Promise.resolve({value:""}):(0,kl.z1)(t.comparator,t.subject,(0,fe.Z)(a))}));Promise.all(o).then((e=>{a(e.map((e=>{var t;return null!=(t=e.value)?t:""})))}))}}),[r,l,d]),t.length?(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)(xt.Z,{label:(0,s.t)("Actual range for comparison")}),t.flat().map((e=>(0,Ze.tZ)(Ze.HY,{children:(0,Ze.tZ)("div",{css:e=>I.iv`
              font-size: ${e.typography.sizes.m}px;
              color: ${e.colors.grayscale.dark1};
            `,children:e},e)})))]}):null},TimeOffsetControl:function({onChange:e,...t}){const[a,r]=(0,n.useState)(""),[i,l]=(0,n.useState)(void 0),[s,d]=(0,n.useState)(void 0),[c,u]=(0,n.useState)(void 0),[h,p]=(0,n.useState)(null),f=(0,o.v9)((e=>e.explore.form_data.adhoc_filters.filter((e=>"TEMPORAL_RANGE"===e.operator))),ur),g=(0,o.v9)((e=>e.explore.form_data.start_date_offset),hr);(0,n.useEffect)((()=>{h!==g&&(p(g),e(Ee()(g).format(cr)))}),[g]);const m=(0,o.v9)((e=>{var t;return null==(t=e.explore.form_data.adhoc_custom)?void 0:t.filter((e=>"TEMPORAL_RANGE"===e.operator))}),ur),v=(0,n.useCallback)((e=>{const t=(0,lr.c)(e);if(t.matchedFlag){var a;const{sinceDatetime:e,sinceMode:n,sinceGrain:o,sinceGrainValue:r}={...t.customRange};let i=null;i="relative"!==n?"specific"===n?new Date(e):(0,sr.NM)(e,!1,!0):(0,sr.sr)(e,o,r),null==(a=i)||a.setHours(0,0,0,0),d(Ee()(i))}else d(void 0)}),[d]);return(0,n.useEffect)((()=>{if(ir()(f))d(void 0),u(Ee()((0,sr.NM)("")));else{var e,t,a;v(null!=(e=null==(t=f[0])?void 0:t.comparator)?e:"");const n=null==(a=f[0])?void 0:a.comparator.split(" : ")[0];u(Ee()((0,sr.NM)(n)))}}),[f,v]),(0,n.useEffect)((()=>{if(h||!m&&!s)h&&(r(h),l(Ee()((0,sr.NM)(h))));else{var e;let n="";var t;if(ir()(m))n=null==(t=f[0])?void 0:t.comparator.split(" : ")[0];else if("No filter"!==(null==(e=m[0])?void 0:e.comparator.split(" : ")[0])){var a;n=null==(a=m[0])?void 0:a.comparator.split(" : ")[0]}s?(r(s.toString()),l(Ee()(s))):n&&(r(n),l(Ee()((0,sr.NM)(n))))}}),[m,h,s]),(0,n.useEffect)((()=>{if(s&&i&&i>s){const t=Ee().utc(s).subtract(1,"day");r(t.toString()),l(t),e(Ee().utc(t).format(cr))}if(i&&c&&i>c){const t=Ee().utc(c).subtract(1,"day");r(t.toString()),l(t),e(Ee().utc(t).format(cr))}}),[c,i,s]),a||i?(0,Ze.BX)("div",{children:[(0,Ze.tZ)(xt.Z,{...t}),(0,Ze.tZ)(dr.Z,{css:I.iv`
          width: 100%;
        `,onChange:t=>e(t?t.format(cr):""),defaultPickerValue:a?Ee()(i).subtract(1,"day"):void 0,disabledDate:e=>s?e&&e>Ee()(s):!!c&&e&&e>c,defaultValue:Ee()(i),value:Ee()(i)})]}):null},...rt.default},Tl=Ml,Ol=N.iK.div`
  padding-bottom: ${({theme:e})=>4*e.gridUnit}px;
`;function Dl(e){const{actions:{setControlValue:t},name:a,type:o,hidden:r,isVisible:i,resetOnHide:l=!0}=e,[s,d]=(0,n.useState)(!1),c=(0,L.D)(i),u=(0,n.useCallback)(((e,n)=>t(a,e,n)),[a,t]);if((0,n.useEffect)((()=>{!0===c&&!1===i&&void 0!==e.default&&!T()(e.value,e.default)&&l&&(null==t||t(a,e.default))}),[a,c,i,t,e.value,e.default]),!o||!1===i)return null;const h="string"==typeof o?Tl[o]:o;return h?(0,Ze.tZ)(Ol,{className:"Control",style:r?{display:"none"}:void 0,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:(0,Ze.tZ)(ot.Z,{children:(0,Ze.tZ)(h,{onChange:u,hovered:s,...e})})}):(console.warn(`Unknown controlType: ${o}`),null)}const Rl=({loading:e,onQuery:t,onStop:a,errorMessage:n,isNewChart:o,canStopQuery:r,chartIsStale:i})=>e?(0,Ze.BX)(Re.Z,{onClick:a,buttonStyle:"warning",disabled:!r,children:[(0,Ze.tZ)("i",{className:"fa fa-stop"})," ",(0,s.t)("Stop")]}):(0,Ze.tZ)(Re.Z,{onClick:t,buttonStyle:i?"primary":"secondary",disabled:!!n,children:o?(0,s.t)("Create chart"):(0,s.t)("Update chart")});var Bl=a(938325);const Pl=({shouldStash:e,fieldNames:t,children:a})=>{const r=(0,o.I0)(),i=(0,Bl.Z)((e=>r((0,ie.setStashFormData)(e,t))));return(0,n.useEffect)((()=>{i(e)}),[e,i]),(0,Ze.tZ)(Ze.HY,{children:a})},{confirm:Nl}=at.default,Il=I.iv`
  &.anticon {
    font-size: unset;
    .anticon {
      line-height: unset;
      vertical-align: unset;
    }
  }
`,Al=e=>I.iv`
  display: flex;
  position: sticky;
  bottom: 0;
  flex-direction: column;
  align-items: center;
  padding: ${4*e.gridUnit}px;
  z-index: 999;
  background: linear-gradient(
    ${(0,Je.rgba)(e.colors.grayscale.light5,0)},
    ${e.colors.grayscale.light5} ${e.opacity.mediumLight}
  );

  & > button {
    min-width: 156px;
  }
`,Ll=N.iK.div`
  position: relative;
  height: 100%;
  width: 100%;

  // Resizable add overflow-y: auto as a style to this div
  // To override it, we need to use !important
  overflow: visible !important;
  #controlSections {
    height: 100%;
    overflow: visible;
  }
  .nav-tabs {
    flex: 0 0 1;
  }
  .tab-content {
    overflow: auto;
    flex: 1 1 100%;
  }
  .Select__menu {
    max-width: 100%;
  }
  .type-label {
    margin-right: ${({theme:e})=>3*e.gridUnit}px;
    width: ${({theme:e})=>7*e.gridUnit}px;
    display: inline-block;
    text-align: center;
    font-weight: ${({theme:e})=>e.typography.weights.bold};
  }
`,$l=(0,N.iK)(tt.ZP)`
  ${({theme:e,fullWidth:t})=>I.iv`
    height: 100%;
    overflow: visible;
    .ant-tabs-nav {
      margin-bottom: 0;
    }
    .ant-tabs-nav-list {
      width: ${t?"100%":"50%"};
    }
    .ant-tabs-tabpane {
      height: 100%;
    }
    .ant-tabs-content-holder {
      padding-top: ${4*e.gridUnit}px;
    }

    .ant-collapse-ghost > .ant-collapse-item {
      &:not(:last-child) {
        border-bottom: 1px solid ${e.colors.grayscale.light3};
      }

      & > .ant-collapse-header {
        font-size: ${e.typography.sizes.s}px;
      }

      & > .ant-collapse-content > .ant-collapse-content-box {
        padding-bottom: 0;
        font-size: ${e.typography.sizes.s}px;
      }
    }
  `}
`,Fl=(e,t)=>e.reduce(((e,a)=>!a.expanded&&a.label||(e=>!!e.label&&Ye.sections.legacyTimeseriesTime.label===e.label)(a)&&!(e=>{var t;return null==e||null==(t=e.columns)?void 0:t.some((e=>e.is_dttm))})(t)?e:[...e,String(a.label)]),[]);function jl(e,t){const a=(0,n.useRef)(e()),o=(0,n.useRef)(t);return o.current!==t&&(a.current=e(),o.current=t),a}const Hl=e=>{var t,a;const{colors:r}=(0,N.Fg)(),l=(0,n.useContext)(H.Zn),d=(0,L.D)(e.exploreState),c=(0,L.D)(e.exploreState.datasource),h=(0,L.D)(e.chart.chartStatus),[p,f]=(0,n.useState)(!1),g=(0,n.useRef)(null),m=(0,o.v9)((e=>e.explore.controlsTransferred)),v=(0,o.v9)((e=>{var t,a;return(null==(t=e.common)||null==(a=t.conf)?void 0:a.DEFAULT_TIME_FILTER)||Ge.vM})),{form_data:b,actions:y}=e,{setControlValue:x}=y,{x_axis:w,adhoc_filters:C}=b,S=(0,L.D)(w);(0,n.useEffect)((()=>{w&&w!==S&&(0,Qe.x)(w,e.exploreState.datasource)&&(null==C||!C.find((e=>"SIMPLE"===e.expressionType&&e.operator===U.d.TemporalRange&&e.subject===w)))&&Nl({title:(0,s.t)("The X-axis is not on the filters list"),content:(0,s.t)("The X-axis is not on the filters list which will prevent it from being used in\n            time range filters in dashboards. Would you like to add it to the filters list?"),onOk:()=>{x("adhoc_filters",[...C||[],{clause:zi.N.Where,subject:w,operator:U.d.TemporalRange,comparator:v,expressionType:"SIMPLE"}])}})}),[w,C,x,v,S,e.exploreState.datasource]),(0,n.useEffect)((()=>{let t=!1;const a=e=>"object"==typeof e&&(0,i.Z)(e)&&"datasourceWarning"in e&&!0===e.datasourceWarning?(t=!0,{...e,datasourceWarning:!1}):e;"success"===e.chart.chartStatus&&"success"!==h&&(null==m||m.forEach((n=>{var o;if(t=!1,!(0,i.Z)(e.controls[n]))return;const r=Array.isArray(e.controls[n].value)?null==(o=(0,fe.Z)(e.controls[n].value))?void 0:o.map(a):a(e.controls[n].value);t&&e.actions.setControlValue(n,r)})))}),[m,h,e.actions,e.chart.chartStatus,e.controls]),(0,n.useEffect)((()=>{var t,a,n;!c||c.type===pe.i9.Query||(null==(t=e.exploreState.datasource)?void 0:t.id)===c.id&&(null==(a=e.exploreState.datasource)?void 0:a.type)===c.type||(f(!0),null==(n=g.current)||n.scrollTo(0,0))}),[null==(t=e.exploreState.datasource)?void 0:t.id,null==(a=e.exploreState.datasource)?void 0:a.type,c]);const{expandedQuerySections:k,expandedCustomizeSections:E,querySections:Z,customizeSections:_}=(0,n.useMemo)((()=>function(e,t,a){const n=[],o=[];return(0,re.Bq)(e,a).forEach((e=>{"data"===e.tabOverride||e.controlSetRows.some((e=>e.some((e=>e&&"object"==typeof e&&"config"in e&&e.config&&(!e.config.renderTrigger||"data"===e.config.tabOverride)))))?n.push(e):e.controlSetRows.length>0&&o.push(e)})),{expandedQuerySections:Fl(n,t),expandedCustomizeSections:Fl(o,t),querySections:n,customizeSections:o}}(b.viz_type,e.exploreState.datasource,e.datasource_type)),[e.exploreState.datasource,b.viz_type,e.datasource_type]),M=(0,n.useCallback)((()=>{(0,fe.Z)(e.exploreState.controlsTransferred).forEach((t=>e.actions.setControlValue(t,e.controls[t].default)))}),[e.actions,e.exploreState.controlsTransferred,e.controls]),O=(0,n.useCallback)((()=>{M(),f(!1)}),[M]),D=(0,n.useCallback)((()=>{f(!1)}),[]),R=({name:t,config:a})=>{const{controls:n,chart:o,exploreState:r}=e;return Boolean(null==a.shouldMapStateToProps?void 0:a.shouldMapStateToProps(d||r,r,n[t],o))},B=jl((()=>({})),b.viz_type),P=t=>{const{controls:a}=e,{label:o,description:i,visibility:l}=t,d=String(o),c=!1!==(null==l?void 0:l.call(void 0,e,a)),u=t.controlSetRows.some((e=>e.some((e=>{const t="string"==typeof e?e:e&&"name"in e?e.name:null;return t&&t in a&&a[t].validationErrors&&a[t].validationErrors.length>0}))));u||(B.current[d]=!0);const h=B.current[d]?r.error.base:r.alert.base;return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)(Pl,{shouldStash:!c,fieldNames:t.controlSetRows.flat().map((e=>e&&"object"==typeof e?"name"in e?e.name:"":String(e||""))).filter(Boolean)},`sectionId-${d}`),c&&(0,Ze.tZ)(et.Z.Panel,{css:e=>I.iv`
              margin-bottom: 0;
              box-shadow: none;

              &:last-child {
                padding-bottom: ${16*e.gridUnit}px;
                border-bottom: 0;
              }

              .panel-body {
                margin-left: ${4*e.gridUnit}px;
                padding-bottom: 0;
              }

              span.label {
                display: inline-block;
              }
              ${!t.label&&"\n          .ant-collapse-header {\n            display: none;\n          }\n        "}
            `,header:(0,Ze.tZ)((()=>(0,Ze.BX)("span",{children:[(0,Ze.tZ)("span",{css:e=>I.iv`
            font-size: ${e.typography.sizes.m}px;
            line-height: 1.3;
          `,children:o})," ",i&&(0,Ze.tZ)(z.u,{id:d,title:i,children:(0,Ze.tZ)(X.Z.InfoCircleOutlined,{css:Il})}),u&&(0,Ze.tZ)(z.u,{id:`${Ve()("validation-errors")}-tooltip`,title:(0,s.t)("This section contains validation errors"),children:(0,Ze.tZ)(X.Z.InfoCircleOutlined,{css:I.iv`
                ${Il};
                color: ${h};
              `})})]})),{}),children:t.controlSetRows.map(((t,a)=>{const o=t.map((t=>t?(0,n.isValidElement)(t)?t:t.name&&t.config&&"datasource"!==t.name?(({name:t,config:a})=>{const{controls:n,chart:o,exploreState:r}=e,{visibility:i,hidden:l,disableStash:d,...c}=a,u={...c,...n[t],...R({name:t,config:a})?null==a||null==a.mapStateToProps?void 0:a.mapStateToProps(r,n[t],o):void 0,name:t},{validationErrors:h,label:p,description:f,...g}=u,m=i?i.call(a,e,u):void 0,b="function"==typeof l?l.call(a,e,u):l,y="function"==typeof p?p(r,n[t],o):p,x="function"==typeof f?f(r,n[t],o):f;return t.includes("adhoc_filters")&&(g.canDelete=(a,o)=>{var r;const i=e=>e.operator===U.d.TemporalRange;return!((null==n||null==(r=n.time_range)||!r.value)&&i(a)&&1===o.filter(i).length)||(a.comparator===v?(0,s.t)("You cannot delete the last temporal filter as it's used for time range filters in dashboards."):(e.actions.setControlValue(t,o.map((e=>T()(e,a)?{...e,comparator:v}:e))),!1))}),(0,Ze.tZ)(Pl,{shouldStash:!1===m&&!0!==d,fieldNames:[t],children:(0,Ze.tZ)(Dl,{name:t,label:y,description:x,validationErrors:h,actions:e.actions,isVisible:m,hidden:b,...g},`control-${t}`)},`control-container-${t}`)})(t):null:null)).filter((e=>null!==e));return 0===o.length?null:(0,Ze.tZ)(nt,{controls:o},`controlsetrow-${a}`)}))},d)]})},A=(0,fe.Z)(e.exploreState.controlsTransferred).length>0,$=(0,n.useCallback)((()=>A?(0,Ze.tZ)(Ae,{title:(0,s.t)("Keep control settings?"),bodyText:(0,s.t)("You've changed datasets. Any controls with data (columns, metrics) that match this new dataset have been retained."),primaryButtonAction:D,secondaryButtonAction:O,primaryButtonText:(0,s.t)("Continue"),secondaryButtonText:(0,s.t)("Clear form"),type:"info"}):(0,Ze.tZ)(Ae,{title:(0,s.t)("No form settings were maintained"),bodyText:(0,s.t)("We were unable to carry over any controls when switching to this new dataset."),primaryButtonAction:D,primaryButtonText:(0,s.t)("Continue"),type:"warning"})),[O,D,A]),F=jl((()=>!1),b.viz_type),j=(0,n.useMemo)((()=>{e.errorMessage||(F.current=!0);const t=F.current?r.error.base:r.alert.base;return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("span",{children:(0,s.t)("Data")}),e.errorMessage&&(0,Ze.BX)("span",{css:e=>I.iv`
              margin-left: ${2*e.gridUnit}px;
            `,children:[" ",(0,Ze.tZ)(z.u,{id:"query-error-tooltip",placement:"right",title:e.errorMessage,children:(0,Ze.tZ)(X.Z.ExclamationCircleOutlined,{css:I.iv`
                  ${Il};
                  color: ${t};
                `})})]})]})}),[r.error.base,r.alert.base,F,e.errorMessage]);if(!(0,Ke.Z)().has(b.viz_type)&&l.loading)return(0,Ze.tZ)(u.Z,{});const W=_.length>0;return(0,Ze.BX)(Ll,{ref:g,children:[(0,Ze.BX)($l,{id:"controlSections",fullWidth:W,allowOverflow:!1,children:[(0,Ze.tZ)(tt.ZP.TabPane,{tab:j,children:(0,Ze.BX)(et.Z,{defaultActiveKey:k,expandIconPosition:"right",ghost:!0,children:[p&&(0,Ze.tZ)($,{}),Z.map(P)]})},"query"),W&&(0,Ze.tZ)(tt.ZP.TabPane,{tab:(0,s.t)("Customize"),children:(0,Ze.tZ)(et.Z,{defaultActiveKey:E,expandIconPosition:"right",ghost:!0,children:_.map(P)})},"display")]}),(0,Ze.tZ)("div",{css:Al,children:(0,Ze.tZ)(Rl,{onQuery:e.onQuery,onStop:e.onStop,errorMessage:e.errorMessage,loading:"loading"===e.chart.chartStatus,isNewChart:!e.chart.queriesResponse,canStopQuery:e.canStopQuery,chartIsStale:e.chartIsStale})})]})};var zl=a(115926),Xl=a.n(zl),Wl=a(287183);const Ul="save_chart_recent_dashboard",ql=(0,N.iK)(at.default)`
  .ant-modal-body {
    overflow: visible;
  }
  i {
    position: absolute;
    top: -${({theme:e})=>5.25*e.gridUnit}px;
    left: ${({theme:e})=>26.75*e.gridUnit}px;
  }
`;class Vl extends n.Component{constructor(e){var t;super(e),this.handleDatasetNameChange=e=>{this.setState({datasetName:e.target.value})},this.handleRedirect=(e,t)=>{const a=new URLSearchParams(e);return a.set("save_action",this.state.action),"overwrite"!==this.state.action&&a.delete("form_data_key"),a.set("slice_id",t.id.toString()),a},this.loadDashboard=async e=>(await ge.Z.get({endpoint:`/api/v1/dashboard/${e}`})).json.result,this.loadDashboards=async(e,t,a)=>{const n=Xl().encode({columns:["id","dashboard_title"],filters:[{col:"dashboard_title",opr:"ct",value:e},{col:"owners",opr:"rel_m_m",value:this.props.user.userId}],page:t,page_size:a,order_column:"dashboard_title"}),{json:o}=await ge.Z.get({endpoint:`/api/v1/dashboard/?q=${n}`}),{result:r,count:i}=o;return{data:r.map((e=>({value:e.id,label:e.dashboard_title}))),totalCount:i}},this.renderSaveChartModal=()=>{var e;const t=this.info();return(0,Ze.BX)(yn.l0,{layout:"vertical",children:[(0,Ze.BX)(yn.xJ,{children:[(0,Ze.tZ)(Wl.Y,{id:"overwrite-radio",disabled:!this.canOverwriteSlice(),checked:"overwrite"===this.state.action,onChange:()=>this.changeAction("overwrite"),children:(0,s.t)("Save (Overwrite)")}),(0,Ze.tZ)(Wl.Y,{id:"saveas-radio",checked:"saveas"===this.state.action,onChange:()=>this.changeAction("saveas"),children:(0,s.t)("Save as...")})]}),(0,Ze.tZ)("hr",{}),(0,Ze.tZ)(yn.xJ,{label:(0,s.t)("Chart name"),required:!0,children:(0,Ze.tZ)(yt.II,{name:"new_slice_name",type:"text",placeholder:"Name",value:this.state.newSliceName,onChange:this.onSliceNameChange})}),"query"===(null==(e=this.props.datasource)?void 0:e.type)&&(0,Ze.BX)(yn.xJ,{label:(0,s.t)("Dataset Name"),required:!0,children:[(0,Ze.tZ)(st.V,{tooltip:(0,s.t)("A reusable dataset will be saved with your chart."),placement:"right"}),(0,Ze.tZ)(yt.II,{name:"dataset_name",type:"text",placeholder:"Dataset Name",value:this.state.datasetName,onChange:this.handleDatasetNameChange})]}),(0,Ze.tZ)(yn.xJ,{label:(0,s.t)("Add to dashboard"),children:(0,Ze.tZ)(it.qb,{allowClear:!0,allowNewOptions:!0,ariaLabel:(0,s.t)("Select a dashboard"),options:this.loadDashboards,onChange:this.onDashboardChange,value:this.state.dashboard,placeholder:(0,Ze.BX)("div",{children:[(0,Ze.tZ)("b",{children:(0,s.t)("Select")}),(0,s.t)(" a dashboard OR "),(0,Ze.tZ)("b",{children:(0,s.t)("create")}),(0,s.t)(" a new one")]})})}),t&&(0,Ze.tZ)(ve.Z,{type:"info",message:t,closable:!1}),this.props.alert&&(0,Ze.tZ)(ve.Z,{css:(0,I.iv)({marginTop:t?16:void 0},"",""),type:"warning",message:this.props.alert,closable:!1})]})},this.info=()=>{const e=this.isNewDashboard();let t=!1;return!this.props.slice||"overwrite"===this.state.action&&this.canOverwriteSlice()||(t=!0),t&&e?(0,s.t)("A new chart and dashboard will be created."):t?(0,s.t)("A new chart will be created."):e?(0,s.t)("A new dashboard will be created."):null},this.renderFooter=()=>{var e,t;return(0,Ze.BX)("div",{children:[(0,Ze.tZ)(Re.Z,{id:"btn_cancel",buttonSize:"small",onClick:this.onHide,children:(0,s.t)("Cancel")}),(0,Ze.tZ)(Re.Z,{id:"btn_modal_save_goto_dash",buttonSize:"small",disabled:!this.state.newSliceName||!this.state.dashboard||(null==(e=this.props.datasource)?void 0:e.type)!==pe.i9.Table&&!this.state.datasetName,onClick:()=>this.saveOrOverwrite(!0),children:(0,s.t)("Save & go to dashboard")}),(0,Ze.tZ)(Re.Z,{id:"btn_modal_save",buttonSize:"small",buttonStyle:"primary",onClick:()=>this.saveOrOverwrite(!1),disabled:this.state.isLoading||!this.state.newSliceName||(null==(t=this.props.datasource)?void 0:t.type)!==pe.i9.Table&&!this.state.datasetName,children:(0,s.t)("Save")})]})},this.state={newSliceName:e.sliceName,datasetName:null==(t=e.datasource)?void 0:t.name,action:this.canOverwriteSlice()?"overwrite":"saveas",isLoading:!1,dashboard:void 0},this.onDashboardChange=this.onDashboardChange.bind(this),this.onSliceNameChange=this.onSliceNameChange.bind(this),this.changeAction=this.changeAction.bind(this),this.saveOrOverwrite=this.saveOrOverwrite.bind(this),this.isNewDashboard=this.isNewDashboard.bind(this),this.onHide=this.onHide.bind(this)}isNewDashboard(){const{dashboard:e}=this.state;return"string"==typeof(null==e?void 0:e.value)}canOverwriteSlice(){var e,t,a;return(null==(e=this.props.slice)||null==(t=e.owners)?void 0:t.includes(this.props.user.userId))&&!(null!=(a=this.props.slice)&&a.is_managed_externally)}async componentDidMount(){let{dashboardId:e}=this.props;if(!e){let t=null;try{t=sessionStorage.getItem(Ul)}catch(e){}e=t&&parseInt(t,10)}if(e)try{const t=await this.loadDashboard(e);(0,$a.Ms)(t,this.props.user)&&this.setState({dashboard:{label:t.dashboard_title,value:t.id}})}catch(e){this.props.actions.addDangerToast((0,s.t)("An error occurred while loading dashboard information."))}}onSliceNameChange(e){this.setState({newSliceName:e.target.value})}onDashboardChange(e){this.setState({dashboard:e})}changeAction(e){this.setState({action:e})}onHide(){this.props.dispatch((0,le.setSaveChartModalVisibility)(!1))}async saveOrOverwrite(e){this.setState({isLoading:!0});try{var t;if((null==(t=this.props.datasource)?void 0:t.type)===pe.i9.Query){const{schema:e,sql:t,database:a}=this.props.datasource,{templateParams:n}=this.props.datasource;await this.props.actions.saveDataset({schema:e,sql:t,database:a,templateParams:n,datasourceName:this.state.datasetName})}let n=[];this.props.slice&&"overwrite"===this.state.action&&(n=await this.props.actions.getSliceDashboards(this.props.slice));const o=this.props.form_data||{};delete o.url_params;let r,l=null;if(this.state.dashboard){var a;let e=this.state.dashboard.value;this.isNewDashboard()&&(e=(await this.props.actions.createDashboard(this.state.dashboard.label)).id);try{l=await this.loadDashboard(e)}catch(e){return void this.props.actions.saveSliceFailed()}(0,i.Z)(l)&&(0,i.Z)(null==(a=l)?void 0:a.id)&&(n=n.includes(l.id)?n:[...n,l.id],o.dashboards=n)}this.props.actions.setFormData({...o}),r="overwrite"===this.state.action?await this.props.actions.updateSlice(this.props.slice,this.state.newSliceName,n,l?{title:l.dashboard_title,new:this.isNewDashboard()}:null):await this.props.actions.createSlice(this.state.newSliceName,n,l?{title:l.dashboard_title,new:this.isNewDashboard()}:null);try{l?sessionStorage.setItem(Ul,`${l.id}`):sessionStorage.removeItem(Ul)}catch(e){}if(e&&l)return void this.props.history.push(l.url);const s=this.handleRedirect(window.location.search,r);this.props.history.replace(`/explore/?${s.toString()}`),this.setState({isLoading:!1}),this.onHide()}finally{this.setState({isLoading:!1})}}render(){return(0,Ze.tZ)(ql,{show:this.props.isVisible,onHide:this.onHide,title:(0,s.t)("Save chart"),footer:this.renderFooter(),children:this.state.isLoading?(0,Ze.tZ)("div",{css:I.iv`
              display: flex;
              justify-content: center;
            `,children:(0,Ze.tZ)(u.Z,{position:"normal"})}):this.renderSaveChartModal()})}}const Gl=(0,r.EN)((0,o.$j)((function({explore:e,saveModal:t,user:a}){return{datasource:e.datasource,slice:e.slice,user:a,dashboards:t.dashboards,alert:t.saveModalAlert,isVisible:t.isVisible}}))(Vl));var Kl=a(701469),Yl=a.n(Kl),Ql=a(339142),Jl=a(274061),es=a(690233),ts=a(474004);const as=N.iK.div`
  ${({theme:e})=>I.iv`
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    height: ${6*e.gridUnit}px;
    padding: 0 ${e.gridUnit}px;

    // hack to make the drag preview image corners rounded
    transform: translate(0, 0);
    background-color: inherit;
    border-radius: 4px;

    > div {
      min-width: 0;
      margin-right: ${2*e.gridUnit}px;
    }
  `}
`;function ns(e){const{labelRef:t,showTooltip:a,type:n,value:o}=e,[{isDragging:r},i]=(0,mi.c)({item:{value:e.value,type:e.type},collect:e=>({isDragging:e.isDragging()})}),l={labelRef:t,showTooltip:!r&&a,showType:!0};return(0,Ze.BX)(as,{ref:i,children:[n===un.g.Column?(0,Ze.tZ)(Sn.l,{column:o,...l}):(0,Ze.tZ)(Sn.B,{metric:o,...l}),(0,Ze.tZ)(X.Z.Drag,{})]})}const os=50,rs=50,is=30,ls=N.iK.button`
  background: none;
  border: none;
  text-decoration: underline;
  color: ${({theme:e})=>e.colors.primary.dark1};
`,ss=N.iK.div`
  text-align: center;
  padding-top: 2px;
`,ds=N.iK.div`
  ${({theme:e})=>I.iv`
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: ${e.typography.sizes.s}px;
    background-color: ${e.colors.grayscale.light4};
    margin: ${2*e.gridUnit}px 0;
    border-radius: 4px;
    padding: 0 ${e.gridUnit}px;

    &:first-of-type {
      margin-top: 0;
    }
    &:last-of-type {
      margin-bottom: 0;
    }

    padding: 0;
    cursor: pointer;
    &:hover {
      background-color: ${e.colors.grayscale.light3};
    }

    & > span {
      white-space: nowrap;
    }

    .option-label {
      display: inline;
    }

    .metric-option {
      & > svg {
        min-width: ${4*e.gridUnit}px;
      }
      & > .option-label {
        overflow: hidden;
        text-overflow: ellipsis;
      }
    }
  `}
`,cs=N.iK.button`
  display: flex;
  justify-content: space-between;
  align-items: center;
  border: none;
  background: transparent;
  width: 100%;
  padding-inline: 0px;
`,us=N.iK.span`
  ${({theme:e})=>`\n    font-size: ${e.typography.sizes.m}px;\n    line-height: 1.3;\n  `}
`,hs=N.iK.div`
  ${({theme:e})=>`\n    border: 1px ${e.colors.grayscale.light4} solid;\n    border-radius: ${e.gridUnit}px;\n    font-size: ${e.typography.sizes.s}px;\n    padding: ${e.gridUnit}px;\n    color: ${e.colors.grayscale.light1};\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n  `}
`,ps=({index:e,style:t,data:a})=>{const{metricSlice:n,columnSlice:o,totalMetrics:r,totalColumns:i,width:l,showAllMetrics:d,onShowAllMetricsChange:c,showAllColumns:u,onShowAllColumnsChange:h,collapseMetrics:p,onCollapseMetricsChange:f,collapseColumns:g,onCollapseColumnsChange:m,hiddenMetricCount:v,hiddenColumnCount:b}=a,y=p?[]:n,x=p?1:2,w=p?e>=1:e>y.length+x,C=w?y.length+x+1:0,S=C+1,k=(w?o.length:y.length)+(p?C:S)+1,E=w?g:p,Z=w?m:f,_=w?u:d,M=w?h:c,T=(0,N.Fg)(),O=w?b:v;return(0,Ze.BX)("div",{style:t,css:I.iv`
        padding: 0 ${4*T.gridUnit}px;
      `,children:[e===C&&(0,Ze.BX)(cs,{onClick:()=>Z(!E),children:[(0,Ze.tZ)(us,{children:w?(0,s.t)("Columns"):(0,s.t)("Metrics")}),E?(0,Ze.tZ)(X.Z.DownOutlined,{iconSize:"s"}):(0,Ze.tZ)(X.Z.UpOutlined,{iconSize:"s"})]}),e===S&&!E&&(0,Ze.BX)("div",{css:I.iv`
            display: flex;
            gap: ${2*T.gridUnit}px;
            justify-content: space-between;
            align-items: baseline;
          `,children:[(0,Ze.tZ)("div",{className:"field-length",css:I.iv`
              flex-shrink: 0;
            `,children:w?(0,s.t)("Showing %s of %s",null==o?void 0:o.length,i):(0,s.t)("Showing %s of %s",null==y?void 0:y.length,r)}),O>0&&(0,Ze.tZ)(hs,{children:(0,s.t)("%s ineligible item(s) are hidden",O)})]}),e>S&&e<k&&(0,Ze.tZ)(ds,{className:"column",children:(0,Ze.tZ)(ns,{value:w?o[e-S-1]:y[e-S-1],type:w?un.g.Column:un.g.Metric})},(w?o[e-S-1].column_name:y[e-S-1].metric_name)+String(l)),e===k&&!E&&(w?i>os:r>rs)&&(0,Ze.tZ)(ss,{children:(0,Ze.tZ)(ls,{onClick:()=>M(!_),children:_?(0,s.t)("Show less..."):(0,s.t)("Show all...")})})]})},fs=N.iK.div`
  ${({theme:e})=>I.iv`
    background-color: ${e.colors.grayscale.light5};
    position: relative;
    height: 100%;
    display: flex;
    flex-direction: column;
    max-height: 100%;
    .ant-collapse {
      height: auto;
    }
    .field-selections {
      padding: 0 0 ${e.gridUnit}px;
      overflow: auto;
      height: 100%;
    }
    .field-length {
      margin-bottom: ${2*e.gridUnit}px;
      font-size: ${e.typography.sizes.s}px;
      color: ${e.colors.grayscale.light1};
    }
    .form-control.input-md {
      width: calc(100% - ${8*e.gridUnit}px);
      height: ${8*e.gridUnit}px;
      margin: ${2*e.gridUnit}px auto;
    }
    .type-label {
      font-size: ${e.typography.sizes.s}px;
      color: ${e.colors.grayscale.base};
    }
    .Control {
      padding-bottom: 0;
    }
  `};
`,gs=N.iK.div`
  ${({theme:e})=>I.iv`
    margin: 0 ${2.5*e.gridUnit}px;

    span {
      text-decoration: underline;
    }
  `}
`,ms=2,vs=e=>e.sort(((e,t)=>{var a,n;return(null!=(a=null==t?void 0:t.is_certified)?a:0)-(null!=(n=null==e?void 0:e.is_certified)?n:0)}));function bs({datasource:e,formData:t,controls:{datasource:a},actions:o,width:r}){const[i]=(0,n.useContext)(ai),{columns:l,metrics:d}=e,c=(0,n.useMemo)((()=>{const e=Object.values(i);return Yl()(l)?l.filter((t=>e.some((e=>e({value:t,type:un.g.Column}))))):[]}),[i,l]),u=(0,n.useMemo)((()=>[...c].sort(((e,t)=>null==e||!e.is_dttm||null!=t&&t.is_dttm?null==t||!t.is_dttm||null!=e&&e.is_dttm?0:1:-1))),[c]),h=(0,n.useMemo)((()=>{const e=Object.values(i);return d.filter((t=>e.some((e=>e({value:t,type:un.g.Metric})))))}),[i,d]),p=l.length-c.length,g=d.length-h.length,[m,v]=(0,n.useState)(!1),[b,y]=(0,n.useState)(""),[x,w]=(0,n.useState)(!1),[C,S]=(0,n.useState)(!1),[k,E]=(0,n.useState)(!1),[Z,_]=(0,n.useState)(!1),M=(0,ts.n)(b,f.oP),T=(0,n.useMemo)((()=>M?(0,es.Lu)(u,M,{keys:[{key:"verbose_name",threshold:es.tL.CONTAINS},{key:"column_name",threshold:es.tL.CONTAINS},{key:e=>{var t,a;return[null!=(t=null==e?void 0:e.description)?t:"",null!=(a=null==e?void 0:e.expression)?a:""].map((e=>(null==e?void 0:e.replace(/[_\n\s]+/g," "))||""))},threshold:es.tL.CONTAINS,maxRanking:es.tL.CONTAINS}],keepDiacritics:!0}):null!=u?u:[]),[u,M]),O=(0,n.useMemo)((()=>M?(0,es.Lu)(h,M,{keys:[{key:"verbose_name",threshold:es.tL.CONTAINS},{key:"metric_name",threshold:es.tL.CONTAINS},{key:e=>{var t,a;return[null!=(t=null==e?void 0:e.description)?t:"",null!=(a=null==e?void 0:e.expression)?a:""].map((e=>(null==e?void 0:e.replace(/[_\n\s]+/g," "))||""))},threshold:es.tL.CONTAINS,maxRanking:es.tL.CONTAINS}],keepDiacritics:!0,baseSort:(e,t)=>{var a,n,o,r,i,l;return Number(null!=(a=null==t||null==(n=t.item)?void 0:n.is_certified)?a:0)-Number(null!=(o=null==e||null==(r=e.item)?void 0:r.is_certified)?o:0)||String(null!=(i=null==e?void 0:e.rankedValue)?i:"").localeCompare(null!=(l=null==t?void 0:t.rankedValue)?l:"")}}):null!=h?h:[]),[h,M]),D=(0,n.useMemo)((()=>x?O:null==O||null==O.slice?void 0:O.slice(0,rs)),[O,x]),R=(0,n.useMemo)((()=>vs(C?T:null==T||null==T.slice?void 0:T.slice(0,os))),[T,C]),B=()=>{try{if("false"===sessionStorage.getItem("showInfobox"))return!1}catch(e){}return!0},P={query:pe.i9.Query,saved_query:pe.i9.SavedQuery},N=e.type&&P[e.type],I=(0,n.useMemo)((()=>(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)(yt.II,{allowClear:!0,onChange:e=>{y(e.target.value)},value:b,className:"form-control input-md",placeholder:(0,s.t)("Search Metrics & Columns")}),(0,Ze.BX)("div",{className:"field-selections",children:[N&&B()&&(0,Ze.tZ)(gs,{children:(0,Ze.tZ)(ve.Z,{closable:!0,onClose:()=>{try{sessionStorage.setItem("showInfobox","false")}catch(e){}},type:"info",message:"",description:(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)("span",{role:"button",tabIndex:0,onClick:()=>v(!0),className:"add-dataset-alert-description",children:(0,s.t)("Create a dataset")}),(0,s.t)(" to edit or add columns and metrics.")]})})}),(0,Ze.tZ)(Ql.ZP,{children:({height:e})=>(0,Ze.tZ)(Jl.t7,{width:r-ms,height:e,itemSize:is,itemCount:(k?0:null==D?void 0:D.length)+(Z?0:R.length)+2+(k?0:2)+(Z?0:2),itemData:{metricSlice:D,columnSlice:R,width:r,totalMetrics:O.length,totalColumns:T.length,showAllMetrics:x,onShowAllMetricsChange:w,showAllColumns:C,onShowAllColumnsChange:S,collapseMetrics:k,onCollapseMetricsChange:E,collapseColumns:Z,onCollapseColumnsChange:_,hiddenMetricCount:g,hiddenColumnCount:p},overscanCount:5,children:ps})})]})]})),[R,b,T.length,O.length,D,C,x,k,Z,N,r]);return(0,Ze.BX)(fs,{children:[N&&m&&(0,Ze.tZ)(be.W,{visible:m,onHide:()=>v(!1),buttonTextOnSave:(0,s.t)("Save"),buttonTextOnOverwrite:(0,s.t)("Overwrite"),datasource:(0,ye.z)(e),openWindow:!1,formData:t}),(0,Ze.tZ)(Dl,{...a,name:"datasource",actions:o}),null!=e.id&&I]})}var ys=a(130845),xs=a(692252);const ws=(0,ys.Z)(((e,t)=>{const a={};return((null==t?void 0:t.controlPanelSections)||[]).filter(Mr.D_).forEach((e=>{e.controlSetRows.forEach((e=>{e.forEach((e=>{e&&("string"==typeof e?a[e]=xs.ai[e]:e.name&&e.config&&(a[e.name]=e.config))}))}))})),a}));var Cs=a(676962);const Ss=N.iK.span`
  ${({theme:e})=>`\n    font-size: ${e.typography.sizes.s}px;\n    color: ${e.colors.grayscale.dark1};\n    background-color: ${e.colors.alert.base};\n\n    &:hover {\n      background-color: ${e.colors.alert.dark1};\n    }\n  `}
`,ks=e=>null==e||""===e||Array.isArray(e)&&0===e.length||"object"==typeof e&&0===Object.keys(e).length?null:e,Es=(e,t,a)=>{var n,o,r,i;if(void 0===e)return"N/A";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("AdhocFilterControl"===(null==(n=a[t])?void 0:n.type)&&Array.isArray(e))return e.length?e.map((e=>{const t=e.comparator&&e.comparator.constructor===Array?`[${e.comparator.join(", ")}]`:e.comparator;return`${e.subject} ${e.operator} ${t}`})).join(", "):"[]";if("BoundsControl"===(null==(o=a[t])?void 0:o.type))return`Min: ${e[0]}, Max: ${e[1]}`;if("CollectionControl"===(null==(r=a[t])?void 0:r.type)&&Array.isArray(e))return e.map((e=>(0,Va.o)(e))).join(", ");if("MetricsControl"===(null==(i=a[t])?void 0:i.type)&&e.constructor===Array){const t=e.map((e=>{var t;return null!=(t=null==e?void 0:e.label)?t:e}));return t.length?t.join(", "):"[]"}if(Array.isArray(e)){const t=e.map((e=>{var t;return null!=(t=null==e?void 0:e.label)?t:e}));return t.length?t.join(", "):"[]"}return"string"==typeof e||"number"==typeof e?e:(0,Va.o)(e)},Zs=e=>{var t;const[a,o]=(0,n.useState)([]),[r,i]=(0,n.useState)(!1),l=(0,n.useCallback)((()=>{const t=(0,ae.BR)(e.origFormData),a=(0,ae.BR)(e.currentFormData),n=Object.keys(a),o={};return n.forEach((e=>{var n,r;(t[e]||a[e])&&(["filters","having","where"].includes(e)||(n=t[e],r=a[e],T()(ks(n),ks(r))||(o[e]={before:t[e],after:a[e]})))})),o}),[e.currentFormData,e.origFormData]);(0,n.useEffect)((()=>{var t;const a=l(),n=(e=>{const t=(0,Ke.Z)().get(e);return ws(e,t)})(null==(t=e.origFormData)?void 0:t.viz_type);o(((e,t)=>Object.entries(e).map((([e,a])=>{var n;return{control:(null==(n=t[e])?void 0:n.label)||e,before:Es(a.before,e,t),after:Es(a.after,e,t)}})))(a,n)),i(!ir()(a))}),[l,null==(t=e.origFormData)?void 0:t.viz_type]);const d=(0,n.useMemo)((()=>{const e=[{accessor:"control",Header:(0,s.t)("Control")},{accessor:"before",Header:(0,s.t)("Before")},{accessor:"after",Header:(0,s.t)("After")}];return(0,Ze.tZ)(Cs.Z,{columns:e,data:a,pageSize:50,className:"table-condensed",columnsForWrapText:["Control","Before","After"]})}),[a]),c=(0,n.useMemo)((()=>(0,Ze.tZ)(z.u,{id:"difference-tooltip",title:(0,s.t)("Click to see difference"),children:(0,Ze.tZ)(Ss,{className:"label",children:(0,s.t)("Altered")})})),[]);return r?(0,Ze.tZ)(Fa.Z,{triggerNode:c,modalTitle:(0,s.t)("Chart changes"),modalBody:d,responsive:!0}):null};var _s=a(983673),Ms=a(852564),Ts=a(767697),Os=a(999547),Ds=a(596022);const Rs={actions:B().object.isRequired,canOverwrite:B().bool.isRequired,canDownload:B().bool.isRequired,dashboardId:B().number,colorScheme:B().string,isStarred:B().bool.isRequired,slice:B().object,sliceName:B().string,table_name:B().string,formData:B().object,ownState:B().object,timeout:B().number,chart:ee.$6,saveDisabled:B().bool},Bs=e=>I.iv`
  color: ${e.colors.primary.dark2};
  & > span[role='img'] {
    margin-right: 0;
  }
`,Ps=e=>I.iv`
  display: flex;
  align-items: center;
  margin-left: ${e.gridUnit}px;
  & > span {
    margin-right: ${3*e.gridUnit}px;
  }
`,Ns=({dashboardId:e,colorScheme:t,slice:a,actions:i,formData:l,ownState:d,chart:c,user:u,canOverwrite:h,canDownload:p,isStarred:f,sliceName:g,saveDisabled:m,metadata:v})=>{const b=(0,o.I0)(),{latestQueryFormData:y,sliceFormData:x}=c,[w,C]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(async()=>{const{dashboards:a}=v||{},n=e&&a&&a.find((t=>t.id===e));if(n&&t||(0,Os.$w)(null==v?void 0:v.color_namespace),n)try{var o;const e=await ge.Z.get({endpoint:`/api/v1/dashboard/${n.id}`}),t=null==e||null==(o=e.json)?void 0:o.result,a=JSON.parse(t.json_metadata);(0,Os.$C)(a)}catch(e){A.Z.info((0,s.t)("Unable to retrieve dashboard colors"))}})()}),[]);const S=(0,n.useCallback)((()=>{b((0,le.setSaveChartModalVisibility)(!0))}),[b]),k=(0,n.useCallback)((e=>{b((0,ie.sliceUpdated)(e))}),[b]),E=(0,r.k6)(),{redirectSQLLab:Z}=i,_=(0,n.useCallback)(((e,t=!1)=>{Z(e,!t&&E)}),[Z,E]),[M,T,O]=(0,Ds.gT)(y,p,a,_,(()=>{C(!0)}),d,null==v?void 0:v.dashboards),D=(0,n.useMemo)((()=>{if(!v)return null;const e=[];return e.push({type:Ts.pG.Dashboards,title:v.dashboards.length>0?(0,s.tn)("Added to 1 dashboard","Added to %s dashboards",v.dashboards.length,v.dashboards.length):(0,s.t)("Not added to any dashboard"),description:v.dashboards.length>0?(0,s.t)("You can preview the list of dashboards in the chart settings dropdown."):void 0}),e.push({type:Ts.pG.LastModified,value:v.changed_on_humanized,modifiedBy:v.changed_by||(0,s.t)("Not available")}),e.push({type:Ts.pG.Owner,createdBy:v.created_by||(0,s.t)("Not available"),owners:v.owners.length>0?v.owners:(0,s.t)("None"),createdOn:v.created_on_humanized}),null!=a&&a.description&&e.push({type:Ts.pG.Description,value:null==a?void 0:a.description}),(0,Ze.tZ)(Ts.ZP,{items:e,tooltipPlacement:"bottom"})}),[v,null==a?void 0:a.description]),R=null==a?void 0:a.slice_name;return(0,Ze.BX)(Ze.HY,{children:[(0,Ze.tZ)(Ms.u,{editableTitleProps:{title:g,canEdit:!a||h||((null==a?void 0:a.owners)||[]).includes(null==u?void 0:u.userId),onSave:i.updateChartTitle,placeholder:(0,s.t)("Add the name of the chart"),label:(0,s.t)("Chart title")},showTitlePanelItems:!!a,certificatiedBadgeProps:{certifiedBy:null==a?void 0:a.certified_by,details:null==a?void 0:a.certification_details},showFaveStar:!(null==u||!u.userId),faveStarProps:{itemId:null==a?void 0:a.slice_id,fetchFaveStar:i.fetchFaveStar,saveFaveStar:i.saveFaveStar,isStarred:f,showTooltip:!0},titlePanelAdditionalItems:(0,Ze.BX)("div",{css:Ps,children:[x?(0,Ze.tZ)(Zs,{className:"altered",origFormData:{...x,chartTitle:R},currentFormData:{...l,chartTitle:g}}):null,D]}),rightPanelAdditionalItems:(0,Ze.tZ)(z.u,{title:m?(0,s.t)("Add required control values to save chart"):null,children:(0,Ze.tZ)("div",{children:(0,Ze.BX)(Re.Z,{buttonStyle:"secondary",onClick:S,disabled:m,css:Bs,children:[(0,Ze.tZ)(X.Z.SaveOutlined,{iconSize:"l"}),(0,s.t)("Save")]})})}),additionalActionsMenu:M,menuDropdownProps:{visible:T,onVisibleChange:O}}),w&&(0,Ze.tZ)(_s.Z,{show:w,onHide:()=>{C(!1)},onSave:k,slice:a})]})};Ns.propTypes=Rs;const Is=Ns,As={...Ue.propTypes,actions:B().object.isRequired,datasource_type:B().string.isRequired,dashboardId:B().number,colorScheme:B().string,ownColorScheme:B().string,dashboardColorScheme:B().string,isDatasourceMetaLoading:B().bool.isRequired,chart:ee.$6.isRequired,slice:B().object,sliceName:B().string,controls:B().object.isRequired,forcedHeight:B().string,form_data:B().object.isRequired,standalone:B().bool.isRequired,force:B().bool,timeout:B().number,impressionId:B().string,vizType:B().string,saveAction:B().string,isSaveModalVisible:B().bool},Ls=N.iK.div`
  ${({theme:e})=>I.iv`
    background: ${e.colors.grayscale.light5};
    text-align: left;
    position: relative;
    width: 100%;
    max-height: 100%;
    min-height: 0;
    display: flex;
    flex: 1;
    flex-wrap: nowrap;
    border-top: 1px solid ${e.colors.grayscale.light2};
    .explore-column {
      display: flex;
      flex-direction: column;
      padding: ${2*e.gridUnit}px 0;
      max-height: 100%;
    }
    .data-source-selection {
      background-color: ${e.colors.grayscale.light5};
      padding: ${2*e.gridUnit}px 0;
      border-right: 1px solid ${e.colors.grayscale.light2};
    }
    .main-explore-content {
      flex: 1;
      min-width: ${128*e.gridUnit}px;
      border-left: 1px solid ${e.colors.grayscale.light2};
      padding: 0 ${4*e.gridUnit}px;
      .panel {
        margin-bottom: 0;
      }
    }
    .controls-column {
      align-self: flex-start;
      padding: 0;
    }
    .title-container {
      position: relative;
      display: flex;
      flex-direction: row;
      padding: 0 ${2*e.gridUnit}px 0 ${4*e.gridUnit}px;
      justify-content: space-between;
      .horizontal-text {
        font-size: ${e.typography.sizes.m}px;
      }
    }
    .no-show {
      display: none;
    }
    .vertical-text {
      writing-mode: vertical-rl;
      text-orientation: mixed;
    }
    .sidebar {
      height: 100%;
      background-color: ${e.colors.grayscale.light4};
      padding: ${2*e.gridUnit}px;
      width: ${8*e.gridUnit}px;
    }
    .collapse-icon > svg {
      color: ${e.colors.primary.base};
    }
  `};
`,$s=D()((async(e,t,a,n,o,r,i,l)=>{const s={...e},d=e.slice_id,c=new URLSearchParams(window.location.search),u=Object.fromEntries(c);d?u[f.KD.sliceId.name]=d:(u[f.KD.datasourceId.name]=t,u[f.KD.datasourceType.name]=a);const h=(null==s?void 0:s.url_params)||{};Object.entries(h).forEach((([e,t])=>{f.$O.includes(e)||(u[e]=t)}));try{let c,h;if(n?(c=await(0,ae.nv)(t,a,e,d,l),h="replaceState"):(c=(0,p.eY)(f.KD.formDataKey),await(0,ae.LW)(t,a,c,e,d,l),h="pushState"),window.location.pathname.startsWith("/explore")){const e=(0,oe.y8)(o?f.KD.standalone.name:null,{[f.KD.formDataKey.name]:c,...u},r);window.history[h](s,i,e)}}catch(e){A.Z.warn("Failed at altering browser history",e)}}),1e3),Fs={controls_width:320,datasource_width:300};function js(e){return(0,W.rV)(e,Fs[e])}function Hs(e,t){const a=Number(js(e))+t.width;(0,W.LS)(e,a)}function zs(e){const t=(0,H.gp)().dynamicPlugins[e.vizType],a=t&&t.mounting,o=(0,L.D)(a),r=(0,L.D)(e.controls),[i,l]=(0,n.useState)(e.controls),[d,c]=(0,n.useState)(!1),[u,h]=(0,n.useState)(js(W.dR.DatasourceWidth)),p=(0,se.z)(),f=(0,N.Fg)(),g=(0,n.useCallback)((async({isReplace:t=!1,title:a}={})=>{const n=e.dashboardId?{...e.form_data,dashboardId:e.dashboardId}:e.form_data,{id:o,type:r}=e.datasource;$s(n,o,r,t,e.standalone,e.force,a,p)}),[e.dashboardId,e.form_data,e.datasource.id,e.datasource.type,e.standalone,e.force,p]),m=(0,n.useCallback)((()=>{const t=window.history.state;t&&Object.keys(t).length&&(e.actions.setExploreControls(t),e.actions.postChartFormData(t,e.force,e.timeout,e.chart.id))}),[e.actions,e.chart.id,e.timeout]),v=(0,n.useCallback)((()=>{e.actions.setForceQuery(!1),e.actions.triggerQuery(!0,e.chart.id),g(),l(e.controls)}),[e.controls,g,e.actions,e.chart.id]),b=(0,n.useCallback)((t=>{if(t.ctrlKey||t.metaKey){const a="Enter"===t.key||13===t.keyCode,n="s"===t.key||83===t.keyCode;a?v():n&&e.slice&&e.actions.saveSlice(e.form_data,{action:"overwrite",slice_id:e.slice.slice_id,slice_name:e.slice.slice_name,add_to_dash:"noSave",goto_dash:!1}).then((({data:e})=>{window.location=e.slice.slice_url}))}}),[v,e.actions,e.form_data,e.slice]);function y(){c(!d)}(0,$.J)((()=>{e.actions.logEvent(G.$b)})),(0,F.S)(p,((e,t)=>{t&&g({isReplace:!0})}));const x=(0,L.D)(m);(0,n.useEffect)((()=>(x&&window.removeEventListener("popstate",x),window.addEventListener("popstate",m),()=>{window.removeEventListener("popstate",m)})),[m,x]);const w=(0,L.D)(b);(0,n.useEffect)((()=>(w&&window.removeEventListener("keydown",w),document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)})),[b,w]),(0,n.useEffect)((()=>{o&&!a&&e.actions.dynamicPluginControlsReady()}),[a]),(0,n.useEffect)((()=>{Object.values(e.controls).some((e=>e.validationErrors&&e.validationErrors.length>0))||e.actions.triggerQuery(!0,e.chart.id)}),[]);const C=(0,n.useCallback)((t=>{const a=t?{...e.chart.latestQueryFormData,...(0,re.Hu)(S()(e.controls,t))}:(0,re.Hu)(e.controls);e.actions.updateQueryFormData(a,e.chart.id),e.actions.renderTriggered((new Date).getTime(),e.chart.id),g()}),[g,e.actions,e.chart.id,e.chart.latestQueryFormData,e.controls]);(0,n.useEffect)((()=>{if(r&&e.chart.latestQueryFormData.viz_type===e.controls.viz_type.value){!e.controls.datasource||null!=r.datasource&&e.controls.datasource.value===r.datasource.value||(0,J.QR)(e.form_data.datasource,!0);const t=Object.keys(e.controls).filter((t=>void 0!==r[t]&&!(0,q.JB)(e.controls[t].value,r[t].value))).filter((t=>e.controls[t].renderTrigger));t.length>0&&C(t)}}),[e.controls,e.ownState]);const k=(0,n.useMemo)((()=>{if(i){const{controls:t}=e;return Object.keys(t).filter((e=>{const a=i[e];if(void 0===a)return!1;const{value:n}=t[e],{value:o}=a;return _()(n)&&_()(o)?!(0,q.JB)(n,o,{ignoreFields:["datasourceWarning"]}):!T()(n,o)})).some((t=>!e.controls[t].renderTrigger&&!e.controls[t].dontRefreshOnChange))}return!1}),[i,e.controls]);(0,F.S)(e.saveAction,(()=>{["saveas","overwrite"].includes(e.saveAction)&&(v(),g({isReplace:!0}),e.actions.setSaveAction(null))})),(0,n.useEffect)((()=>{void 0!==e.ownState&&(v(),C())}),[e.ownState]),k&&e.actions.logEvent(G.Ep);const E=(0,n.useMemo)((()=>{const t=Object.values(e.controls).filter((e=>e.validationErrors&&e.validationErrors.length>0));if(0===t.length)return null;const a=t.map((e=>e.validationErrors)),n=[...new Set(a.flat())].map((e=>[t.filter((t=>{var a;return null==(a=t.validationErrors)?void 0:a.includes(e)})).map((e=>e.label)),e])).map((([e,t])=>(0,Ze.BX)("div",{children:[e.length>1?(0,s.t)("Controls labeled "):(0,s.t)("Control labeled "),(0,Ze.tZ)("strong",{children:` ${e.join(", ")}`}),(0,Ze.BX)("span",{children:[": ",t]})]},t)));let o;return n.length>0&&(o=(0,Ze.tZ)("div",{style:{textAlign:"left"},children:n})),o}),[e.controls]);function Z(){return(0,Ze.tZ)(Ue,{...e,errorMessage:E,chartIsStale:k,onQuery:v})}return e.standalone?Z():(0,Ze.BX)(ri,{children:[(0,Ze.tZ)(Is,{actions:e.actions,canOverwrite:e.can_overwrite,canDownload:e.can_download,dashboardId:e.dashboardId,colorScheme:e.dashboardColorScheme,isStarred:e.isStarred,slice:e.slice,sliceName:e.sliceName,table_name:e.table_name,formData:e.form_data,chart:e.chart,ownState:e.ownState,user:e.user,reports:e.reports,saveDisabled:E||"loading"===e.chart.chartStatus,metadata:e.metadata}),(0,Ze.BX)(Ls,{id:"explore-container",children:[(0,Ze.tZ)(I.xB,{styles:I.iv`
            .navbar {
              margin-bottom: 0;
            }
            body {
              height: 100vh;
              max-height: 100vh;
              overflow: hidden;
            }
            #app-menu,
            #app {
              flex: 1 1 auto;
            }
            #app {
              flex-basis: 100%;
              overflow: hidden;
              height: 100%;
            }
            #app-menu {
              flex-shrink: 0;
            }
          `}),(0,Ze.BX)(j.e,{onResizeStop:(e,t,a,n)=>{h(a.getBoundingClientRect().width),Hs(W.dR.DatasourceWidth,n)},defaultSize:{width:js(W.dR.DatasourceWidth),height:"100%"},minWidth:Fs[W.dR.DatasourceWidth],maxWidth:"33%",enable:{right:!0},className:d?"no-show":"explore-column data-source-selection",children:[(0,Ze.BX)("div",{className:"title-container",children:[(0,Ze.tZ)("span",{className:"horizontal-text",children:(0,s.t)("Chart Source")}),(0,Ze.tZ)("span",{role:"button",tabIndex:0,className:"action-button",onClick:y,children:(0,Ze.tZ)(X.Z.Expand,{className:"collapse-icon",iconColor:f.colors.primary.base,iconSize:"l"})})]}),(0,Ze.tZ)(bs,{formData:e.form_data,datasource:e.datasource,controls:e.controls,actions:e.actions,width:u,user:e.user})]}),d?(0,Ze.tZ)("div",{className:"sidebar",onClick:y,role:"button",tabIndex:0,children:(0,Ze.tZ)("span",{role:"button",tabIndex:0,className:"action-button",children:(0,Ze.tZ)(z.u,{title:(0,s.t)("Open Datasource tab"),children:(0,Ze.tZ)(X.Z.Collapse,{className:"collapse-icon",iconColor:f.colors.primary.base,iconSize:"l"})})})}):null,(0,Ze.tZ)(j.e,{onResizeStop:(e,t,a,n)=>Hs(W.dR.ControlsWidth,n),defaultSize:{width:js(W.dR.ControlsWidth),height:"100%"},minWidth:Fs[W.dR.ControlsWidth],maxWidth:"33%",enable:{right:!0},className:"col-sm-3 explore-column controls-column",children:(0,Ze.tZ)(Hl,{exploreState:e.exploreState,actions:e.actions,form_data:e.form_data,controls:e.controls,chart:e.chart,datasource_type:e.datasource_type,isDatasourceMetaLoading:e.isDatasourceMetaLoading,onQuery:v,onStop:function(){e.chart&&e.chart.queryController&&e.chart.queryController.abort()},canStopQuery:e.can_add||e.can_overwrite,errorMessage:E,chartIsStale:k})}),(0,Ze.tZ)("div",{className:Y()("main-explore-content",d?"col-sm-9":"col-sm-7"),children:Z()})]}),e.isSaveModalVisible&&(0,Ze.tZ)(Gl,{addDangerToast:e.addDangerToast,actions:e.actions,form_data:e.form_data,sliceName:e.sliceName,dashboardId:e.dashboardId})]})}zs.propTypes=As;const Xs=(0,o.$j)((function(e){var t,a,n,o,r,i,l,s,d,c,u,h;const{explore:p,charts:f,common:g,impressionId:m,dataMask:v,reports:b,user:y,saveModal:x}=e,{controls:w,slice:C,datasource:S,metadata:k,hiddenFormData:Z}=p,_=null!=(t=w.query_mode)&&t.value?(e=>Object.keys(null!=e?e:{}).filter((e=>!U.Yl.has(e))))(Z):Object.keys(null!=Z?Z:{}),M=E()((0,re.Hu)(w),_),T=null!=(a=null!=(n=M.slice_id)?n:null==C?void 0:C.slice_id)?a:0;M.extra_form_data=(0,te.on)({...M.extra_form_data},{...null==(o=v[T])?void 0:o.ownState});const O=f[T],D=null==(r=p.form_data)?void 0:r.color_scheme,R=null==(i=p.form_data)?void 0:i.own_color_scheme,B=null==(l=p.form_data)?void 0:l.dashboard_color_scheme;let P=Number(null==(s=p.form_data)?void 0:s.dashboardId);return Number.isNaN(P)&&(P=void 0),{isDatasourceMetaLoading:p.isDatasourceMetaLoading,datasource:S,datasource_type:S.type,datasourceId:S.datasource_id,dashboardId:P,colorScheme:D,ownColorScheme:R,dashboardColorScheme:B,controls:p.controls,can_add:!!p.can_add,can_download:!!p.can_download,can_overwrite:!!p.can_overwrite,column_formats:null!=(d=null==S?void 0:S.column_formats)?d:null,containerId:C?`slice-container-${C.slice_id}`:"slice-container",isStarred:p.isStarred,slice:C,sliceName:null!=(c=null!=(u=p.sliceName)?u:null==C?void 0:C.slice_name)?c:null,triggerRender:p.triggerRender,form_data:M,table_name:S.table_name,vizType:M.viz_type,standalone:!!p.standalone,force:!!p.force,chart:O,timeout:g.conf.SUPERSET_WEBSERVER_TIMEOUT,ownState:null==(h=v[T])?void 0:h.ownState,impressionId:m,user:y,exploreState:p,reports:b,metadata:k,saveAction:p.saveAction,isSaveModalVisible:x.isVisible}}),(function(e){const t={...ie,...ne.yn,...le,...Q,...V};return{actions:(0,P.DE)(t,e)}}))((0,de.ZP)((0,n.memo)(zs)));a(365634);(0,s.t)("Chart Options"),(0,s.t)("Use Area Proportions"),(0,s.t)("Check if the Rose Chart should use segment area instead of segment radius for proportioning"),(0,s.t)("Stacked Style"),(0,s.t)("stack"),(0,s.t)("stream"),(0,s.t)("expand"),(0,s.t)("Chart Options"),(0,s.t)("Chart Options"),(0,s.t)("Columns"),(0,s.t)("Columns to display"),pe.i9.Table;const Ws={form_data:{datasource:"0__table",viz_type:"table"},dataset:{id:0,type:pe.i9.Table,columns:[],metrics:[],column_formats:{},currency_formats:{},verbose_map:{},main_dttm_col:"",owners:[],datasource_name:"missing_datasource",name:"missing_datasource",description:null},slice:null};var Us=a(46306),qs=a(399232);const Vs=e=>e.reduce(((e,t)=>{var a;return a=t,e.some((e=>(0,Us.jz)(e)&&(0,Us.jz)(a)&&e.clause===a.clause&&e.sqlExpression===a.sqlExpression||(0,Us.Ki)(e)&&(0,Us.Ki)(a)&&e.operator===a.operator&&e.subject===a.subject&&(!("comparator"in e)&&!("comparator"in a)||"comparator"in e&&"comparator"in a&&T()(e.comparator,a.comparator))))||e.push(t),e}),[]),Gs=(e,t)=>{const a=e.extra_form_data||{};return"time_range"in a?t.map((e=>"TEMPORAL_RANGE"===e.operator?{...e,comparator:a.time_range,isExtra:!0}:e)):t},Ks=(e,t)=>{const a=((e,t)=>{const a={__time_range:"time_range",__time_col:"granularity_sqla",__time_grain:"time_grain_sqla",__granularity:"granularity"},n={},o={};return(0,fe.Z)(t.extra_filters).forEach((e=>{if(a[e.col])e.val!==Ge.vM&&(o[a[e.col]]=e.val,n[e.col]=e.val);else{const t=(0,qs.f)({...e,isExtra:!0});o.adhoc_filters=[...(0,fe.Z)(o.adhoc_filters),t]}})),o.applied_time_extras=n,o})(0,t),n=((e,t)=>{const a={},n=t.extra_form_data||{};Object.entries(Ge.gn).forEach((([e,t])=>{const o=n[e];(0,i.Z)(o)&&(a[t]=o)})),"time_grain_sqla"in n&&(a.time_grain_sqla=n.time_grain_sqla),"granularity_sqla"in n&&(a.granularity_sqla=n.granularity_sqla);const o=t.extras||{};Ge.fn.forEach((e=>{const t=n[e];(0,i.Z)(t)&&(o[e]=t)})),Object.keys(o).length&&(a.extras=o),a.adhoc_filters=(0,fe.Z)(n.adhoc_filters).map((e=>({...e,isExtra:!0})));const r=(0,fe.Z)(n.filters).map((e=>(0,qs.f)({...e,isExtra:!0})));return Object.keys(e).forEach((e=>{e.match(/adhoc_filter.*/)&&(a[e]=[...(0,fe.Z)(a[e]),...r])})),a})(e,t),o=[...Object.keys(e),...Object.keys(a),...Object.keys(n)].filter((e=>e.match(/adhoc_filter.*/))).reduce(((o,r)=>{return{...o,[r]:(i=Gs(t,Vs([...(0,fe.Z)(e[r]),...(0,fe.Z)(a[r]),...(0,fe.Z)(n[r])])),l=0===e.slice_id,i.map((e=>e.isExtra?{...e,isExtra:!l}:e)))};var i,l}),{}),r=e.color_scheme,l=t.color_scheme,s=l||r;return{...e,...t,...a,...n,...o,own_color_scheme:r,color_scheme:s,dashboard_color_scheme:l}},Ys=async e=>{try{var t;const a=await(0,l.Z)({method:"GET",endpoint:"api/v1/explore/"})(e);if((e=>{var t,a,n;return(null==e||null==(t=e.result)?void 0:t.form_data)&&(0,i.Z)(null==e||null==(a=e.result)||null==(n=a.dataset)?void 0:n.id)})(a))return a;let n=(0,s.t)("Failed to load chart data");const o=null==a||null==(t=a.result)?void 0:t.message;throw o&&(n=`${n}:\n${o}`),new Error(n)}catch(e){const t=await(0,d.O$)(e);throw new Error(t.message||t.error||(0,s.t)("Failed to load chart data."))}},Qs=()=>{const e=(t=(0,p.eY)(f.KD.dashboardPageId))&&(0,W.rV)(W.dR.DashboardExploreContext,{})[t]||null;var t;if(e){const t=(0,p.eY)(f.KD.sliceId)||0,{colorScheme:a,labelsColor:n,labelsColorMap:o,sharedLabelsColors:r,chartConfiguration:i,nativeFilters:l,filterBoxFilters:s,dataMask:d,dashboardId:c}=e,u=(0,g.Z)({chart:{id:t},filters:(0,m._f)(t,s),nativeFilters:l,chartConfiguration:i,dataMask:d,colorScheme:a,labelsColor:n,labelsColorMap:o,sharedLabelsColors:r,sliceId:t,allSliceIds:[t],extraControls:{}});return Object.assign(u,{dashboardId:c}),u}return null};function Js(){const[e,t]=(0,n.useState)(!1),a=(0,n.useRef)(!1),i=(0,o.I0)(),l=(0,r.TH)();return(0,n.useEffect)((()=>{const e=x(l),n=(0,p.eY)(f.KD.saveAction),o=Qs();a.current&&!n||Ys(e).then((({result:e})=>{const t=!a.current&&o?Ks(e.form_data,o):e.form_data;i((0,w.u)({...e,form_data:t,saveAction:n}))})).catch((e=>{i((0,w.u)(Ws)),i((0,h.Gb)(e.message))})).finally((()=>{t(!0),a.current=!0})),(0,c.ZP)().source=c.Fx.Explore}),[i,l]),e?(0,Ze.tZ)(Xs,{}):(0,Ze.tZ)(u.Z,{})}}}]);
//# sourceMappingURL=ec75c12e5ab4bcbe5c7c.chunk.js.map