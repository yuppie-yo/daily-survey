{"version":3,"file":"f7ac7bf30e49c6cb91cc.chunk.js","mappings":"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","sources":["webpack://superset/./node_modules/d3-selection/src/selector.js","webpack://superset/./node_modules/d3-selection/src/selectorAll.js","webpack://superset/./node_modules/d3-selection/src/matcher.js","webpack://superset/./node_modules/d3-selection/src/selection/selectChild.js","webpack://superset/./node_modules/d3-selection/src/selection/selectChildren.js","webpack://superset/./node_modules/d3-selection/src/selection/sparse.js","webpack://superset/./node_modules/d3-selection/src/selection/enter.js","webpack://superset/./node_modules/d3-selection/src/selection/data.js","webpack://superset/./node_modules/d3-selection/src/selection/sort.js","webpack://superset/./node_modules/d3-selection/src/namespaces.js","webpack://superset/./node_modules/d3-selection/src/namespace.js","webpack://superset/./node_modules/d3-selection/src/selection/attr.js","webpack://superset/./node_modules/d3-selection/src/window.js","webpack://superset/./node_modules/d3-selection/src/selection/style.js","webpack://superset/./node_modules/d3-selection/src/selection/property.js","webpack://superset/./node_modules/d3-selection/src/selection/classed.js","webpack://superset/./node_modules/d3-selection/src/selection/text.js","webpack://superset/./node_modules/d3-selection/src/selection/html.js","webpack://superset/./node_modules/d3-selection/src/selection/raise.js","webpack://superset/./node_modules/d3-selection/src/selection/lower.js","webpack://superset/./node_modules/d3-selection/src/creator.js","webpack://superset/./node_modules/d3-selection/src/selection/insert.js","webpack://superset/./node_modules/d3-selection/src/selection/remove.js","webpack://superset/./node_modules/d3-selection/src/selection/clone.js","webpack://superset/./node_modules/d3-selection/src/selection/on.js","webpack://superset/./node_modules/d3-selection/src/selection/dispatch.js","webpack://superset/./node_modules/d3-selection/src/selection/index.js","webpack://superset/./node_modules/d3-selection/src/selection/select.js","webpack://superset/./node_modules/d3-selection/src/selection/selectAll.js","webpack://superset/./node_modules/d3-selection/src/array.js","webpack://superset/./node_modules/d3-selection/src/selection/filter.js","webpack://superset/./node_modules/d3-selection/src/constant.js","webpack://superset/./node_modules/d3-selection/src/selection/exit.js","webpack://superset/./node_modules/d3-selection/src/selection/join.js","webpack://superset/./node_modules/d3-selection/src/selection/merge.js","webpack://superset/./node_modules/d3-selection/src/selection/order.js","webpack://superset/./node_modules/d3-selection/src/selection/call.js","webpack://superset/./node_modules/d3-selection/src/selection/nodes.js","webpack://superset/./node_modules/d3-selection/src/selection/node.js","webpack://superset/./node_modules/d3-selection/src/selection/size.js","webpack://superset/./node_modules/d3-selection/src/selection/empty.js","webpack://superset/./node_modules/d3-selection/src/selection/each.js","webpack://superset/./node_modules/d3-selection/src/selection/append.js","webpack://superset/./node_modules/d3-selection/src/selection/datum.js","webpack://superset/./node_modules/d3-selection/src/selection/iterator.js","webpack://superset/./plugins/legacy-plugin-chart-calendar/src/vendor/cal-heatmap.js","webpack://superset/./plugins/legacy-plugin-chart-calendar/src/Calendar.js","webpack://superset/./node_modules/d3-selection/src/select.js","webpack://superset/./plugins/legacy-plugin-chart-calendar/node_modules/d3-array/src/extent.js","webpack://superset/./plugins/legacy-plugin-chart-calendar/node_modules/d3-array/src/range.js","webpack://superset/./plugins/legacy-plugin-chart-calendar/src/ReactCalendar.jsx","webpack://superset/./packages/superset-ui-core/src/chart/components/reactify.tsx"],"sourcesContent":["function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n\nexport function childMatcher(selector) {\n  return function(node) {\n    return node.matches(selector);\n  };\n}\n\n","import {childMatcher} from \"../matcher.js\";\n\nvar find = Array.prototype.find;\n\nfunction childFind(match) {\n  return function() {\n    return find.call(this.children, match);\n  };\n}\n\nfunction childFirst() {\n  return this.firstElementChild;\n}\n\nexport default function(match) {\n  return this.select(match == null ? childFirst\n      : childFind(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","import {childMatcher} from \"../matcher.js\";\n\nvar filter = Array.prototype.filter;\n\nfunction children() {\n  return Array.from(this.children);\n}\n\nfunction childrenFilter(match) {\n  return function() {\n    return filter.call(this.children, match);\n  };\n}\n\nexport default function(match) {\n  return this.selectAll(match == null ? children\n      : childrenFilter(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index.js\";\nimport {EnterNode} from \"./enter.js\";\nimport constant from \"../constant.js\";\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that dont fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = new Map,\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = key.call(node, node.__data__, i, group) + \"\";\n      if (nodeByKeyValue.has(keyValue)) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue.set(keyValue, node);\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = key.call(parent, data[i], i, data) + \"\";\n    if (node = nodeByKeyValue.get(keyValue)) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue.delete(keyValue);\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue.get(keyValues[i]) === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction datum(node) {\n  return node.__data__;\n}\n\nexport default function(value, key) {\n  if (!arguments.length) return Array.from(this, datum);\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = arraylike(value.call(parent, parent && parent.__data__, j, parents)),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n\n// Given some data, this returns an array-like view of it: an object that\n// exposes a length property and allows numeric indexing. Note that unlike\n// selectAll, this isnt worried about live collections because the resulting\n// array will only be used briefly while data is being bound. (It is possible to\n// cause the data to change while iterating by using a key function, but please\n// dont; wed rather avoid a gratuitous copy.)\nfunction arraylike(data) {\n  return typeof data === \"object\" && \"length\" in data\n    ? data // Array, TypedArray, NodeList, array-like\n    : Array.from(data); // Map, Set, iterable, string, or anything else\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces.js\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name; // eslint-disable-line no-prototype-builtins\n}\n","import namespace from \"../namespace.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window.js\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import namespace from \"./namespace.js\";\nimport {xhtml} from \"./namespaces.js\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","import creator from \"../creator.js\";\nimport selector from \"../selector.js\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","function contextListener(listener) {\n  return function(event) {\n    listener.call(this, event, this.__data__);\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, options) {\n  return function() {\n    var on = this.__on, o, listener = contextListener(value);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n        this.addEventListener(o.type, o.listener = listener, o.options = options);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, options);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, options: options};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, options) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, options));\n  return this;\n}\n","import defaultView from \"../window.js\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select.js\";\nimport selection_selectAll from \"./selectAll.js\";\nimport selection_selectChild from \"./selectChild.js\";\nimport selection_selectChildren from \"./selectChildren.js\";\nimport selection_filter from \"./filter.js\";\nimport selection_data from \"./data.js\";\nimport selection_enter from \"./enter.js\";\nimport selection_exit from \"./exit.js\";\nimport selection_join from \"./join.js\";\nimport selection_merge from \"./merge.js\";\nimport selection_order from \"./order.js\";\nimport selection_sort from \"./sort.js\";\nimport selection_call from \"./call.js\";\nimport selection_nodes from \"./nodes.js\";\nimport selection_node from \"./node.js\";\nimport selection_size from \"./size.js\";\nimport selection_empty from \"./empty.js\";\nimport selection_each from \"./each.js\";\nimport selection_attr from \"./attr.js\";\nimport selection_style from \"./style.js\";\nimport selection_property from \"./property.js\";\nimport selection_classed from \"./classed.js\";\nimport selection_text from \"./text.js\";\nimport selection_html from \"./html.js\";\nimport selection_raise from \"./raise.js\";\nimport selection_lower from \"./lower.js\";\nimport selection_append from \"./append.js\";\nimport selection_insert from \"./insert.js\";\nimport selection_remove from \"./remove.js\";\nimport selection_clone from \"./clone.js\";\nimport selection_datum from \"./datum.js\";\nimport selection_on from \"./on.js\";\nimport selection_dispatch from \"./dispatch.js\";\nimport selection_iterator from \"./iterator.js\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nfunction selection_selection() {\n  return this;\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  selectChild: selection_selectChild,\n  selectChildren: selection_selectChildren,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  selection: selection_selection,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch,\n  [Symbol.iterator]: selection_iterator\n};\n\nexport default selection;\n","import {Selection} from \"./index.js\";\nimport selector from \"../selector.js\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index.js\";\nimport array from \"../array.js\";\nimport selectorAll from \"../selectorAll.js\";\n\nfunction arrayAll(select) {\n  return function() {\n    return array(select.apply(this, arguments));\n  };\n}\n\nexport default function(select) {\n  if (typeof select === \"function\") select = arrayAll(select);\n  else select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","// Given something array like (or null), returns something that is strictly an\n// array. This is used to ensure that array-like objects passed to d3.selectAll\n// or selection.selectAll are converted into proper arrays when creating a\n// selection; we dont ever want to create a selection backed by a live\n// HTMLCollection or NodeList. However, note that selection.selectAll will use a\n// static NodeList as a group, since it safely derived from querySelectorAll.\nexport default function array(x) {\n  return x == null ? [] : Array.isArray(x) ? x : Array.from(x);\n}\n","import {Selection} from \"./index.js\";\nimport matcher from \"../matcher.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  if (typeof onenter === \"function\") {\n    enter = onenter(enter);\n    if (enter) enter = enter.selection();\n  } else {\n    enter = enter.append(onenter + \"\");\n  }\n  if (onupdate != null) {\n    update = onupdate(update);\n    if (update) update = update.selection();\n  }\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(context) {\n  var selection = context.selection ? context.selection() : context;\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  return Array.from(this);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  let size = 0;\n  for (const node of this) ++size; // eslint-disable-line no-unused-vars\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import creator from \"../creator.js\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","export default function*() {\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) yield node;\n    }\n  }\n}\n","// [LICENSE TBD]\n/* Copied and altered from http://cal-heatmap.com/ , alterations around:\n * - tuning tooltips\n * - supporting multi-colors scales\n * - legend format\n * - UTC handling\n */\n\n/* eslint-disable */\n\nimport d3tip from 'd3-tip';\nimport { getContrastingColor, t } from '@superset-ui/core';\n\nvar d3 = typeof require === 'function' ? require('d3') : window.d3;\n\nvar d3 = typeof require === 'function' ? require('d3') : window.d3;\n\nvar CalHeatMap = function () {\n  'use strict';\n\n  var self = this;\n  self.tip = d3tip()\n    .attr('class', 'd3-tip')\n    .direction('n')\n    .offset([-5, 0])\n    .html(\n      d => `\n      ${self.options.timeFormatter(d.t)}: <strong>${self.options.valueFormatter(\n        d.v,\n      )}</strong>\n    `,\n    );\n  self.legendTip = d3tip()\n    .attr('class', 'd3-tip')\n    .direction('n')\n    .offset([-5, 0])\n    .html(d => self.options.valueFormatter(d));\n\n  this.allowedDataType = ['json', 'csv', 'tsv', 'txt'];\n\n  // Default settings\n  this.options = {\n    // selector string of the container to append the graph to\n    // Accept any string value accepted by document.querySelector or CSS3\n    // or an Element object\n    itemSelector: '#cal-heatmap',\n\n    // Whether to paint the calendar on init()\n    // Used by testsuite to reduce testing time\n    paintOnLoad: true,\n\n    // ================================================\n    // DOMAIN\n    // ================================================\n\n    // Number of domain to display on the graph\n    range: 12,\n\n    // Size of each cell, in pixel\n    cellSize: 10,\n\n    // Padding between each cell, in pixel\n    cellPadding: 2,\n\n    // For rounded subdomain rectangles, in pixels\n    cellRadius: 0,\n\n    domainGutter: 2,\n\n    domainMargin: [0, 0, 0, 0],\n\n    valueFormatter: d => d,\n\n    timeFormatter: d => d,\n\n    domain: 'hour',\n\n    subDomain: 'min',\n\n    // Number of columns to split the subDomains to\n    // If not null, will takes precedence over rowLimit\n    colLimit: null,\n\n    // Number of rows to split the subDomains to\n    // Will be ignored if colLimit is not null\n    rowLimit: null,\n\n    // First day of the week is Monday\n    // 0 to start the week on Sunday\n    weekStartOnMonday: true,\n\n    // Start date of the graph\n    // @default now\n    start: new Date(),\n\n    minDate: null,\n\n    maxDate: null,\n\n    // ================================================\n    // DATA\n    // ================================================\n\n    // Data source\n    // URL, where to fetch the original datas\n    data: '',\n\n    // Data type\n    // Default: json\n    dataType: this.allowedDataType[0],\n\n    // Payload sent when using POST http method\n    // Leave to null (default) for GET request\n    // Expect a string, formatted like \"a=b;c=d\"\n    dataPostPayload: null,\n\n    // Additional headers sent when requesting data\n    // Expect an object formatted like:\n    // { 'X-CSRF-TOKEN': 'token' }\n    dataRequestHeaders: null,\n\n    // Whether to consider missing date:value from the datasource\n    // as equal to 0, or just leave them as missing\n    considerMissingDataAsZero: false,\n\n    // Load remote data on calendar creation\n    // When false, the calendar will be left empty\n    loadOnInit: true,\n\n    // Calendar orientation\n    // false: display domains side by side\n    // true : display domains one under the other\n    verticalOrientation: false,\n\n    // Domain dynamic width/height\n    // The width on a domain depends on the number of\n    domainDynamicDimension: true,\n\n    // Domain Label properties\n    label: {\n      // valid: top, right, bottom, left\n      position: 'bottom',\n\n      // Valid: left, center, right\n      // Also valid are the direct svg values: start, middle, end\n      align: 'center',\n\n      // By default, there is no margin/padding around the label\n      offset: {\n        x: 0,\n        y: 0,\n      },\n\n      rotate: null,\n\n      // Used only on vertical orientation\n      width: 100,\n\n      // Used only on horizontal orientation\n      height: null,\n    },\n\n    // ================================================\n    // LEGEND\n    // ================================================\n\n    // Threshold for the legend\n    legend: [10, 20, 30, 40],\n\n    // Whether to display the legend\n    displayLegend: true,\n\n    legendCellSize: 10,\n\n    legendCellPadding: 2,\n\n    legendMargin: [0, 0, 0, 0],\n\n    // Legend vertical position\n    // top: place legend above calendar\n    // bottom: place legend below the calendar\n    legendVerticalPosition: 'bottom',\n\n    // Legend horizontal position\n    // accepted values: left, center, right\n    legendHorizontalPosition: 'left',\n\n    // Legend rotation\n    // accepted values: horizontal, vertical\n    legendOrientation: 'horizontal',\n\n    // Objects holding all the heatmap different colors\n    // null to disable, and use the default css styles\n    //\n    // Examples:\n    // legendColors: {\n    //    min: \"green\",\n    //    max: \"red\",\n    //    empty: \"#ffffff\",\n    //    base: \"grey\",\n    //    overflow: \"red\",\n    //    colorScaler: null,\n    // }\n    legendColors: null,\n\n    // ================================================\n    // HIGHLIGHT\n    // ================================================\n\n    // List of dates to highlight\n    // Valid values:\n    // - []: don't highlight anything\n    // - \"now\": highlight the current date\n    // - an array of Date objects: highlight the specified dates\n    highlight: [],\n\n    // ================================================\n    // TEXT FORMATTING / i18n\n    // ================================================\n\n    // Name of the items to represent in the calendar\n    itemName: ['item', 'items'],\n\n    // Formatting of the domain label\n    // @default: null, will use the formatting according to domain type\n    // Accept a string used as specifier by d3.time.format()\n    // or a function\n    //\n    // Refer to https://github.com/mbostock/d3/wiki/Time-Formatting\n    // for accepted date formatting used by d3.time.format()\n    domainLabelFormat: null,\n\n    // Formatting of the title displayed when hovering a subDomain cell\n    subDomainTitleFormat: {\n      empty: '{date}',\n      filled: '{count} {name} {connector} {date}',\n    },\n\n    // Formatting of the {date} used in subDomainTitleFormat\n    // @default: null, will use the formatting according to subDomain type\n    // Accept a string used as specifier by d3.time.format()\n    // or a function\n    //\n    // Refer to https://github.com/mbostock/d3/wiki/Time-Formatting\n    // for accepted date formatting used by d3.time.format()\n    subDomainDateFormat: null,\n\n    // Formatting of the text inside each subDomain cell\n    // @default: null, no text\n    // Accept a string used as specifier by d3.time.format()\n    // or a function\n    //\n    // Refer to https://github.com/mbostock/d3/wiki/Time-Formatting\n    // for accepted date formatting used by d3.time.format()\n    subDomainTextFormat: null,\n\n    // Formatting of the title displayed when hovering a legend cell\n    legendTitleFormat: {\n      lower: t('less than {min} {name}'),\n      inner: t('between {down} and {up} {name}'),\n      upper: t('more than {max} {name}'),\n    },\n\n    // Animation duration, in ms\n    animationDuration: 500,\n\n    nextSelector: false,\n\n    previousSelector: false,\n\n    itemNamespace: 'cal-heatmap',\n\n    tooltip: false,\n\n    // ================================================\n    // EVENTS CALLBACK\n    // ================================================\n\n    // Callback when clicking on a time block\n    onClick: null,\n\n    // Callback after painting the empty calendar\n    // Can be used to trigger an API call, once the calendar is ready to be filled\n    afterLoad: null,\n\n    // Callback after loading the next domain in the calendar\n    afterLoadNextDomain: null,\n\n    // Callback after loading the previous domain in the calendar\n    afterLoadPreviousDomain: null,\n\n    // Callback after finishing all actions on the calendar\n    onComplete: null,\n\n    // Callback after fetching the datas, but before applying them to the calendar\n    // Used mainly to convert the datas if they're not formatted like expected\n    // Takes the fetched \"data\" object as argument, must return a json object\n    // formatted like {timestamp:count, timestamp2:count2},\n    afterLoadData: function (timestamps) {\n      // See https://github.com/wa0x6e/cal-heatmap/issues/126#issuecomment-373301803\n      const stdTimezoneOffset = date => {\n        const jan = new Date(date.getFullYear(), 0, 1);\n        const jul = new Date(date.getFullYear(), 6, 1);\n        return Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());\n      };\n      const offset = stdTimezoneOffset(new Date()) * 60;\n      let results = {};\n      for (let timestamp in timestamps) {\n        const value = timestamps[timestamp];\n        timestamp = parseInt(timestamp, 10);\n        results[timestamp + offset] = value;\n      }\n      return results;\n    },\n\n    // Callback triggered after calling and completing update().\n    afterUpdate: null,\n\n    // Callback triggered after calling next().\n    // The `status` argument is equal to true if there is no\n    // more next domain to load\n    //\n    // This callback is also executed once, after calling previous(),\n    // only when the max domain is reached\n    onMaxDomainReached: null,\n\n    // Callback triggered after calling previous().\n    // The `status` argument is equal to true if there is no\n    // more previous domain to load\n    //\n    // This callback is also executed once, after calling next(),\n    // only when the min domain is reached\n    onMinDomainReached: null,\n  };\n\n  this._domainType = {\n    min: {\n      name: 'minute',\n      level: 10,\n      maxItemNumber: 60,\n      defaultRowNumber: 10,\n      defaultColumnNumber: 6,\n      row: function (d) {\n        return self.getSubDomainRowNumber(d);\n      },\n      column: function (d) {\n        return self.getSubDomainColumnNumber(d);\n      },\n      position: {\n        x: function (d) {\n          return Math.floor(d.getMinutes() / self._domainType.min.row(d));\n        },\n        y: function (d) {\n          return d.getMinutes() % self._domainType.min.row(d);\n        },\n      },\n      format: {\n        date: '%H:%M, %A %B %-e, %Y',\n        legend: '',\n        connector: 'at',\n      },\n      extractUnit: function (d) {\n        return new Date(\n          d.getFullYear(),\n          d.getMonth(),\n          d.getDate(),\n          d.getHours(),\n          d.getMinutes(),\n        ).getTime();\n      },\n    },\n    hour: {\n      name: 'hour',\n      level: 20,\n      maxItemNumber: function (d) {\n        switch (self.options.domain) {\n          case 'day':\n            return 24;\n          case 'week':\n            return 24 * 7;\n          case 'month':\n            return (\n              24 *\n              (self.options.domainDynamicDimension\n                ? self.getDayCountInMonth(d)\n                : 31)\n            );\n        }\n      },\n      defaultRowNumber: 6,\n      defaultColumnNumber: function (d) {\n        switch (self.options.domain) {\n          case 'day':\n            return 4;\n          case 'week':\n            return 28;\n          case 'month':\n            return self.options.domainDynamicDimension\n              ? self.getDayCountInMonth(d)\n              : 31;\n        }\n      },\n      row: function (d) {\n        return self.getSubDomainRowNumber(d);\n      },\n      column: function (d) {\n        return self.getSubDomainColumnNumber(d);\n      },\n      position: {\n        x: function (d) {\n          if (self.options.domain === 'month') {\n            if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n              return Math.floor(\n                (d.getHours() + (d.getDate() - 1) * 24) /\n                  self._domainType.hour.row(d),\n              );\n            }\n            return (\n              Math.floor(d.getHours() / self._domainType.hour.row(d)) +\n              (d.getDate() - 1) * 4\n            );\n          } else if (self.options.domain === 'week') {\n            if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n              return Math.floor(\n                (d.getHours() + self.getWeekDay(d) * 24) /\n                  self._domainType.hour.row(d),\n              );\n            }\n            return (\n              Math.floor(d.getHours() / self._domainType.hour.row(d)) +\n              self.getWeekDay(d) * 4\n            );\n          }\n          return Math.floor(d.getHours() / self._domainType.hour.row(d));\n        },\n        y: function (d) {\n          var p = d.getHours();\n          if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n            switch (self.options.domain) {\n              case 'month':\n                p += (d.getDate() - 1) * 24;\n                break;\n              case 'week':\n                p += self.getWeekDay(d) * 24;\n                break;\n            }\n          }\n          return Math.floor(p % self._domainType.hour.row(d));\n        },\n      },\n      format: {\n        date: '%Hh, %A %B %-e, %Y',\n        legend: '%H:00',\n        connector: 'at',\n      },\n      extractUnit: function (d) {\n        return new Date(\n          d.getFullYear(),\n          d.getMonth(),\n          d.getDate(),\n          d.getHours(),\n        ).getTime();\n      },\n    },\n    day: {\n      name: 'day',\n      level: 30,\n      maxItemNumber: function (d) {\n        switch (self.options.domain) {\n          case 'week':\n            return 7;\n          case 'month':\n            return self.options.domainDynamicDimension\n              ? self.getDayCountInMonth(d)\n              : 31;\n          case 'year':\n            return self.options.domainDynamicDimension\n              ? self.getDayCountInYear(d)\n              : 366;\n        }\n      },\n      defaultColumnNumber: function (d) {\n        d = new Date(d);\n        switch (self.options.domain) {\n          case 'week':\n            return 1;\n          case 'month':\n            return self.options.domainDynamicDimension &&\n              !self.options.verticalOrientation\n              ? self.getWeekNumber(\n                  new Date(d.getFullYear(), d.getMonth() + 1, 0),\n                ) -\n                  self.getWeekNumber(d) +\n                  1\n              : 6;\n          case 'year':\n            return self.options.domainDynamicDimension\n              ? self.getWeekNumber(new Date(d.getFullYear(), 11, 31)) -\n                  self.getWeekNumber(new Date(d.getFullYear(), 0)) +\n                  1\n              : 54;\n        }\n      },\n      defaultRowNumber: 7,\n      row: function (d) {\n        return self.getSubDomainRowNumber(d);\n      },\n      column: function (d) {\n        return self.getSubDomainColumnNumber(d);\n      },\n      position: {\n        x: function (d) {\n          switch (self.options.domain) {\n            case 'week':\n              return Math.floor(\n                self.getWeekDay(d) / self._domainType.day.row(d),\n              );\n            case 'month':\n              if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n                return Math.floor(\n                  (d.getDate() - 1) / self._domainType.day.row(d),\n                );\n              }\n              return (\n                self.getWeekNumber(d) -\n                self.getWeekNumber(new Date(d.getFullYear(), d.getMonth()))\n              );\n            case 'year':\n              if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n                return Math.floor(\n                  (self.getDayOfYear(d) - 1) / self._domainType.day.row(d),\n                );\n              }\n              return self.getWeekNumber(d);\n          }\n        },\n        y: function (d) {\n          var p = self.getWeekDay(d);\n          if (self.options.colLimit > 0 || self.options.rowLimit > 0) {\n            switch (self.options.domain) {\n              case 'year':\n                p = self.getDayOfYear(d) - 1;\n                break;\n              case 'week':\n                p = self.getWeekDay(d);\n                break;\n              case 'month':\n                p = d.getDate() - 1;\n                break;\n            }\n          }\n          return Math.floor(p % self._domainType.day.row(d));\n        },\n      },\n      format: {\n        date: '%A %B %-e, %Y',\n        legend: '%e %b',\n        connector: 'on',\n      },\n      extractUnit: function (d) {\n        return new Date(d.getFullYear(), d.getMonth(), d.getDate()).getTime();\n      },\n    },\n    week: {\n      name: 'week',\n      level: 40,\n      maxItemNumber: 54,\n      defaultColumnNumber: function (d) {\n        d = new Date(d);\n        switch (self.options.domain) {\n          case 'year':\n            return self._domainType.week.maxItemNumber;\n          case 'month':\n            return self.options.domainDynamicDimension\n              ? self.getWeekNumber(\n                  new Date(d.getFullYear(), d.getMonth() + 1, 0),\n                ) - self.getWeekNumber(d)\n              : 5;\n        }\n      },\n      defaultRowNumber: 1,\n      row: function (d) {\n        return self.getSubDomainRowNumber(d);\n      },\n      column: function (d) {\n        return self.getSubDomainColumnNumber(d);\n      },\n      position: {\n        x: function (d) {\n          switch (self.options.domain) {\n            case 'year':\n              return Math.floor(\n                self.getWeekNumber(d) / self._domainType.week.row(d),\n              );\n            case 'month':\n              return Math.floor(\n                self.getMonthWeekNumber(d) / self._domainType.week.row(d),\n              );\n          }\n        },\n        y: function (d) {\n          return self.getWeekNumber(d) % self._domainType.week.row(d);\n        },\n      },\n      format: {\n        date: '%B Week #%W',\n        legend: '%B Week #%W',\n        connector: 'in',\n      },\n      extractUnit: function (d) {\n        var dt = new Date(d.getFullYear(), d.getMonth(), d.getDate());\n        // According to ISO-8601, week number computation are based on week starting on Monday\n        var weekDay = dt.getDay() - (self.options.weekStartOnMonday ? 1 : 0);\n        if (weekDay < 0) {\n          weekDay = 6;\n        }\n        dt.setDate(dt.getDate() - weekDay);\n        return dt.getTime();\n      },\n    },\n    month: {\n      name: 'month',\n      level: 50,\n      maxItemNumber: 12,\n      defaultColumnNumber: 12,\n      defaultRowNumber: 1,\n      row: function () {\n        return self.getSubDomainRowNumber();\n      },\n      column: function () {\n        return self.getSubDomainColumnNumber();\n      },\n      position: {\n        x: function (d) {\n          return Math.floor(d.getMonth() / self._domainType.month.row(d));\n        },\n        y: function (d) {\n          return d.getMonth() % self._domainType.month.row(d);\n        },\n      },\n      format: {\n        date: '%B %Y',\n        legend: '%B',\n        connector: 'in',\n      },\n      extractUnit: function (d) {\n        return new Date(d.getFullYear(), d.getMonth()).getTime();\n      },\n    },\n    year: {\n      name: 'year',\n      level: 60,\n      row: function () {\n        return self.options.rowLimit || 1;\n      },\n      column: function () {\n        return self.options.colLimit || 1;\n      },\n      position: {\n        x: function () {\n          return 1;\n        },\n        y: function () {\n          return 1;\n        },\n      },\n      format: {\n        date: '%Y',\n        legend: '%Y',\n        connector: 'in',\n      },\n      extractUnit: function (d) {\n        return new Date(d.getFullYear()).getTime();\n      },\n    },\n  };\n\n  for (var type in this._domainType) {\n    if (this._domainType.hasOwnProperty(type)) {\n      var d = this._domainType[type];\n      this._domainType['x_' + type] = {\n        name: 'x_' + type,\n        level: d.type,\n        maxItemNumber: d.maxItemNumber,\n        defaultRowNumber: d.defaultRowNumber,\n        defaultColumnNumber: d.defaultColumnNumber,\n        row: d.column,\n        column: d.row,\n        position: {\n          x: d.position.y,\n          y: d.position.x,\n        },\n        format: d.format,\n        extractUnit: d.extractUnit,\n      };\n    }\n  }\n\n  // Record the address of the last inserted domain when browsing\n  this.lastInsertedSvg = null;\n\n  this._completed = false;\n\n  // Record all the valid domains\n  // Each domain value is a timestamp in milliseconds\n  this._domains = d3.map();\n\n  this.graphDim = {\n    width: 0,\n    height: 0,\n  };\n\n  this.legendDim = {\n    width: 0,\n    height: 0,\n  };\n\n  this.NAVIGATE_LEFT = 1;\n  this.NAVIGATE_RIGHT = 2;\n\n  // Various update mode when using the update() API\n  this.RESET_ALL_ON_UPDATE = 0;\n  this.RESET_SINGLE_ON_UPDATE = 1;\n  this.APPEND_ON_UPDATE = 2;\n\n  this.DEFAULT_LEGEND_MARGIN = 10;\n\n  this.root = null;\n  this.tooltip = null;\n\n  this._maxDomainReached = false;\n  this._minDomainReached = false;\n\n  this.domainPosition = new DomainPosition();\n  this.Legend = null;\n  this.legendScale = null;\n\n  // List of domains that are skipped because of DST\n  // All times belonging to these domains should be re-assigned to the previous domain\n  this.DSTDomain = [];\n\n  /**\n   * Display the graph for the first time\n   * @return bool True if the calendar is created\n   */\n  this._init = function () {\n    self\n      .getDomain(self.options.start)\n      .map(function (d) {\n        return d.getTime();\n      })\n      .map(function (d) {\n        self._domains.set(\n          d,\n          self.getSubDomain(d).map(function (d) {\n            return {\n              t: self._domainType[self.options.subDomain].extractUnit(d),\n              v: null,\n            };\n          }),\n        );\n      });\n\n    self.root = d3\n      .select(self.options.itemSelector)\n      .append('svg')\n      .attr('class', 'cal-heatmap-container');\n\n    self.root.attr('x', 0).attr('y', 0).append('svg').attr('class', 'graph');\n\n    self.Legend = new Legend(self);\n\n    if (self.options.paintOnLoad) {\n      _initCalendar();\n    }\n    self.root.call(self.tip);\n    self.root.call(self.legendTip);\n\n    return true;\n  };\n\n  function _initCalendar() {\n    self.verticalDomainLabel =\n      self.options.label.position === 'top' ||\n      self.options.label.position === 'bottom';\n\n    self.domainVerticalLabelHeight =\n      self.options.label.height === null\n        ? Math.max(25, self.options.cellSize * 2)\n        : self.options.label.height;\n    self.domainHorizontalLabelWidth = 0;\n\n    if (\n      self.options.domainLabelFormat === '' &&\n      self.options.label.height === null\n    ) {\n      self.domainVerticalLabelHeight = 0;\n    }\n\n    if (!self.verticalDomainLabel) {\n      self.domainVerticalLabelHeight = 0;\n      self.domainHorizontalLabelWidth = self.options.label.width;\n    }\n\n    self.paint();\n\n    // =========================================================================//\n    // ATTACHING DOMAIN NAVIGATION EVENT                    //\n    // =========================================================================//\n    if (self.options.nextSelector !== false) {\n      d3.select(self.options.nextSelector).on(\n        'click.' + self.options.itemNamespace,\n        function () {\n          d3.event.preventDefault();\n          return self.loadNextDomain(1);\n        },\n      );\n    }\n\n    if (self.options.previousSelector !== false) {\n      d3.select(self.options.previousSelector).on(\n        'click.' + self.options.itemNamespace,\n        function () {\n          d3.event.preventDefault();\n          return self.loadPreviousDomain(1);\n        },\n      );\n    }\n\n    self.Legend.redraw(\n      self.graphDim.width -\n        self.options.domainGutter -\n        self.options.cellPadding,\n    );\n    self.afterLoad();\n\n    var domains = self.getDomainKeys();\n\n    // Fill the graph with some datas\n    if (self.options.loadOnInit) {\n      self.getDatas(\n        self.options.data,\n        new Date(domains[0]),\n        self.getSubDomain(domains[domains.length - 1]).pop(),\n        function () {\n          self.fill();\n          self.onComplete();\n        },\n      );\n    } else {\n      self.onComplete();\n    }\n\n    self.checkIfMinDomainIsReached(domains[0]);\n    self.checkIfMaxDomainIsReached(self.getNextDomain().getTime());\n  }\n\n  // Return the width of the domain block, without the domain gutter\n  // @param int d Domain start timestamp\n  function w(d, outer) {\n    var width =\n      self.options.cellSize *\n        self._domainType[self.options.subDomain].column(d) +\n      self.options.cellPadding *\n        self._domainType[self.options.subDomain].column(d);\n    if (arguments.length === 2 && outer === true) {\n      return (width +=\n        self.domainHorizontalLabelWidth +\n        self.options.domainGutter +\n        self.options.domainMargin[1] +\n        self.options.domainMargin[3]);\n    }\n    return width;\n  }\n\n  // Return the height of the domain block, without the domain gutter\n  function h(d, outer) {\n    var height =\n      self.options.cellSize * self._domainType[self.options.subDomain].row(d) +\n      self.options.cellPadding *\n        self._domainType[self.options.subDomain].row(d);\n    if (arguments.length === 2 && outer === true) {\n      height +=\n        self.options.domainGutter +\n        self.domainVerticalLabelHeight +\n        self.options.domainMargin[0] +\n        self.options.domainMargin[2];\n    }\n    return height;\n  }\n\n  /**\n   *\n   *\n   * @param int navigationDir\n   */\n  this.paint = function (navigationDir) {\n    var options = self.options;\n\n    if (arguments.length === 0) {\n      navigationDir = false;\n    }\n\n    // Painting all the domains\n    var domainSvg = self.root\n      .select('.graph')\n      .selectAll('.graph-domain')\n      .data(\n        function () {\n          var data = self.getDomainKeys();\n          return navigationDir === self.NAVIGATE_LEFT ? data.reverse() : data;\n        },\n        function (d) {\n          return d;\n        },\n      );\n    var enteringDomainDim = 0;\n    var exitingDomainDim = 0;\n\n    // =========================================================================//\n    // PAINTING DOMAIN                              //\n    // =========================================================================//\n\n    var svg = domainSvg\n      .enter()\n      .append('svg')\n      .attr('width', function (d) {\n        return w(d, true);\n      })\n      .attr('height', function (d) {\n        return h(d, true);\n      })\n      .attr('x', function (d) {\n        if (options.verticalOrientation) {\n          self.graphDim.width = Math.max(self.graphDim.width, w(d, true));\n          return 0;\n        } else {\n          return getDomainPosition(d, self.graphDim, 'width', w(d, true));\n        }\n      })\n      .attr('y', function (d) {\n        if (options.verticalOrientation) {\n          return getDomainPosition(d, self.graphDim, 'height', h(d, true));\n        } else {\n          self.graphDim.height = Math.max(self.graphDim.height, h(d, true));\n          return 0;\n        }\n      })\n      .attr('class', function (d) {\n        var classname = 'graph-domain';\n        var date = new Date(d);\n        switch (options.domain) {\n          case 'hour':\n            classname += ' h_' + date.getHours();\n          /* falls through */\n          case 'day':\n            classname += ' d_' + date.getDate() + ' dy_' + date.getDay();\n          /* falls through */\n          case 'week':\n            classname += ' w_' + self.getWeekNumber(date);\n          /* falls through */\n          case 'month':\n            classname += ' m_' + (date.getMonth() + 1);\n          /* falls through */\n          case 'year':\n            classname += ' y_' + date.getFullYear();\n        }\n        return classname;\n      });\n    self.lastInsertedSvg = svg;\n\n    function getDomainPosition(domainIndex, graphDim, axis, domainDim) {\n      var tmp = 0;\n      switch (navigationDir) {\n        case false:\n          tmp = graphDim[axis];\n\n          graphDim[axis] += domainDim;\n          self.domainPosition.setPosition(domainIndex, tmp);\n          return tmp;\n\n        case self.NAVIGATE_RIGHT:\n          self.domainPosition.setPosition(domainIndex, graphDim[axis]);\n\n          enteringDomainDim = domainDim;\n          exitingDomainDim = self.domainPosition.getPositionFromIndex(1);\n\n          self.domainPosition.shiftRightBy(exitingDomainDim);\n          return graphDim[axis];\n\n        case self.NAVIGATE_LEFT:\n          tmp = -domainDim;\n\n          enteringDomainDim = -tmp;\n          exitingDomainDim = graphDim[axis] - self.domainPosition.getLast();\n\n          self.domainPosition.setPosition(domainIndex, tmp);\n          self.domainPosition.shiftLeftBy(enteringDomainDim);\n          return tmp;\n      }\n    }\n\n    svg\n      .append('rect')\n      .attr('width', function (d) {\n        return w(d, true) - options.domainGutter - options.cellPadding;\n      })\n      .attr('height', function (d) {\n        return h(d, true) - options.domainGutter - options.cellPadding;\n      })\n      .attr('class', 'domain-background');\n\n    // =========================================================================//\n    // PAINTING SUBDOMAINS                            //\n    // =========================================================================//\n    var subDomainSvgGroup = svg\n      .append('svg')\n      .attr('x', function () {\n        if (options.label.position === 'left') {\n          return self.domainHorizontalLabelWidth + options.domainMargin[3];\n        } else {\n          return options.domainMargin[3];\n        }\n      })\n      .attr('y', function () {\n        if (options.label.position === 'top') {\n          return self.domainVerticalLabelHeight + options.domainMargin[0];\n        } else {\n          return options.domainMargin[0];\n        }\n      })\n      .attr('class', 'graph-subdomain-group');\n    var rect = subDomainSvgGroup\n      .selectAll('g')\n      .data(function (d) {\n        return self._domains.get(d);\n      })\n      .enter()\n      .append('g');\n    rect\n      .append('rect')\n      .attr('class', function (d) {\n        return (\n          'graph-rect' +\n          self.getHighlightClassName(d.t) +\n          (options.onClick !== null ? ' hover_cursor' : '')\n        );\n      })\n      .attr('width', options.cellSize)\n      .attr('height', options.cellSize)\n      .attr('x', function (d) {\n        return self.positionSubDomainX(d.t);\n      })\n      .attr('y', function (d) {\n        return self.positionSubDomainY(d.t);\n      })\n      .on('click', function (d) {\n        if (options.onClick !== null) {\n          return self.onClick(new Date(d.t), d.v);\n        }\n      })\n      .call(function (selection) {\n        if (options.cellRadius > 0) {\n          selection\n            .attr('rx', options.cellRadius)\n            .attr('ry', options.cellRadius);\n        }\n\n        if (\n          self.legendScale !== null &&\n          options.legendColors !== null &&\n          options.legendColors.hasOwnProperty('base')\n        ) {\n          selection.attr('fill', options.legendColors.base);\n        }\n\n        if (options.tooltip) {\n          selection\n            .on('mouseover', function (d) {\n              self.tip.show(d, this);\n            })\n            .on('mouseout', function () {\n              self.tip.hide(d);\n            });\n        }\n      });\n\n    // Appending a title to each subdomain\n    if (!options.tooltip) {\n      rect.append('title').text(function (d) {\n        return self.formatDate(new Date(d.t), options.subDomainDateFormat);\n      });\n    }\n\n    // =========================================================================//\n    // PAINTING LABEL                              //\n    // =========================================================================//\n    if (options.domainLabelFormat !== '') {\n      svg\n        .append('text')\n        .attr('class', 'graph-label')\n        .attr('y', function (d) {\n          var y = options.domainMargin[0];\n          switch (options.label.position) {\n            case 'top':\n              y += self.domainVerticalLabelHeight / 2;\n              break;\n            case 'bottom':\n              y += h(d) + self.domainVerticalLabelHeight / 2;\n          }\n\n          return (\n            y +\n            options.label.offset.y *\n              ((options.label.rotate === 'right' &&\n                options.label.position === 'right') ||\n              (options.label.rotate === 'left' &&\n                options.label.position === 'left')\n                ? -1\n                : 1)\n          );\n        })\n        .attr('x', function (d) {\n          var x = options.domainMargin[3];\n          switch (options.label.position) {\n            case 'right':\n              x += w(d);\n              break;\n            case 'bottom':\n            case 'top':\n              x += w(d) / 2;\n          }\n\n          if (options.label.align === 'right') {\n            return (\n              x +\n              self.domainHorizontalLabelWidth -\n              options.label.offset.x *\n                (options.label.rotate === 'right' ? -1 : 1)\n            );\n          }\n          return x + options.label.offset.x;\n        })\n        .attr('text-anchor', function () {\n          switch (options.label.align) {\n            case 'start':\n            case 'left':\n              return 'start';\n            case 'end':\n            case 'right':\n              return 'end';\n            default:\n              return 'middle';\n          }\n        })\n        .attr('dominant-baseline', function () {\n          return self.verticalDomainLabel ? 'middle' : 'top';\n        })\n        .text(function (d) {\n          return self.formatDate(new Date(d), options.domainLabelFormat);\n        })\n        .call(domainRotate);\n    }\n\n    function domainRotate(selection) {\n      switch (options.label.rotate) {\n        case 'right':\n          selection.attr('transform', function (d) {\n            var s = 'rotate(90), ';\n            switch (options.label.position) {\n              case 'right':\n                s += 'translate(-' + w(d) + ' , -' + w(d) + ')';\n                break;\n              case 'left':\n                s += 'translate(0, -' + self.domainHorizontalLabelWidth + ')';\n                break;\n            }\n\n            return s;\n          });\n          break;\n        case 'left':\n          selection.attr('transform', function (d) {\n            var s = 'rotate(270), ';\n            switch (options.label.position) {\n              case 'right':\n                s +=\n                  'translate(-' +\n                  (w(d) + self.domainHorizontalLabelWidth) +\n                  ' , ' +\n                  w(d) +\n                  ')';\n                break;\n              case 'left':\n                s +=\n                  'translate(-' +\n                  self.domainHorizontalLabelWidth +\n                  ' , ' +\n                  self.domainHorizontalLabelWidth +\n                  ')';\n                break;\n            }\n\n            return s;\n          });\n          break;\n      }\n    }\n\n    // =========================================================================//\n    // PAINTING DOMAIN SUBDOMAIN CONTENT                    //\n    // =========================================================================//\n    if (options.subDomainTextFormat !== null) {\n      rect\n        .append('text')\n        .attr('class', function (d) {\n          return 'subdomain-text' + self.getHighlightClassName(d.t);\n        })\n        .attr('x', function (d) {\n          return self.positionSubDomainX(d.t) + options.cellSize / 2;\n        })\n        .attr('y', function (d) {\n          return self.positionSubDomainY(d.t) + options.cellSize / 2;\n        })\n        .attr('text-anchor', 'middle')\n        .attr('dominant-baseline', 'central')\n        .text(function (d) {\n          return self.formatDate(new Date(d.t), options.subDomainTextFormat);\n        });\n    }\n\n    // =========================================================================//\n    // ANIMATION                                //\n    // =========================================================================//\n\n    if (navigationDir !== false) {\n      domainSvg\n        .transition()\n        .duration(options.animationDuration)\n        .attr('x', function (d) {\n          return options.verticalOrientation\n            ? 0\n            : self.domainPosition.getPosition(d);\n        })\n        .attr('y', function (d) {\n          return options.verticalOrientation\n            ? self.domainPosition.getPosition(d)\n            : 0;\n        });\n    }\n\n    var tempWidth = self.graphDim.width;\n    var tempHeight = self.graphDim.height;\n\n    if (options.verticalOrientation) {\n      self.graphDim.height += enteringDomainDim - exitingDomainDim;\n    } else {\n      self.graphDim.width += enteringDomainDim - exitingDomainDim;\n    }\n\n    // At the time of exit, domainsWidth and domainsHeight already automatically shifted\n    domainSvg\n      .exit()\n      .transition()\n      .duration(options.animationDuration)\n      .attr('x', function (d) {\n        if (options.verticalOrientation) {\n          return 0;\n        } else {\n          switch (navigationDir) {\n            case self.NAVIGATE_LEFT:\n              return Math.min(self.graphDim.width, tempWidth);\n            case self.NAVIGATE_RIGHT:\n              return -w(d, true);\n          }\n        }\n      })\n      .attr('y', function (d) {\n        if (options.verticalOrientation) {\n          switch (navigationDir) {\n            case self.NAVIGATE_LEFT:\n              return Math.min(self.graphDim.height, tempHeight);\n            case self.NAVIGATE_RIGHT:\n              return -h(d, true);\n          }\n        } else {\n          return 0;\n        }\n      })\n      .remove();\n\n    // Resize the root container\n    self.resize();\n  };\n};\n\nCalHeatMap.prototype = {\n  /**\n   * Validate and merge user settings with default settings\n   *\n   * @param  {object} settings User settings\n   * @return {bool} False if settings contains error\n   */\n  /* jshint maxstatements:false */\n  init: function (settings) {\n    'use strict';\n\n    var parent = this;\n\n    var options = (parent.options = mergeRecursive(parent.options, settings));\n\n    // Fatal errors\n    // Stop script execution on error\n    validateDomainType();\n    validateSelector(options.itemSelector, false, 'itemSelector');\n\n    if (parent.allowedDataType.indexOf(options.dataType) === -1) {\n      throw new Error(\n        \"The data type '\" + options.dataType + \"' is not valid data type\",\n      );\n    }\n\n    if (d3.select(options.itemSelector)[0][0] === null) {\n      throw new Error(\n        \"The node '\" +\n          options.itemSelector +\n          \"' specified in itemSelector does not exists\",\n      );\n    }\n\n    try {\n      validateSelector(options.nextSelector, true, 'nextSelector');\n      validateSelector(options.previousSelector, true, 'previousSelector');\n    } catch (error) {\n      console.log(error.message);\n      return false;\n    }\n\n    // If other settings contains error, will fallback to default\n\n    if (!settings.hasOwnProperty('subDomain')) {\n      this.options.subDomain = getOptimalSubDomain(settings.domain);\n    }\n\n    if (\n      typeof options.itemNamespace !== 'string' ||\n      options.itemNamespace === ''\n    ) {\n      console.log(\n        'itemNamespace can not be empty, falling back to cal-heatmap',\n      );\n      options.itemNamespace = 'cal-heatmap';\n    }\n\n    // Don't touch these settings\n    var s = [\n      'data',\n      'onComplete',\n      'onClick',\n      'afterLoad',\n      'afterLoadData',\n      'afterLoadPreviousDomain',\n      'afterLoadNextDomain',\n      'afterUpdate',\n    ];\n\n    for (var k in s) {\n      if (settings.hasOwnProperty(s[k])) {\n        options[s[k]] = settings[s[k]];\n      }\n    }\n\n    options.subDomainDateFormat =\n      typeof options.subDomainDateFormat === 'string' ||\n      typeof options.subDomainDateFormat === 'function'\n        ? options.subDomainDateFormat\n        : this._domainType[options.subDomain].format.date;\n    options.domainLabelFormat =\n      typeof options.domainLabelFormat === 'string' ||\n      typeof options.domainLabelFormat === 'function'\n        ? options.domainLabelFormat\n        : this._domainType[options.domain].format.legend;\n    options.subDomainTextFormat =\n      (typeof options.subDomainTextFormat === 'string' &&\n        options.subDomainTextFormat !== '') ||\n      typeof options.subDomainTextFormat === 'function'\n        ? options.subDomainTextFormat\n        : null;\n    options.domainMargin = expandMarginSetting(options.domainMargin);\n    options.legendMargin = expandMarginSetting(options.legendMargin);\n    options.highlight = parent.expandDateSetting(options.highlight);\n    options.itemName = expandItemName(options.itemName);\n    options.colLimit = parseColLimit(options.colLimit);\n    options.rowLimit = parseRowLimit(options.rowLimit);\n    if (!settings.hasOwnProperty('legendMargin')) {\n      autoAddLegendMargin();\n    }\n    autoAlignLabel();\n\n    /**\n     * Validate that a queryString is valid\n     *\n     * @param  {Element|string|bool} selector   The queryString to test\n     * @param  {bool}  canBeFalse  Whether false is an accepted and valid value\n     * @param  {string} name    Name of the tested selector\n     * @throws {Error}        If the selector is not valid\n     * @return {bool}        True if the selector is a valid queryString\n     */\n    function validateSelector(selector, canBeFalse, name) {\n      if (\n        ((canBeFalse && selector === false) ||\n          selector instanceof Element ||\n          typeof selector === 'string') &&\n        selector !== ''\n      ) {\n        return true;\n      }\n      throw new Error('The ' + name + ' is not valid');\n    }\n\n    /**\n     * Return the optimal subDomain for the specified domain\n     *\n     * @param  {string} domain a domain name\n     * @return {string}        the subDomain name\n     */\n    function getOptimalSubDomain(domain) {\n      switch (domain) {\n        case 'year':\n          return 'month';\n        case 'month':\n          return 'day';\n        case 'week':\n          return 'day';\n        case 'day':\n          return 'hour';\n        default:\n          return 'min';\n      }\n    }\n\n    /**\n     * Ensure that the domain and subdomain are valid\n     *\n     * @throw {Error} when domain or subdomain are not valid\n     * @return {bool} True if domain and subdomain are valid and compatible\n     */\n    function validateDomainType() {\n      if (\n        !parent._domainType.hasOwnProperty(options.domain) ||\n        options.domain === 'min' ||\n        options.domain.substring(0, 2) === 'x_'\n      ) {\n        throw new Error(\"The domain '\" + options.domain + \"' is not valid\");\n      }\n\n      if (\n        !parent._domainType.hasOwnProperty(options.subDomain) ||\n        options.subDomain === 'year'\n      ) {\n        throw new Error(\n          \"The subDomain '\" + options.subDomain + \"' is not valid\",\n        );\n      }\n\n      if (\n        parent._domainType[options.domain].level <=\n        parent._domainType[options.subDomain].level\n      ) {\n        throw new Error(\n          \"'\" +\n            options.subDomain +\n            \"' is not a valid subDomain to '\" +\n            options.domain +\n            \"'\",\n        );\n      }\n\n      return true;\n    }\n\n    /**\n     * Fine-tune the label alignement depending on its position\n     *\n     * @return void\n     */\n    function autoAlignLabel() {\n      // Auto-align label, depending on it's position\n      if (\n        !settings.hasOwnProperty('label') ||\n        (settings.hasOwnProperty('label') &&\n          !settings.label.hasOwnProperty('align'))\n      ) {\n        switch (options.label.position) {\n          case 'left':\n            options.label.align = 'right';\n            break;\n          case 'right':\n            options.label.align = 'left';\n            break;\n          default:\n            options.label.align = 'center';\n        }\n\n        if (options.label.rotate === 'left') {\n          options.label.align = 'right';\n        } else if (options.label.rotate === 'right') {\n          options.label.align = 'left';\n        }\n      }\n\n      if (\n        !settings.hasOwnProperty('label') ||\n        (settings.hasOwnProperty('label') &&\n          !settings.label.hasOwnProperty('offset'))\n      ) {\n        if (\n          options.label.position === 'left' ||\n          options.label.position === 'right'\n        ) {\n          options.label.offset = {\n            x: 10,\n            y: 15,\n          };\n        }\n      }\n    }\n\n    /**\n     * If not specified, add some margin around the legend depending on its position\n     *\n     * @return void\n     */\n    function autoAddLegendMargin() {\n      switch (options.legendVerticalPosition) {\n        case 'top':\n          options.legendMargin[2] = parent.DEFAULT_LEGEND_MARGIN;\n          break;\n        case 'bottom':\n          options.legendMargin[0] = parent.DEFAULT_LEGEND_MARGIN;\n          break;\n        case 'middle':\n        case 'center':\n          options.legendMargin[\n            options.legendHorizontalPosition === 'right' ? 3 : 1\n          ] = parent.DEFAULT_LEGEND_MARGIN;\n      }\n    }\n\n    /**\n     * Expand a number of an array of numbers to an usable 4 values array\n     *\n     * @param  {integer|array} value\n     * @return {array}        array\n     */\n    function expandMarginSetting(value) {\n      if (typeof value === 'number') {\n        value = [value];\n      }\n\n      if (!Array.isArray(value)) {\n        console.log('Margin only takes an integer or an array of integers');\n        value = [0];\n      }\n\n      switch (value.length) {\n        case 1:\n          return [value[0], value[0], value[0], value[0]];\n        case 2:\n          return [value[0], value[1], value[0], value[1]];\n        case 3:\n          return [value[0], value[1], value[2], value[1]];\n        case 4:\n          return value;\n        default:\n          return value.slice(0, 4);\n      }\n    }\n\n    /**\n     * Convert a string to an array like [singular-form, plural-form]\n     *\n     * @param  {string|array} value Date to convert\n     * @return {array}       An array like [singular-form, plural-form]\n     */\n    function expandItemName(value) {\n      if (typeof value === 'string') {\n        return [value, value + (value !== '' ? 's' : '')];\n      }\n\n      if (Array.isArray(value)) {\n        if (value.length === 1) {\n          return [value[0], value[0] + 's'];\n        } else if (value.length > 2) {\n          return value.slice(0, 2);\n        }\n\n        return value;\n      }\n\n      return ['item', 'items'];\n    }\n\n    function parseColLimit(value) {\n      return value > 0 ? value : null;\n    }\n\n    function parseRowLimit(value) {\n      if (value > 0 && options.colLimit > 0) {\n        console.log(\n          'colLimit and rowLimit are mutually exclusive, rowLimit will be ignored',\n        );\n        return null;\n      }\n      return value > 0 ? value : null;\n    }\n\n    return this._init();\n  },\n\n  /**\n   * Convert a keyword or an array of keyword/date to an array of date objects\n   *\n   * @param  {string|array|Date} value Data to convert\n   * @return {array}       An array of Dates\n   */\n  expandDateSetting: function (value) {\n    'use strict';\n\n    if (!Array.isArray(value)) {\n      value = [value];\n    }\n\n    return value\n      .map(function (data) {\n        if (data === 'now') {\n          return new Date();\n        }\n        if (data instanceof Date) {\n          return data;\n        }\n        return false;\n      })\n      .filter(function (d) {\n        return d !== false;\n      });\n  },\n\n  /**\n   * Fill the calendar by coloring the cells\n   *\n   * @param array svg An array of html node to apply the transformation to (optional)\n   *                  It's used to limit the painting to only a subset of the calendar\n   * @return void\n   */\n  fill: function (svg) {\n    'use strict';\n\n    var parent = this;\n    var options = parent.options;\n\n    if (arguments.length === 0) {\n      svg = parent.root.selectAll('.graph-domain');\n    }\n\n    var rect = svg\n      .selectAll('svg')\n      .selectAll('g')\n      .data(function (d) {\n        return parent._domains.get(d);\n      });\n    /**\n     * Colorize the cell via a style attribute if enabled\n     */\n    function addStyle(element) {\n      if (parent.legendScale === null) {\n        return false;\n      }\n\n      element.attr('fill', function (d) {\n        if (\n          d.v === null &&\n          options.hasOwnProperty('considerMissingDataAsZero') &&\n          !options.considerMissingDataAsZero\n        ) {\n          if (options.legendColors.hasOwnProperty('base')) {\n            return options.legendColors.base;\n          }\n        }\n\n        if (\n          options.legendColors !== null &&\n          options.legendColors.hasOwnProperty('empty') &&\n          (d.v === 0 ||\n            (d.v === null &&\n              options.hasOwnProperty('considerMissingDataAsZero') &&\n              options.considerMissingDataAsZero))\n        ) {\n          return options.legendColors.empty;\n        }\n\n        if (\n          d.v < 0 &&\n          options.legend[0] > 0 &&\n          options.legendColors !== null &&\n          options.legendColors.hasOwnProperty('overflow')\n        ) {\n          return options.legendColors.overflow;\n        }\n\n        return parent.legendScale(\n          Math.min(d.v, options.legend[options.legend.length - 1]),\n        );\n      });\n    }\n\n    rect\n      .transition()\n      .duration(options.animationDuration)\n      .select('rect')\n      .attr('class', function (d) {\n        var htmlClass = parent.getHighlightClassName(d.t).trim().split(' ');\n        var pastDate = parent.dateIsLessThan(d.t, new Date());\n        var sameDate = parent.dateIsEqual(d.t, new Date());\n\n        if (\n          parent.legendScale === null ||\n          (d.v === null &&\n            options.hasOwnProperty('considerMissingDataAsZero') &&\n            !options.considerMissingDataAsZero &&\n            !options.legendColors.hasOwnProperty('base'))\n        ) {\n          htmlClass.push('graph-rect');\n        }\n\n        if (sameDate) {\n          htmlClass.push('now');\n        } else if (!pastDate) {\n          htmlClass.push('future');\n        }\n\n        if (d.v !== null) {\n          htmlClass.push(\n            parent.Legend.getClass(d.v, parent.legendScale === null),\n          );\n        } else if (options.considerMissingDataAsZero && pastDate) {\n          htmlClass.push(\n            parent.Legend.getClass(0, parent.legendScale === null),\n          );\n        }\n\n        if (options.onClick !== null) {\n          htmlClass.push('hover_cursor');\n        }\n\n        return htmlClass.join(' ');\n      })\n      .call(addStyle);\n\n    rect\n      .transition()\n      .duration(options.animationDuration)\n      .select('title')\n      .text(function (d) {\n        return parent.getSubDomainTitle(d);\n      });\n\n    function formatSubDomainText(element) {\n      if (typeof options.subDomainTextFormat === 'function') {\n        element.text(function (d) {\n          return options.subDomainTextFormat(d.t, d.v);\n        });\n      }\n    }\n\n    /**\n     * Change the subDomainText class if necessary\n     * Also change the text, e.g when text is representing the value\n     * instead of the date\n     */\n    rect\n      .transition()\n      .duration(options.animationDuration)\n      .select('text')\n      .attr('class', function (d) {\n        return 'subdomain-text' + parent.getHighlightClassName(d.t);\n      })\n      .call(formatSubDomainText)\n      .attr('fill', d => {\n        if (!d.v) return '#000';\n        const rgb = parent.legendScale(\n          Math.min(d.v, options.legend[options.legend.length - 1]),\n        );\n        return getContrastingColor(rgb, 135);\n      });\n  },\n\n  /**\n   * Sprintf like function.\n   * Replaces placeholders {0} in string with values from provided object.\n   *\n   * @param string formatted String containing placeholders.\n   * @param object args Object with properties to replace placeholders in string.\n   *\n   * @return String\n   */\n  formatStringWithObject: function (formatted, args) {\n    'use strict';\n    for (var prop in args) {\n      if (args.hasOwnProperty(prop)) {\n        var regexp = new RegExp('\\\\{' + prop + '\\\\}', 'gi');\n        formatted = formatted.replace(regexp, args[prop]);\n      }\n    }\n    return formatted;\n  },\n\n  // =========================================================================//\n  // EVENTS CALLBACK                              //\n  // =========================================================================//\n\n  /**\n   * Helper method for triggering event callback\n   *\n   * @param  string  eventName       Name of the event to trigger\n   * @param  array  successArgs     List of argument to pass to the callback\n   * @param  boolean  skip      Whether to skip the event triggering\n   * @return mixed  True when the triggering was skipped, false on error, else the callback function\n   */\n  triggerEvent: function (eventName, successArgs, skip) {\n    'use strict';\n\n    if ((arguments.length === 3 && skip) || this.options[eventName] === null) {\n      return true;\n    }\n\n    if (typeof this.options[eventName] === 'function') {\n      if (typeof successArgs === 'function') {\n        successArgs = successArgs();\n      }\n      return this.options[eventName].apply(this, successArgs);\n    } else {\n      console.log('Provided callback for ' + eventName + ' is not a function.');\n      return false;\n    }\n  },\n\n  /**\n   * Event triggered on a mouse click on a subDomain cell\n   *\n   * @param  Date    d    Date of the subdomain block\n   * @param  int    itemNb  Number of items in that date\n   */\n  onClick: function (d, itemNb) {\n    'use strict';\n\n    return this.triggerEvent('onClick', [d, itemNb]);\n  },\n\n  /**\n   * Event triggered after drawing the calendar, byt before filling it with data\n   */\n  afterLoad: function () {\n    'use strict';\n\n    return this.triggerEvent('afterLoad');\n  },\n\n  /**\n   * Event triggered after completing drawing and filling the calendar\n   */\n  onComplete: function () {\n    'use strict';\n\n    var response = this.triggerEvent('onComplete', [], this._completed);\n    this._completed = true;\n    return response;\n  },\n\n  /**\n   * Event triggered after shifting the calendar one domain back\n   *\n   * @param  Date    start  Domain start date\n   * @param  Date    end    Domain end date\n   */\n  afterLoadPreviousDomain: function (start) {\n    'use strict';\n\n    var parent = this;\n    return this.triggerEvent('afterLoadPreviousDomain', function () {\n      var subDomain = parent.getSubDomain(start);\n      return [subDomain.shift(), subDomain.pop()];\n    });\n  },\n\n  /**\n   * Event triggered after shifting the calendar one domain above\n   *\n   * @param  Date    start  Domain start date\n   * @param  Date    end    Domain end date\n   */\n  afterLoadNextDomain: function (start) {\n    'use strict';\n\n    var parent = this;\n    return this.triggerEvent('afterLoadNextDomain', function () {\n      var subDomain = parent.getSubDomain(start);\n      return [subDomain.shift(), subDomain.pop()];\n    });\n  },\n\n  /**\n   * Event triggered after loading the leftmost domain allowed by minDate\n   *\n   * @param  boolean  reached True if the leftmost domain was reached\n   */\n  onMinDomainReached: function (reached) {\n    'use strict';\n\n    this._minDomainReached = reached;\n    return this.triggerEvent('onMinDomainReached', [reached]);\n  },\n\n  /**\n   * Event triggered after loading the rightmost domain allowed by maxDate\n   *\n   * @param  boolean  reached True if the rightmost domain was reached\n   */\n  onMaxDomainReached: function (reached) {\n    'use strict';\n\n    this._maxDomainReached = reached;\n    return this.triggerEvent('onMaxDomainReached', [reached]);\n  },\n\n  checkIfMinDomainIsReached: function (date, upperBound) {\n    'use strict';\n\n    if (this.minDomainIsReached(date)) {\n      this.onMinDomainReached(true);\n    }\n\n    if (arguments.length === 2) {\n      if (this._maxDomainReached && !this.maxDomainIsReached(upperBound)) {\n        this.onMaxDomainReached(false);\n      }\n    }\n  },\n\n  checkIfMaxDomainIsReached: function (date, lowerBound) {\n    'use strict';\n\n    if (this.maxDomainIsReached(date)) {\n      this.onMaxDomainReached(true);\n    }\n\n    if (arguments.length === 2) {\n      if (this._minDomainReached && !this.minDomainIsReached(lowerBound)) {\n        this.onMinDomainReached(false);\n      }\n    }\n  },\n\n  afterUpdate: function () {\n    'use strict';\n\n    return this.triggerEvent('afterUpdate');\n  },\n\n  // =========================================================================//\n  // FORMATTER                                //\n  // =========================================================================//\n\n  formatNumber: d3.format(',g'),\n\n  formatDate: function (d, format) {\n    'use strict';\n\n    if (arguments.length < 2) {\n      format = 'title';\n    }\n\n    if (typeof format === 'function') {\n      return format(d);\n    } else {\n      var f = d3.time.format(format);\n      return f(d);\n    }\n  },\n\n  getSubDomainTitle: function (d) {\n    'use strict';\n\n    if (d.v === null && !this.options.considerMissingDataAsZero) {\n      return this.formatStringWithObject(\n        this.options.subDomainTitleFormat.empty,\n        {\n          date: this.formatDate(\n            new Date(d.t),\n            this.options.subDomainDateFormat,\n          ),\n        },\n      );\n    } else {\n      var value = d.v;\n      // Consider null as 0\n      if (value === null && this.options.considerMissingDataAsZero) {\n        value = 0;\n      }\n\n      return this.formatStringWithObject(\n        this.options.subDomainTitleFormat.filled,\n        {\n          count: this.formatNumber(value),\n          name: this.options.itemName[value !== 1 ? 1 : 0],\n          connector: this._domainType[this.options.subDomain].format.connector,\n          date: this.formatDate(\n            new Date(d.t),\n            this.options.subDomainDateFormat,\n          ),\n        },\n      );\n    }\n  },\n\n  // =========================================================================//\n  // DOMAIN NAVIGATION                            //\n  // =========================================================================//\n\n  /**\n   * Shift the calendar one domain forward\n   *\n   * The new domain is loaded only if it's not beyond maxDate\n   *\n   * @param int n Number of domains to load\n   * @return bool True if the next domain was loaded, else false\n   */\n  loadNextDomain: function (n) {\n    'use strict';\n\n    if (this._maxDomainReached || n === 0) {\n      return false;\n    }\n\n    var bound = this.loadNewDomains(\n      this.NAVIGATE_RIGHT,\n      this.getDomain(this.getNextDomain(), n),\n    );\n\n    this.afterLoadNextDomain(bound.end);\n    this.checkIfMaxDomainIsReached(this.getNextDomain().getTime(), bound.start);\n\n    return true;\n  },\n\n  /**\n   * Shift the calendar one domain backward\n   *\n   * The previous domain is loaded only if it's not beyond the minDate\n   *\n   * @param int n Number of domains to load\n   * @return bool True if the previous domain was loaded, else false\n   */\n  loadPreviousDomain: function (n) {\n    'use strict';\n\n    if (this._minDomainReached || n === 0) {\n      return false;\n    }\n\n    var bound = this.loadNewDomains(\n      this.NAVIGATE_LEFT,\n      this.getDomain(this.getDomainKeys()[0], -n).reverse(),\n    );\n\n    this.afterLoadPreviousDomain(bound.start);\n    this.checkIfMinDomainIsReached(bound.start, bound.end);\n\n    return true;\n  },\n\n  loadNewDomains: function (direction, newDomains) {\n    'use strict';\n\n    var parent = this;\n    var backward = direction === this.NAVIGATE_LEFT;\n    var i = -1;\n    var total = newDomains.length;\n    var domains = this.getDomainKeys();\n\n    function buildSubDomain(d) {\n      return {\n        t: parent._domainType[parent.options.subDomain].extractUnit(d),\n        v: null,\n      };\n    }\n\n    // Remove out of bound domains from list of new domains to prepend\n    while (++i < total) {\n      if (backward && this.minDomainIsReached(newDomains[i])) {\n        newDomains = newDomains.slice(0, i + 1);\n        break;\n      }\n      if (!backward && this.maxDomainIsReached(newDomains[i])) {\n        newDomains = newDomains.slice(0, i);\n        break;\n      }\n    }\n\n    newDomains = newDomains.slice(-this.options.range);\n\n    for (i = 0, total = newDomains.length; i < total; i += 1) {\n      this._domains.set(\n        newDomains[i].getTime(),\n        this.getSubDomain(newDomains[i]).map(buildSubDomain),\n      );\n\n      this._domains.remove(backward ? domains.pop() : domains.shift());\n    }\n\n    domains = this.getDomainKeys();\n\n    if (backward) {\n      newDomains = newDomains.reverse();\n    }\n\n    this.paint(direction);\n\n    this.getDatas(\n      this.options.data,\n      newDomains[0],\n      this.getSubDomain(newDomains[newDomains.length - 1]).pop(),\n      function () {\n        parent.fill(parent.lastInsertedSvg);\n      },\n    );\n\n    return {\n      start: newDomains[backward ? 0 : 1],\n      end: domains[domains.length - 1],\n    };\n  },\n\n  /**\n   * Return whether a date is inside the scope determined by maxDate\n   *\n   * @param int datetimestamp The timestamp in ms to test\n   * @return bool True if the specified date correspond to the calendar upper bound\n   */\n  maxDomainIsReached: function (datetimestamp) {\n    'use strict';\n\n    return (\n      this.options.maxDate !== null &&\n      this.options.maxDate.getTime() < datetimestamp\n    );\n  },\n\n  /**\n   * Return whether a date is inside the scope determined by minDate\n   *\n   * @param int datetimestamp The timestamp in ms to test\n   * @return bool True if the specified date correspond to the calendar lower bound\n   */\n  minDomainIsReached: function (datetimestamp) {\n    'use strict';\n\n    return (\n      this.options.minDate !== null &&\n      this.options.minDate.getTime() >= datetimestamp\n    );\n  },\n\n  /**\n   * Return the list of the calendar's domain timestamp\n   *\n   * @return Array a sorted array of timestamp\n   */\n  getDomainKeys: function () {\n    'use strict';\n\n    return this._domains\n      .keys()\n      .map(function (d) {\n        return parseInt(d, 10);\n      })\n      .sort(function (a, b) {\n        return a - b;\n      });\n  },\n\n  // =========================================================================//\n  // POSITIONNING                                //\n  // =========================================================================//\n\n  positionSubDomainX: function (d) {\n    'use strict';\n\n    var index = this._domainType[this.options.subDomain].position.x(\n      new Date(d),\n    );\n    return index * this.options.cellSize + index * this.options.cellPadding;\n  },\n\n  positionSubDomainY: function (d) {\n    'use strict';\n\n    var index = this._domainType[this.options.subDomain].position.y(\n      new Date(d),\n    );\n    return index * this.options.cellSize + index * this.options.cellPadding;\n  },\n\n  getSubDomainColumnNumber: function (d) {\n    'use strict';\n\n    if (this.options.rowLimit > 0) {\n      var i = this._domainType[this.options.subDomain].maxItemNumber;\n      if (typeof i === 'function') {\n        i = i(d);\n      }\n      return Math.ceil(i / this.options.rowLimit);\n    }\n\n    var j = this._domainType[this.options.subDomain].defaultColumnNumber;\n    if (typeof j === 'function') {\n      j = j(d);\n    }\n    return this.options.colLimit || j;\n  },\n\n  getSubDomainRowNumber: function (d) {\n    'use strict';\n\n    if (this.options.colLimit > 0) {\n      var i = this._domainType[this.options.subDomain].maxItemNumber;\n      if (typeof i === 'function') {\n        i = i(d);\n      }\n      return Math.ceil(i / this.options.colLimit);\n    }\n\n    var j = this._domainType[this.options.subDomain].defaultRowNumber;\n    if (typeof j === 'function') {\n      j = j(d);\n    }\n    return this.options.rowLimit || j;\n  },\n\n  /**\n   * Return a classname if the specified date should be highlighted\n   *\n   * @param  timestamp date Date of the current subDomain\n   * @return String the highlight class\n   */\n  getHighlightClassName: function (d) {\n    'use strict';\n\n    d = new Date(d);\n\n    if (this.options.highlight.length > 0) {\n      for (var i in this.options.highlight) {\n        if (this.dateIsEqual(this.options.highlight[i], d)) {\n          return this.isNow(this.options.highlight[i])\n            ? ' highlight-now'\n            : ' highlight';\n        }\n      }\n    }\n    return '';\n  },\n\n  /**\n   * Return whether the specified date is now,\n   * according to the type of subdomain\n   *\n   * @param  Date d The date to compare\n   * @return bool True if the date correspond to a subdomain cell\n   */\n  isNow: function (d) {\n    'use strict';\n\n    return this.dateIsEqual(d, new Date());\n  },\n\n  /**\n   * Return whether 2 dates are equals\n   * This function is subdomain-aware,\n   * and dates comparison are dependent of the subdomain\n   *\n   * @param  Date dateA First date to compare\n   * @param  Date dateB Secon date to compare\n   * @return bool true if the 2 dates are equals\n   */\n  /* jshint maxcomplexity: false */\n  dateIsEqual: function (dateA, dateB) {\n    'use strict';\n\n    if (!(dateA instanceof Date)) {\n      dateA = new Date(dateA);\n    }\n\n    if (!(dateB instanceof Date)) {\n      dateB = new Date(dateB);\n    }\n\n    switch (this.options.subDomain) {\n      case 'x_min':\n      case 'min':\n        return (\n          dateA.getFullYear() === dateB.getFullYear() &&\n          dateA.getMonth() === dateB.getMonth() &&\n          dateA.getDate() === dateB.getDate() &&\n          dateA.getHours() === dateB.getHours() &&\n          dateA.getMinutes() === dateB.getMinutes()\n        );\n      case 'x_hour':\n      case 'hour':\n        return (\n          dateA.getFullYear() === dateB.getFullYear() &&\n          dateA.getMonth() === dateB.getMonth() &&\n          dateA.getDate() === dateB.getDate() &&\n          dateA.getHours() === dateB.getHours()\n        );\n      case 'x_day':\n      case 'day':\n        return (\n          dateA.getFullYear() === dateB.getFullYear() &&\n          dateA.getMonth() === dateB.getMonth() &&\n          dateA.getDate() === dateB.getDate()\n        );\n      case 'x_week':\n      case 'week':\n        return (\n          dateA.getFullYear() === dateB.getFullYear() &&\n          this.getWeekNumber(dateA) === this.getWeekNumber(dateB)\n        );\n      case 'x_month':\n      case 'month':\n        return (\n          dateA.getFullYear() === dateB.getFullYear() &&\n          dateA.getMonth() === dateB.getMonth()\n        );\n      default:\n        return false;\n    }\n  },\n\n  /**\n   * Returns wether or not dateA is less than or equal to dateB. This function is subdomain aware.\n   * Performs automatic conversion of values.\n   * @param dateA may be a number or a Date\n   * @param dateB may be a number or a Date\n   * @returns {boolean}\n   */\n  dateIsLessThan: function (dateA, dateB) {\n    'use strict';\n\n    if (!(dateA instanceof Date)) {\n      dateA = new Date(dateA);\n    }\n\n    if (!(dateB instanceof Date)) {\n      dateB = new Date(dateB);\n    }\n\n    function normalizedMillis(date, subdomain) {\n      switch (subdomain) {\n        case 'x_min':\n        case 'min':\n          return new Date(\n            date.getFullYear(),\n            date.getMonth(),\n            date.getDate(),\n            date.getHours(),\n            date.getMinutes(),\n          ).getTime();\n        case 'x_hour':\n        case 'hour':\n          return new Date(\n            date.getFullYear(),\n            date.getMonth(),\n            date.getDate(),\n            date.getHours(),\n          ).getTime();\n        case 'x_day':\n        case 'day':\n          return new Date(\n            date.getFullYear(),\n            date.getMonth(),\n            date.getDate(),\n          ).getTime();\n        case 'x_week':\n        case 'week':\n        case 'x_month':\n        case 'month':\n          return new Date(date.getFullYear(), date.getMonth()).getTime();\n        default:\n          return date.getTime();\n      }\n    }\n\n    return (\n      normalizedMillis(dateA, this.options.subDomain) <\n      normalizedMillis(dateB, this.options.subDomain)\n    );\n  },\n\n  // =========================================================================//\n  // DATE COMPUTATION                              //\n  // =========================================================================//\n\n  /**\n   * Return the day of the year for the date\n   * @param  Date\n   * @return  int Day of the year [1,366]\n   */\n  getDayOfYear: d3.time.format('%j'),\n\n  /**\n   * Return the week number of the year\n   * Monday as the first day of the week\n   * @return int  Week number [0-53]\n   */\n  getWeekNumber: function (d) {\n    'use strict';\n\n    var f =\n      this.options.weekStartOnMonday === true\n        ? d3.time.format('%W')\n        : d3.time.format('%U');\n    return f(d);\n  },\n\n  /**\n   * Return the week number, relative to its month\n   *\n   * @param  int|Date d Date or timestamp in milliseconds\n   * @return int Week number, relative to the month [0-5]\n   */\n  getMonthWeekNumber: function (d) {\n    'use strict';\n\n    if (typeof d === 'number') {\n      d = new Date(d);\n    }\n\n    var monthFirstWeekNumber = this.getWeekNumber(\n      new Date(d.getFullYear(), d.getMonth()),\n    );\n    return this.getWeekNumber(d) - monthFirstWeekNumber - 1;\n  },\n\n  /**\n   * Return the number of weeks in the dates' year\n   *\n   * @param  int|Date d Date or timestamp in milliseconds\n   * @return int Number of weeks in the date's year\n   */\n  getWeekNumberInYear: function (d) {\n    'use strict';\n\n    if (typeof d === 'number') {\n      d = new Date(d);\n    }\n  },\n\n  /**\n   * Return the number of days in the date's month\n   *\n   * @param  int|Date d Date or timestamp in milliseconds\n   * @return int Number of days in the date's month\n   */\n  getDayCountInMonth: function (d) {\n    'use strict';\n\n    return this.getEndOfMonth(d).getDate();\n  },\n\n  /**\n   * Return the number of days in the date's year\n   *\n   * @param  int|Date d Date or timestamp in milliseconds\n   * @return int Number of days in the date's year\n   */\n  getDayCountInYear: function (d) {\n    'use strict';\n\n    if (typeof d === 'number') {\n      d = new Date(d);\n    }\n    return new Date(d.getFullYear(), 1, 29).getMonth() === 1 ? 366 : 365;\n  },\n\n  /**\n   * Get the weekday from a date\n   *\n   * Return the week day number (0-6) of a date,\n   * depending on whether the week start on monday or sunday\n   *\n   * @param  Date d\n   * @return int The week day number (0-6)\n   */\n  getWeekDay: function (d) {\n    'use strict';\n\n    if (this.options.weekStartOnMonday === false) {\n      return d.getDay();\n    }\n    return d.getDay() === 0 ? 6 : d.getDay() - 1;\n  },\n\n  /**\n   * Get the last day of the month\n   * @param  Date|int  d  Date or timestamp in milliseconds\n   * @return Date      Last day of the month\n   */\n  getEndOfMonth: function (d) {\n    'use strict';\n\n    if (typeof d === 'number') {\n      d = new Date(d);\n    }\n    return new Date(d.getFullYear(), d.getMonth() + 1, 0);\n  },\n\n  /**\n   *\n   * @param  Date date\n   * @param  int count\n   * @param  string step\n   * @return Date\n   */\n  jumpDate: function (date, count, step) {\n    'use strict';\n\n    var d = new Date(date);\n    switch (step) {\n      case 'hour':\n        d.setHours(d.getHours() + count);\n        break;\n      case 'day':\n        d.setHours(d.getHours() + count * 24);\n        break;\n      case 'week':\n        d.setHours(d.getHours() + count * 24 * 7);\n        break;\n      case 'month':\n        d.setMonth(d.getMonth() + count);\n        break;\n      case 'year':\n        d.setFullYear(d.getFullYear() + count);\n    }\n\n    return new Date(d);\n  },\n\n  // =========================================================================//\n  // DOMAIN COMPUTATION                            //\n  // =========================================================================//\n\n  /**\n   * Return all the minutes between 2 dates\n   *\n   * @param  Date  d  date  A date\n   * @param  int|date  range  Number of minutes in the range, or a stop date\n   * @return array  An array of minutes\n   */\n  getMinuteDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(\n      d.getFullYear(),\n      d.getMonth(),\n      d.getDate(),\n      d.getHours(),\n    );\n    var stop = null;\n    if (range instanceof Date) {\n      stop = new Date(\n        range.getFullYear(),\n        range.getMonth(),\n        range.getDate(),\n        range.getHours(),\n      );\n    } else {\n      stop = new Date(+start + range * 1000 * 60);\n    }\n    return d3.time.minutes(Math.min(start, stop), Math.max(start, stop));\n  },\n\n  /**\n   * Return all the hours between 2 dates\n   *\n   * @param  Date  d  A date\n   * @param  int|date  range  Number of hours in the range, or a stop date\n   * @return array  An array of hours\n   */\n  getHourDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(\n      d.getFullYear(),\n      d.getMonth(),\n      d.getDate(),\n      d.getHours(),\n    );\n    var stop = null;\n    if (range instanceof Date) {\n      stop = new Date(\n        range.getFullYear(),\n        range.getMonth(),\n        range.getDate(),\n        range.getHours(),\n      );\n    } else {\n      stop = new Date(start);\n      stop.setHours(stop.getHours() + range);\n    }\n\n    var domains = d3.time.hours(Math.min(start, stop), Math.max(start, stop));\n\n    // Passing from DST to standard time\n    // If there are 25 hours, let's compress the duplicate hours\n    var i = 0;\n    var total = domains.length;\n    for (i = 0; i < total; i += 1) {\n      if (i > 0 && domains[i].getHours() === domains[i - 1].getHours()) {\n        this.DSTDomain.push(domains[i].getTime());\n        domains.splice(i, 1);\n        break;\n      }\n    }\n\n    // d3.time.hours is returning more hours than needed when changing\n    // from DST to standard time, because there is really 2 hours between\n    // 1am and 2am!\n    if (typeof range === 'number' && domains.length > Math.abs(range)) {\n      domains.splice(domains.length - 1, 1);\n    }\n\n    return domains;\n  },\n\n  /**\n   * Return all the days between 2 dates\n   *\n   * @param  Date    d    A date\n   * @param  int|date  range  Number of days in the range, or a stop date\n   * @return array  An array of weeks\n   */\n  getDayDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(d.getFullYear(), d.getMonth(), d.getDate());\n    var stop = null;\n    if (range instanceof Date) {\n      stop = new Date(range.getFullYear(), range.getMonth(), range.getDate());\n    } else {\n      stop = new Date(start);\n      stop = new Date(stop.setDate(stop.getDate() + parseInt(range, 10)));\n    }\n\n    return d3.time.days(Math.min(start, stop), Math.max(start, stop));\n  },\n\n  /**\n   * Return all the weeks between 2 dates\n   *\n   * @param  Date  d  A date\n   * @param  int|date  range  Number of minutes in the range, or a stop date\n   * @return array  An array of weeks\n   */\n  getWeekDomain: function (d, range) {\n    'use strict';\n\n    var weekStart;\n\n    if (this.options.weekStartOnMonday === false) {\n      weekStart = new Date(\n        d.getFullYear(),\n        d.getMonth(),\n        d.getDate() - d.getDay(),\n      );\n    } else {\n      if (d.getDay() === 1) {\n        weekStart = new Date(d.getFullYear(), d.getMonth(), d.getDate());\n      } else if (d.getDay() === 0) {\n        weekStart = new Date(d.getFullYear(), d.getMonth(), d.getDate());\n        weekStart.setDate(weekStart.getDate() - 6);\n      } else {\n        weekStart = new Date(\n          d.getFullYear(),\n          d.getMonth(),\n          d.getDate() - d.getDay() + 1,\n        );\n      }\n    }\n\n    var endDate = new Date(weekStart);\n\n    var stop = range;\n    if (typeof range !== 'object') {\n      stop = new Date(endDate.setDate(endDate.getDate() + range * 7));\n    }\n\n    return this.options.weekStartOnMonday === true\n      ? d3.time.mondays(Math.min(weekStart, stop), Math.max(weekStart, stop))\n      : d3.time.sundays(Math.min(weekStart, stop), Math.max(weekStart, stop));\n  },\n\n  /**\n   * Return all the months between 2 dates\n   *\n   * @param  Date    d    A date\n   * @param  int|date  range  Number of months in the range, or a stop date\n   * @return array  An array of months\n   */\n  getMonthDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(d.getFullYear(), d.getMonth());\n    var stop = null;\n    if (range instanceof Date) {\n      stop = new Date(range.getFullYear(), range.getMonth());\n    } else {\n      stop = new Date(start);\n      stop = stop.setMonth(stop.getMonth() + range);\n    }\n\n    return d3.time.months(Math.min(start, stop), Math.max(start, stop));\n  },\n\n  /**\n   * Return all the years between 2 dates\n   *\n   * @param  Date  d  date  A date\n   * @param  int|date  range  Number of minutes in the range, or a stop date\n   * @return array  An array of hours\n   */\n  getYearDomain: function (d, range) {\n    'use strict';\n\n    var start = new Date(d.getFullYear(), 0);\n    var stop = null;\n    if (range instanceof Date) {\n      stop = new Date(range.getFullYear(), 0);\n    } else {\n      stop = new Date(d.getFullYear() + range, 0);\n    }\n\n    return d3.time.years(Math.min(start, stop), Math.max(start, stop));\n  },\n\n  /**\n   * Get an array of domain start dates\n   *\n   * @param  int|Date date A random date included in the wanted domain\n   * @param  int|Date range Number of dates to get, or a stop date\n   * @return Array of dates\n   */\n  getDomain: function (date, range) {\n    'use strict';\n\n    if (typeof date === 'number') {\n      date = new Date(date);\n    }\n\n    if (arguments.length < 2) {\n      range = this.options.range;\n    }\n\n    switch (this.options.domain) {\n      case 'hour':\n        var domains = this.getHourDomain(date, range);\n\n        // Case where an hour is missing, when passing from standard time to DST\n        // Missing hour is perfectly acceptabl in subDomain, but not in domains\n        if (typeof range === 'number' && domains.length < range) {\n          if (range > 0) {\n            domains.push(this.getHourDomain(domains[domains.length - 1], 2)[1]);\n          } else {\n            domains.shift(this.getHourDomain(domains[0], -2)[0]);\n          }\n        }\n        return domains;\n      case 'day':\n        return this.getDayDomain(date, range);\n      case 'week':\n        return this.getWeekDomain(date, range);\n      case 'month':\n        return this.getMonthDomain(date, range);\n      case 'year':\n        return this.getYearDomain(date, range);\n    }\n  },\n\n  /* jshint maxcomplexity: false */\n  getSubDomain: function (date) {\n    'use strict';\n\n    if (typeof date === 'number') {\n      date = new Date(date);\n    }\n\n    var parent = this;\n\n    /**\n     * @return int\n     */\n    var computeDaySubDomainSize = function (date, domain) {\n      switch (domain) {\n        case 'year':\n          return parent.getDayCountInYear(date);\n        case 'month':\n          return parent.getDayCountInMonth(date);\n        case 'week':\n          return 7;\n      }\n    };\n\n    /**\n     * @return int\n     */\n    var computeMinSubDomainSize = function (date, domain) {\n      switch (domain) {\n        case 'hour':\n          return 60;\n        case 'day':\n          return 60 * 24;\n        case 'week':\n          return 60 * 24 * 7;\n      }\n    };\n\n    /**\n     * @return int\n     */\n    var computeHourSubDomainSize = function (date, domain) {\n      switch (domain) {\n        case 'day':\n          return 24;\n        case 'week':\n          return 168;\n        case 'month':\n          return parent.getDayCountInMonth(date) * 24;\n      }\n    };\n\n    /**\n     * @return int\n     */\n    var computeWeekSubDomainSize = function (date, domain) {\n      if (domain === 'month') {\n        var endOfMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0);\n        var endWeekNb = parent.getWeekNumber(endOfMonth);\n        var startWeekNb = parent.getWeekNumber(\n          new Date(date.getFullYear(), date.getMonth()),\n        );\n\n        if (startWeekNb > endWeekNb) {\n          startWeekNb = 0;\n          endWeekNb += 1;\n        }\n\n        return endWeekNb - startWeekNb + 1;\n      } else if (domain === 'year') {\n        return parent.getWeekNumber(new Date(date.getFullYear(), 11, 31));\n      }\n    };\n\n    switch (this.options.subDomain) {\n      case 'x_min':\n      case 'min':\n        return this.getMinuteDomain(\n          date,\n          computeMinSubDomainSize(date, this.options.domain),\n        );\n      case 'x_hour':\n      case 'hour':\n        return this.getHourDomain(\n          date,\n          computeHourSubDomainSize(date, this.options.domain),\n        );\n      case 'x_day':\n      case 'day':\n        return this.getDayDomain(\n          date,\n          computeDaySubDomainSize(date, this.options.domain),\n        );\n      case 'x_week':\n      case 'week':\n        return this.getWeekDomain(\n          date,\n          computeWeekSubDomainSize(date, this.options.domain),\n        );\n      case 'x_month':\n      case 'month':\n        return this.getMonthDomain(date, 12);\n    }\n  },\n\n  /**\n   * Get the n-th next domain after the calendar newest (rightmost) domain\n   * @param  int n\n   * @return Date The start date of the wanted domain\n   */\n  getNextDomain: function (n) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      n = 1;\n    }\n    return this.getDomain(\n      this.jumpDate(this.getDomainKeys().pop(), n, this.options.domain),\n      1,\n    )[0];\n  },\n\n  /**\n   * Get the n-th domain before the calendar oldest (leftmost) domain\n   * @param  int n\n   * @return Date The start date of the wanted domain\n   */\n  getPreviousDomain: function (n) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      n = 1;\n    }\n    return this.getDomain(\n      this.jumpDate(this.getDomainKeys().shift(), -n, this.options.domain),\n      1,\n    )[0];\n  },\n\n  // =========================================================================//\n  // DATAS                                  //\n  // =========================================================================//\n\n  /**\n   * Fetch and interpret data from the datasource\n   *\n   * @param string|object source\n   * @param Date startDate\n   * @param Date endDate\n   * @param function callback\n   * @param function|boolean afterLoad function used to convert the data into a json object. Use true to use the afterLoad callback\n   * @param updateMode\n   *\n   * @return mixed\n   * - True if there are no data to load\n   * - False if data are loaded asynchronously\n   */\n  getDatas: function (\n    source,\n    startDate,\n    endDate,\n    callback,\n    afterLoad,\n    updateMode,\n  ) {\n    'use strict';\n\n    var self = this;\n    if (arguments.length < 5) {\n      afterLoad = true;\n    }\n    if (arguments.length < 6) {\n      updateMode = this.APPEND_ON_UPDATE;\n    }\n    var _callback = function (error, data) {\n      if (afterLoad !== false) {\n        if (typeof afterLoad === 'function') {\n          data = afterLoad(data);\n        } else if (typeof self.options.afterLoadData === 'function') {\n          data = self.options.afterLoadData(data);\n        } else {\n          console.log('Provided callback for afterLoadData is not a function.');\n        }\n      } else if (\n        self.options.dataType === 'csv' ||\n        self.options.dataType === 'tsv'\n      ) {\n        data = this.interpretCSV(data);\n      }\n      self.parseDatas(data, updateMode, startDate, endDate);\n      if (typeof callback === 'function') {\n        callback();\n      }\n    };\n\n    switch (typeof source) {\n      case 'string':\n        if (source === '') {\n          _callback(null, {});\n          return true;\n        } else {\n          var url = this.parseURI(source, startDate, endDate);\n          var requestType = 'GET';\n          if (self.options.dataPostPayload !== null) {\n            requestType = 'POST';\n          }\n          var payload = null;\n          if (self.options.dataPostPayload !== null) {\n            payload = this.parseURI(\n              self.options.dataPostPayload,\n              startDate,\n              endDate,\n            );\n          }\n\n          var xhr = null;\n          switch (this.options.dataType) {\n            case 'json':\n              xhr = d3.json(url);\n              break;\n            case 'csv':\n              xhr = d3.csv(url);\n              break;\n            case 'tsv':\n              xhr = d3.tsv(url);\n              break;\n            case 'txt':\n              xhr = d3.text(url, 'text/plain');\n              break;\n          }\n\n          // jshint maxdepth:5\n          if (self.options.dataRequestHeaders !== null) {\n            for (var header in self.options.dataRequestHeaders) {\n              if (self.options.dataRequestHeaders.hasOwnProperty(header)) {\n                xhr.header(header, self.options.dataRequestHeaders[header]);\n              }\n            }\n          }\n\n          xhr.send(requestType, payload, _callback);\n        }\n        return false;\n      case 'object':\n        if (source === Object(source)) {\n          _callback(null, source);\n          return false;\n        }\n      /* falls through */\n      default:\n        _callback(null, {});\n        return true;\n    }\n  },\n\n  /**\n   * Populate the calendar internal data\n   *\n   * @param object data\n   * @param constant updateMode\n   * @param Date startDate\n   * @param Date endDate\n   *\n   * @return void\n   */\n  parseDatas: function (data, updateMode, startDate, endDate) {\n    'use strict';\n\n    if (updateMode === this.RESET_ALL_ON_UPDATE) {\n      this._domains.forEach(function (key, value) {\n        value.forEach(function (element, index, array) {\n          array[index].v = null;\n        });\n      });\n    }\n\n    var temp = {};\n\n    var extractTime = function (d) {\n      return d.t;\n    };\n\n    /*jshint forin:false */\n    for (var d in data) {\n      var date = new Date(d * 1000);\n      var domainUnit = this.getDomain(date)[0].getTime();\n      // The current data belongs to a domain that was compressed\n      // Compress the data for the two duplicate hours into the same hour\n      if (this.DSTDomain.indexOf(domainUnit) >= 0) {\n        // Re-assign all data to the first or the second duplicate hours\n        // depending on which is visible\n        if (this._domains.has(domainUnit - 3600 * 1000)) {\n          domainUnit -= 3600 * 1000;\n        }\n      }\n\n      // Skip if data is not relevant to current domain\n      if (\n        isNaN(d) ||\n        !data.hasOwnProperty(d) ||\n        !this._domains.has(domainUnit) ||\n        !(domainUnit >= +startDate && domainUnit < +endDate)\n      ) {\n        continue;\n      }\n\n      var subDomainsData = this._domains.get(domainUnit);\n\n      if (!temp.hasOwnProperty(domainUnit)) {\n        temp[domainUnit] = subDomainsData.map(extractTime);\n      }\n\n      var index = temp[domainUnit].indexOf(\n        this._domainType[this.options.subDomain].extractUnit(date),\n      );\n\n      if (updateMode === this.RESET_SINGLE_ON_UPDATE) {\n        subDomainsData[index].v = data[d];\n      } else {\n        if (!isNaN(subDomainsData[index].v)) {\n          subDomainsData[index].v += data[d];\n        } else {\n          subDomainsData[index].v = data[d];\n        }\n      }\n    }\n  },\n\n  parseURI: function (str, startDate, endDate) {\n    'use strict';\n\n    // Use a timestamp in seconds\n    str = str.replace(/\\{\\{t:start\\}\\}/g, startDate.getTime() / 1000);\n    str = str.replace(/\\{\\{t:end\\}\\}/g, endDate.getTime() / 1000);\n\n    // Use a string date, following the ISO-8601\n    str = str.replace(/\\{\\{d:start\\}\\}/g, startDate.toISOString());\n    str = str.replace(/\\{\\{d:end\\}\\}/g, endDate.toISOString());\n\n    return str;\n  },\n\n  interpretCSV: function (data) {\n    'use strict';\n\n    var d = {};\n    var keys = Object.keys(data[0]);\n    var i, total;\n    for (i = 0, total = data.length; i < total; i += 1) {\n      d[data[i][keys[0]]] = +data[i][keys[1]];\n    }\n    return d;\n  },\n\n  /**\n   * Handle the calendar layout and dimension\n   *\n   * Expand and shrink the container depending on its children dimension\n   * Also rearrange the children position depending on their dimension,\n   * and the legend position\n   *\n   * @return void\n   */\n  resize: function () {\n    'use strict';\n\n    var parent = this;\n    var options = parent.options;\n    var legendWidth = options.displayLegend\n      ? parent.Legend.getDim('width') +\n        options.legendMargin[1] +\n        options.legendMargin[3]\n      : 0;\n    var legendHeight = options.displayLegend\n      ? parent.Legend.getDim('height') +\n        options.legendMargin[0] +\n        options.legendMargin[2]\n      : 0;\n\n    var graphWidth =\n      parent.graphDim.width - options.domainGutter - options.cellPadding;\n    var graphHeight =\n      parent.graphDim.height - options.domainGutter - options.cellPadding;\n\n    this.root\n      .transition()\n      .duration(options.animationDuration)\n      .attr('width', function () {\n        if (\n          options.legendVerticalPosition === 'middle' ||\n          options.legendVerticalPosition === 'center'\n        ) {\n          return graphWidth + legendWidth;\n        }\n        return Math.max(graphWidth, legendWidth);\n      })\n      .attr('height', function () {\n        if (\n          options.legendVerticalPosition === 'middle' ||\n          options.legendVerticalPosition === 'center'\n        ) {\n          return Math.max(graphHeight, legendHeight);\n        }\n        return graphHeight + legendHeight;\n      });\n\n    this.root\n      .select('.graph')\n      .transition()\n      .duration(options.animationDuration)\n      .attr('y', function () {\n        if (options.legendVerticalPosition === 'top') {\n          return legendHeight;\n        }\n        return 0;\n      })\n      .attr('x', function () {\n        if (\n          (options.legendVerticalPosition === 'middle' ||\n            options.legendVerticalPosition === 'center') &&\n          options.legendHorizontalPosition === 'left'\n        ) {\n          return legendWidth;\n        }\n        return 0;\n      });\n  },\n\n  // =========================================================================//\n  // PUBLIC API                                //\n  // =========================================================================//\n\n  /**\n   * Shift the calendar forward\n   */\n  next: function (n) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      n = 1;\n    }\n    return this.loadNextDomain(n);\n  },\n\n  /**\n   * Shift the calendar backward\n   */\n  previous: function (n) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      n = 1;\n    }\n    return this.loadPreviousDomain(n);\n  },\n\n  /**\n   * Jump directly to a specific date\n   *\n   * JumpTo will scroll the calendar until the wanted domain with the specified\n   * date is visible. Unless you set reset to true, the wanted domain\n   * will not necessarily be the first (leftmost) domain of the calendar.\n   *\n   * @param Date date Jump to the domain containing that date\n   * @param bool reset Whether the wanted domain should be the first domain of the calendar\n   * @param bool True of the calendar was scrolled\n   */\n  jumpTo: function (date, reset) {\n    'use strict';\n\n    if (arguments.length < 2) {\n      reset = false;\n    }\n    var domains = this.getDomainKeys();\n    var firstDomain = domains[0];\n    var lastDomain = domains[domains.length - 1];\n\n    if (date < firstDomain) {\n      return this.loadPreviousDomain(this.getDomain(firstDomain, date).length);\n    } else {\n      if (reset) {\n        return this.loadNextDomain(this.getDomain(firstDomain, date).length);\n      }\n\n      if (date > lastDomain) {\n        return this.loadNextDomain(this.getDomain(lastDomain, date).length);\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * Navigate back to the start date\n   *\n   * @since  3.3.8\n   * @return void\n   */\n  rewind: function () {\n    'use strict';\n\n    this.jumpTo(this.options.start, true);\n  },\n\n  /**\n   * Update the calendar with new data\n   *\n   * @param  object|string    dataSource    The calendar's datasource, same type as this.options.data\n   * @param  boolean|function    afterLoad    Whether to execute afterLoad() on the data. Pass directly a function\n   * if you don't want to use the afterLoad() callback\n   */\n  update: function (dataSource, afterLoad, updateMode) {\n    'use strict';\n\n    if (arguments.length === 0) {\n      dataSource = this.options.data;\n    }\n    if (arguments.length < 2) {\n      afterLoad = true;\n    }\n    if (arguments.length < 3) {\n      updateMode = this.RESET_ALL_ON_UPDATE;\n    }\n\n    var domains = this.getDomainKeys();\n    var self = this;\n    this.getDatas(\n      dataSource,\n      new Date(domains[0]),\n      this.getSubDomain(domains[domains.length - 1]).pop(),\n      function () {\n        self.fill();\n        self.afterUpdate();\n      },\n      afterLoad,\n      updateMode,\n    );\n  },\n\n  /**\n   * Set the legend\n   *\n   * @param array legend an array of integer, representing the different threshold value\n   * @param array colorRange an array of 2 hex colors, for the minimum and maximum colors\n   */\n  setLegend: function () {\n    'use strict';\n\n    var oldLegend = this.options.legend.slice(0);\n    if (arguments.length >= 1 && Array.isArray(arguments[0])) {\n      this.options.legend = arguments[0];\n    }\n    if (arguments.length >= 2) {\n      if (Array.isArray(arguments[1]) && arguments[1].length >= 2) {\n        this.options.legendColors = [arguments[1][0], arguments[1][1]];\n      } else {\n        this.options.legendColors = arguments[1];\n      }\n    }\n\n    if (\n      (arguments.length > 0 && !arrayEquals(oldLegend, this.options.legend)) ||\n      arguments.length >= 2\n    ) {\n      this.Legend.buildColors();\n      this.fill();\n    }\n\n    this.Legend.redraw(\n      this.graphDim.width -\n        this.options.domainGutter -\n        this.options.cellPadding,\n    );\n  },\n\n  /**\n   * Remove the legend\n   *\n   * @return bool False if there is no legend to remove\n   */\n  removeLegend: function () {\n    'use strict';\n\n    if (!this.options.displayLegend) {\n      return false;\n    }\n    this.options.displayLegend = false;\n    this.Legend.remove();\n    return true;\n  },\n\n  /**\n   * Display the legend\n   *\n   * @return bool False if the legend was already displayed\n   */\n  showLegend: function () {\n    'use strict';\n\n    if (this.options.displayLegend) {\n      return false;\n    }\n    this.options.displayLegend = true;\n    this.Legend.redraw(\n      this.graphDim.width -\n        this.options.domainGutter -\n        this.options.cellPadding,\n    );\n    return true;\n  },\n\n  /**\n   * Highlight dates\n   *\n   * Add a highlight class to a set of dates\n   *\n   * @since  3.3.5\n   * @param  array Array of dates to highlight\n   * @return bool True if dates were highlighted\n   */\n  highlight: function (args) {\n    'use strict';\n\n    if ((this.options.highlight = this.expandDateSetting(args)).length > 0) {\n      this.fill();\n      return true;\n    }\n    return false;\n  },\n\n  /**\n   * Destroy the calendar\n   *\n   * Usage: cal = cal.destroy();\n   *\n   * @since  3.3.6\n   * @param function A callback function to trigger after destroying the calendar\n   * @return null\n   */\n  destroy: function (callback) {\n    'use strict';\n\n    this.root\n      .transition()\n      .duration(this.options.animationDuration)\n      .attr('width', 0)\n      .attr('height', 0)\n      .remove()\n      .each('end', function () {\n        if (typeof callback === 'function') {\n          callback();\n        } else if (typeof callback !== 'undefined') {\n          console.log('Provided callback for destroy() is not a function.');\n        }\n      });\n\n    return null;\n  },\n\n  getSVG: function () {\n    'use strict';\n\n    var styles = {\n      '.cal-heatmap-container': {},\n      '.graph': {},\n      '.graph-rect': {},\n      'rect.highlight': {},\n      'rect.now': {},\n      'rect.highlight-now': {},\n      'text.highlight': {},\n      'text.now': {},\n      'text.highlight-now': {},\n      '.domain-background': {},\n      '.graph-label': {},\n      '.subdomain-text': {},\n      '.q0': {},\n      '.qi': {},\n    };\n\n    for (\n      var j = 1, total = this.options.legend.length + 1;\n      j <= total;\n      j += 1\n    ) {\n      styles['.q' + j] = {};\n    }\n\n    var root = this.root;\n\n    var whitelistStyles = [\n      // SVG specific properties\n      'stroke',\n      'stroke-width',\n      'stroke-opacity',\n      'stroke-dasharray',\n      'stroke-dashoffset',\n      'stroke-linecap',\n      'stroke-miterlimit',\n      'fill',\n      'fill-opacity',\n      'fill-rule',\n      'marker',\n      'marker-start',\n      'marker-mid',\n      'marker-end',\n      'alignement-baseline',\n      'baseline-shift',\n      'dominant-baseline',\n      'glyph-orientation-horizontal',\n      'glyph-orientation-vertical',\n      'kerning',\n      'text-anchor',\n      'shape-rendering',\n\n      // Text Specific properties\n      'text-transform',\n      'font-family',\n      'font',\n      'font-size',\n      'font-weight',\n    ];\n\n    var filterStyles = function (attribute, property, value) {\n      if (whitelistStyles.indexOf(property) !== -1) {\n        styles[attribute][property] = value;\n      }\n    };\n\n    var getElement = function (e) {\n      return root.select(e)[0][0];\n    };\n\n    /* jshint forin:false */\n    for (var element in styles) {\n      if (!styles.hasOwnProperty(element)) {\n        continue;\n      }\n\n      var dom = getElement(element);\n\n      if (dom === null) {\n        continue;\n      }\n\n      // The DOM Level 2 CSS way\n      /* jshint maxdepth: false */\n      if ('getComputedStyle' in window) {\n        var cs = getComputedStyle(dom, null);\n        if (cs.length !== 0) {\n          for (var i = 0; i < cs.length; i += 1) {\n            filterStyles(element, cs.item(i), cs.getPropertyValue(cs.item(i)));\n          }\n\n          // Opera workaround. Opera doesn\"t support `item`/`length`\n          // on CSSStyleDeclaration.\n        } else {\n          for (var k in cs) {\n            if (cs.hasOwnProperty(k)) {\n              filterStyles(element, k, cs[k]);\n            }\n          }\n        }\n\n        // The IE way\n      } else if ('currentStyle' in dom) {\n        var css = dom.currentStyle;\n        for (var p in css) {\n          filterStyles(element, p, css[p]);\n        }\n      }\n    }\n\n    var string =\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" ' +\n      'xmlns:xlink=\"http://www.w3.org/1999/xlink\"><style type=\"text/css\"><![CDATA[ ';\n\n    for (var style in styles) {\n      string += style + ' {\\n';\n      for (var l in styles[style]) {\n        string += '\\t' + l + ':' + styles[style][l] + ';\\n';\n      }\n      string += '}\\n';\n    }\n\n    string += ']]></style>';\n    string += new XMLSerializer().serializeToString(this.root[0][0]);\n    string += '</svg>';\n\n    return string;\n  },\n};\n\n// =========================================================================//\n// DOMAIN POSITION COMPUTATION                        //\n// =========================================================================//\n\n/**\n * Compute the position of a domain, relative to the calendar\n */\nvar DomainPosition = function () {\n  'use strict';\n\n  this.positions = d3.map();\n};\n\nDomainPosition.prototype.getPosition = function (d) {\n  'use strict';\n\n  return this.positions.get(d);\n};\n\nDomainPosition.prototype.getPositionFromIndex = function (i) {\n  'use strict';\n\n  var domains = this.getKeys();\n  return this.positions.get(domains[i]);\n};\n\nDomainPosition.prototype.getLast = function () {\n  'use strict';\n\n  var domains = this.getKeys();\n  return this.positions.get(domains[domains.length - 1]);\n};\n\nDomainPosition.prototype.setPosition = function (d, dim) {\n  'use strict';\n\n  this.positions.set(d, dim);\n};\n\nDomainPosition.prototype.shiftRightBy = function (exitingDomainDim) {\n  'use strict';\n\n  this.positions.forEach(function (key, value) {\n    this.set(key, value - exitingDomainDim);\n  });\n\n  var domains = this.getKeys();\n  this.positions.remove(domains[0]);\n};\n\nDomainPosition.prototype.shiftLeftBy = function (enteringDomainDim) {\n  'use strict';\n\n  this.positions.forEach(function (key, value) {\n    this.set(key, value + enteringDomainDim);\n  });\n\n  var domains = this.getKeys();\n  this.positions.remove(domains[domains.length - 1]);\n};\n\nDomainPosition.prototype.getKeys = function () {\n  'use strict';\n\n  return this.positions.keys().sort(function (a, b) {\n    return parseInt(a, 10) - parseInt(b, 10);\n  });\n};\n\n// =========================================================================//\n// LEGEND                                  //\n// =========================================================================//\n\nvar Legend = function (calendar) {\n  'use strict';\n\n  this.calendar = calendar;\n  this.computeDim();\n\n  if (calendar.options.legendColors !== null) {\n    this.buildColors();\n  }\n};\n\nLegend.prototype.computeDim = function () {\n  'use strict';\n\n  var options = this.calendar.options; // Shorter accessor for variable name mangling when minifying\n  this.dim = {\n    width:\n      options.legendCellSize * (options.legend.length + 1) +\n      options.legendCellPadding * options.legend.length,\n    height: options.legendCellSize,\n  };\n};\n\nLegend.prototype.remove = function () {\n  'use strict';\n\n  this.calendar.root.select('.graph-legend').remove();\n  this.calendar.resize();\n};\n\nLegend.prototype.redraw = function (width) {\n  'use strict';\n\n  if (!this.calendar.options.displayLegend) {\n    return false;\n  }\n\n  var parent = this;\n  var calendar = this.calendar;\n  var legend = calendar.root;\n  var legendItem;\n  var options = calendar.options; // Shorter accessor for variable name mangling when minifying\n\n  this.computeDim();\n\n  var _legend = options.legend.slice(0);\n  _legend.push(_legend[_legend.length - 1] + 1);\n\n  var legendElement = calendar.root.select('.graph-legend');\n  if (legendElement[0][0] !== null) {\n    legend = legendElement;\n    legendItem = legend.select('g').selectAll('rect').data(_legend);\n  } else {\n    // Creating the new legend DOM if it doesn't already exist\n    legend =\n      options.legendVerticalPosition === 'top'\n        ? legend.insert('svg', '.graph')\n        : legend.append('svg');\n\n    legend.attr('x', getLegendXPosition()).attr('y', getLegendYPosition());\n\n    legendItem = legend\n      .attr('class', 'graph-legend')\n      .attr('height', parent.getDim('height'))\n      .attr('width', parent.getDim('width'))\n      .append('g')\n      .selectAll()\n      .data(_legend);\n  }\n\n  legendItem\n    .enter()\n    .append('rect')\n    .call(legendCellLayout)\n    .attr('class', function (d) {\n      return calendar.Legend.getClass(d, calendar.legendScale === null);\n    })\n    .attr('fill-opacity', 0)\n    .call(function (selection) {\n      if (\n        calendar.legendScale !== null &&\n        options.legendColors !== null &&\n        options.legendColors.hasOwnProperty('base')\n      ) {\n        selection.attr('fill', options.legendColors.base);\n      }\n    })\n    .append('title');\n\n  legendItem\n    .exit()\n    .transition()\n    .duration(options.animationDuration)\n    .attr('fill-opacity', 0)\n    .remove();\n\n  legendItem\n    .transition()\n    .delay(function (d, i) {\n      return (options.animationDuration * i) / 10;\n    })\n    .call(legendCellLayout)\n    .attr('fill-opacity', 1)\n    .call(function (element) {\n      element.attr('fill', function (d, i) {\n        if (calendar.legendScale === null) {\n          return '';\n        }\n\n        if (i === 0) {\n          return calendar.legendScale(d - 1);\n        }\n        return calendar.legendScale(options.legend[i - 1]);\n      });\n\n      element.attr('class', function (d) {\n        return calendar.Legend.getClass(d, calendar.legendScale === null);\n      });\n    });\n\n  function legendCellLayout(selection) {\n    selection\n      .attr('width', options.legendCellSize)\n      .attr('height', options.legendCellSize)\n      .attr('rx', options.legendCellRadius)\n      .attr('ry', options.legendCellRadius)\n      .attr('x', function (d, i) {\n        return i * (options.legendCellSize + options.legendCellPadding);\n      });\n  }\n\n  legendItem.select('title').text(function (d, i) {\n    if (i === 0) {\n      return calendar.formatStringWithObject(options.legendTitleFormat.lower, {\n        min: options.legend[i],\n        name: options.itemName[1],\n      });\n    } else if (i === _legend.length - 1) {\n      return calendar.formatStringWithObject(options.legendTitleFormat.upper, {\n        max: options.legend[i - 1],\n        name: options.itemName[1],\n      });\n    } else {\n      return calendar.formatStringWithObject(options.legendTitleFormat.inner, {\n        down: options.legend[i - 1],\n        up: options.legend[i],\n        name: options.itemName[1],\n      });\n    }\n  });\n  legendItem\n    .on('mouseover', function (d) {\n      calendar.legendTip.show(d, this);\n    })\n    .on('mouseout', function () {\n      calendar.legendTip.hide();\n    });\n\n  legend\n    .transition()\n    .duration(options.animationDuration)\n    .attr('x', getLegendXPosition())\n    .attr('y', getLegendYPosition())\n    .attr('width', parent.getDim('width'))\n    .attr('height', parent.getDim('height'));\n\n  legend\n    .select('g')\n    .transition()\n    .duration(options.animationDuration)\n    .attr('transform', function () {\n      if (options.legendOrientation === 'vertical') {\n        return (\n          'rotate(90 ' +\n          options.legendCellSize / 2 +\n          ' ' +\n          options.legendCellSize / 2 +\n          ')'\n        );\n      }\n      return '';\n    });\n\n  function getLegendXPosition() {\n    switch (options.legendHorizontalPosition) {\n      case 'right':\n        if (\n          options.legendVerticalPosition === 'center' ||\n          options.legendVerticalPosition === 'middle'\n        ) {\n          return width + options.legendMargin[3];\n        }\n        return width - parent.getDim('width') - options.legendMargin[1];\n      case 'middle':\n      case 'center':\n        return Math.round(width / 2 - parent.getDim('width') / 2);\n      default:\n        return options.legendMargin[3];\n    }\n  }\n\n  function getLegendYPosition() {\n    if (options.legendVerticalPosition === 'bottom') {\n      return (\n        calendar.graphDim.height +\n        options.legendMargin[0] -\n        options.domainGutter -\n        options.cellPadding\n      );\n    }\n    return options.legendMargin[0];\n  }\n\n  calendar.resize();\n};\n\n/**\n * Return the dimension of the legend\n *\n * Takes into account rotation\n *\n * @param  string axis Width or height\n * @return int height or width in pixels\n */\nLegend.prototype.getDim = function (axis) {\n  'use strict';\n\n  var isHorizontal = this.calendar.options.legendOrientation === 'horizontal';\n\n  switch (axis) {\n    case 'width':\n      return this.dim[isHorizontal ? 'width' : 'height'];\n    case 'height':\n      return this.dim[isHorizontal ? 'height' : 'width'];\n  }\n};\n\nLegend.prototype.buildColors = function () {\n  'use strict';\n\n  var options = this.calendar.options; // Shorter accessor for variable name mangling when minifying\n\n  if (options.legendColors === null) {\n    this.calendar.legendScale = null;\n    return false;\n  }\n\n  var _colorRange = [];\n\n  if (Array.isArray(options.legendColors)) {\n    _colorRange = options.legendColors;\n  } else if (\n    options.legendColors.hasOwnProperty('min') &&\n    options.legendColors.hasOwnProperty('max')\n  ) {\n    _colorRange = [options.legendColors.min, options.legendColors.max];\n  } else {\n    options.legendColors = null;\n    return false;\n  }\n\n  var _legend = options.legend.slice(0);\n\n  if (_legend[0] > 0) {\n    _legend.unshift(0);\n  } else if (_legend[0] <= 0) {\n    // Let's guess the leftmost value, it we have to add one\n    _legend.unshift(\n      _legend[0] - (_legend[_legend.length - 1] - _legend[0]) / _legend.length,\n    );\n  }\n  var colorScale;\n  if (options.legendColors.hasOwnProperty('colorScale')) {\n    colorScale = options.legendColors.colorScale;\n  } else {\n    colorScale = d3.scale\n      .linear()\n      .range(_colorRange)\n      .interpolate(d3.interpolateHcl)\n      .domain([d3.min(_legend), d3.max(_legend)]);\n  }\n\n  var legendColors = _legend.map(function (element) {\n    return colorScale(element);\n  });\n  this.calendar.legendScale = d3.scale\n    .threshold()\n    .domain(options.legend)\n    .range(legendColors);\n\n  return true;\n};\n\n/**\n * Return the classname on the legend for the specified value\n *\n * @param integer n Value associated to a date\n * @param bool withCssClass Whether to display the css class used to style the cell.\n *                          Disabling will allow styling directly via html fill attribute\n *\n * @return string Classname according to the legend\n */\nLegend.prototype.getClass = function (n, withCssClass) {\n  'use strict';\n\n  if (n === null || isNaN(n)) {\n    return '';\n  }\n\n  var index = [this.calendar.options.legend.length + 1];\n\n  for (\n    var i = 0, total = this.calendar.options.legend.length - 1;\n    i <= total;\n    i += 1\n  ) {\n    if (this.calendar.options.legend[0] > 0 && n < 0) {\n      index = ['1', 'i'];\n      break;\n    }\n\n    if (n <= this.calendar.options.legend[i]) {\n      index = [i + 1];\n      break;\n    }\n  }\n\n  if (n === 0) {\n    index.push(0);\n  }\n\n  index.unshift('');\n  return (index.join(' r') + (withCssClass ? index.join(' q') : '')).trim();\n};\n\n/**\n * #source http://stackoverflow.com/a/383245/805649\n */\nfunction mergeRecursive(obj1, obj2) {\n  'use strict';\n\n  /*jshint forin:false */\n  for (var p in obj2) {\n    try {\n      // Property in destination object set; update its value.\n      if (obj2[p].constructor === Object) {\n        obj1[p] = mergeRecursive(obj1[p], obj2[p]);\n      } else {\n        obj1[p] = obj2[p];\n      }\n    } catch (e) {\n      // Property in destination object not set; create it and set its value.\n      obj1[p] = obj2[p];\n    }\n  }\n\n  return obj1;\n}\n\n/**\n * Check if 2 arrays are equals\n *\n * @link http://stackoverflow.com/a/14853974/805649\n * @param  array array the array to compare to\n * @return bool true of the 2 arrays are equals\n */\nfunction arrayEquals(arrayA, arrayB) {\n  'use strict';\n\n  // if the other array is a falsy value, return\n  if (!arrayB || !arrayA) {\n    return false;\n  }\n\n  // compare lengths - can save a lot of time\n  if (arrayA.length !== arrayB.length) {\n    return false;\n  }\n\n  for (var i = 0; i < arrayA.length; i += 1) {\n    // Check if we have nested arrays\n    if (arrayA[i] instanceof Array && arrayB[i] instanceof Array) {\n      // recurse into the nested arrays\n      if (!arrayEquals(arrayA[i], arrayB[i])) {\n        return false;\n      }\n    } else if (arrayA[i] !== arrayB[i]) {\n      // Warning - two different object instances will never be equal: {x:20} != {x:20}\n      return false;\n    }\n  }\n  return true;\n}\n\nexport default CalHeatMap;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport PropTypes from 'prop-types';\nimport { extent as d3Extent, range as d3Range } from 'd3-array';\nimport { select as d3Select } from 'd3-selection';\nimport { getSequentialSchemeRegistry, t } from '@superset-ui/core';\nimport CalHeatMap from './vendor/cal-heatmap';\n\nconst propTypes = {\n  data: PropTypes.shape({\n    // Object hashed by metric name,\n    // then hashed by timestamp (in seconds, not milliseconds) as float\n    // the innermost value is count\n    // e.g. { count_distinct_something: { 1535034236.0: 3 } }\n    data: PropTypes.object,\n    domain: PropTypes.string,\n    range: PropTypes.number,\n    // timestamp in milliseconds\n    start: PropTypes.number,\n    subdomain: PropTypes.string,\n  }),\n  height: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellPadding: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellRadius: PropTypes.number,\n  // eslint-disable-next-line react/sort-prop-types\n  cellSize: PropTypes.number,\n  linearColorScheme: PropTypes.string,\n  showLegend: PropTypes.bool,\n  showMetricName: PropTypes.bool,\n  showValues: PropTypes.bool,\n  steps: PropTypes.number,\n  timeFormatter: PropTypes.func,\n  valueFormatter: PropTypes.func,\n  verboseMap: PropTypes.object,\n  theme: PropTypes.object,\n};\n\nfunction Calendar(element, props) {\n  const {\n    data,\n    height,\n    cellPadding = 3,\n    cellRadius = 0,\n    cellSize = 10,\n    domainGranularity,\n    linearColorScheme,\n    showLegend,\n    showMetricName,\n    showValues,\n    steps,\n    subdomainGranularity,\n    timeFormatter,\n    valueFormatter,\n    verboseMap,\n    theme,\n  } = props;\n\n  const container = d3Select(element)\n    .classed('superset-legacy-chart-calendar', true)\n    .style('height', height);\n  container.selectAll('*').remove();\n  const div = container.append('div');\n\n  const subDomainTextFormat = showValues\n    ? (date, value) => valueFormatter(value)\n    : null;\n\n  const metricsData = data.data;\n\n  const METRIC_TEXT = t('Metric');\n\n  Object.keys(metricsData).forEach(metric => {\n    const calContainer = div.append('div');\n    if (showMetricName) {\n      calContainer.text(`${METRIC_TEXT}: ${verboseMap[metric] || metric}`);\n    }\n    const timestamps = metricsData[metric];\n    const extents = d3Extent(Object.keys(timestamps), key => timestamps[key]);\n    const step = (extents[1] - extents[0]) / (steps - 1);\n    const colorScale = getSequentialSchemeRegistry()\n      .get(linearColorScheme)\n      .createLinearScale(extents);\n\n    const legend = d3Range(steps).map(i => extents[0] + step * i);\n    const legendColors = legend.map(x => colorScale(x));\n\n    const cal = new CalHeatMap();\n    cal.init({\n      start: data.start,\n      data: timestamps,\n      itemSelector: calContainer.node(),\n      legendVerticalPosition: 'top',\n      cellSize,\n      cellPadding,\n      cellRadius,\n      legendCellSize: cellSize,\n      legendCellPadding: 2,\n      legendCellRadius: cellRadius,\n      tooltip: true,\n      domain: domainGranularity,\n      subDomain: subdomainGranularity,\n      range: data.range,\n      browsing: true,\n      legend,\n      legendColors: {\n        colorScale,\n        min: legendColors[0],\n        max: legendColors[legendColors.length - 1],\n        empty: theme.colors.grayscale.light5,\n      },\n      displayLegend: showLegend,\n      itemName: '',\n      valueFormatter,\n      timeFormatter,\n      subDomainTextFormat,\n    });\n  });\n}\n\nCalendar.displayName = 'Calendar';\nCalendar.propTypes = propTypes;\n\nexport default Calendar;\n","import {Selection, root} from \"./selection/index.js\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","export default function(values, valueof) {\n  let min;\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  }\n  return [min, max];\n}\n","export default function(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport PropTypes from 'prop-types';\nimport { reactify, styled, css, useTheme } from '@superset-ui/core';\nimport { Global } from '@emotion/react';\nimport Component from './Calendar';\n\nconst ReactComponent = reactify(Component);\n\nconst Calendar = ({ className, ...otherProps }) => {\n  const theme = useTheme();\n  return (\n    <div className={className}>\n      <Global\n        styles={css`\n          .d3-tip {\n            line-height: 1;\n            padding: ${theme.gridUnit * 3}px;\n            background: ${theme.colors.grayscale.dark2};\n            color: ${theme.colors.grayscale.light5};\n            border-radius: 4px;\n            pointer-events: none;\n            z-index: 1000;\n            font-size: ${theme.typography.sizes.s}px;\n          }\n          /* Creates a small triangle extender for the tooltip */\n          .d3-tip:after {\n            box-sizing: border-box;\n            display: inline;\n            font-size: ${theme.typography.sizes.xs};\n            width: 100%;\n            line-height: 1;\n            color: ${theme.colors.grayscale.dark2};\n            position: absolute;\n            pointer-events: none;\n          }\n          /* Northward tooltips */\n          .d3-tip.n:after {\n            content: '\\\\25BC';\n            margin: -${theme.gridUnit}px 0 0 0;\n            top: 100%;\n            left: 0;\n            text-align: center;\n          }\n          /* Eastward tooltips */\n          .d3-tip.e:after {\n            content: '\\\\25C0';\n            margin: -${theme.gridUnit}px 0 0 0;\n            top: 50%;\n            left: -${theme.gridUnit * 2}px;\n          }\n          /* Southward tooltips */\n          .d3-tip.s:after {\n            content: '\\\\25B2';\n            margin: 0;\n            top: -${theme.gridUnit * 2}px;\n            left: 0;\n            text-align: center;\n          }\n          /* Westward tooltips */\n          .d3-tip.w:after {\n            content: '\\\\25B6';\n            margin: -${theme.gridUnit}px 0 0 0px;\n            top: 50%;\n            left: 100%;\n          }\n        `}\n      />\n      <ReactComponent {...otherProps} theme={theme} />\n    </div>\n  );\n};\n\nCalendar.defaultProps = {\n  otherProps: {},\n};\n\nCalendar.propTypes = {\n  className: PropTypes.string.isRequired,\n  otherProps: PropTypes.objectOf(PropTypes.any),\n};\n\nexport default styled(Calendar)`\n  ${({ theme }) => `\n    .superset-legacy-chart-calendar {\n      padding: ${theme.gridUnit * 3}px;\n      position: static !important;\n      overflow: auto !important;\n    }\n\n    .superset-legacy-chart-calendar .ch-tooltip {\n      margin-left: ${theme.gridUnit * 5}px;\n      margin-top: ${theme.gridUnit}px;\n    }\n\n    .superset-legacy-chart-calendar .d3-tip {\n      line-height: 1;\n      padding: ${theme.gridUnit * 3}px;\n      background: ${theme.colors.grayscale.dark2};\n      color: ${theme.colors.grayscale.light5};\n      border-radius: ${theme.borderRadius}px;\n      pointer-events: none;\n      z-index: 1000;\n    }\n\n    .cal-heatmap-container {\n      display: block;\n    }\n\n    .cal-heatmap-container .graph-label {\n      fill: ${theme.colors.grayscale.base};\n      font-size: ${theme.typography.sizes.xs}px;\n    }\n\n    .cal-heatmap-container .graph,\n    .cal-heatmap-container .graph-legend rect {\n      shape-rendering: crispedges;\n    }\n\n    .cal-heatmap-container .graph-rect {\n      fill: ${theme.colors.grayscale.light2};\n    }\n\n    .cal-heatmap-container .graph-subdomain-group rect:hover {\n      stroke: ${theme.colors.grayscale.dark2};\n      stroke-width: 1px;\n    }\n\n    .cal-heatmap-container .subdomain-text {\n      font-size: ${theme.typography.sizes.xs}px;\n      pointer-events: none;\n    }\n\n    .cal-heatmap-container .hover_cursor:hover {\n      cursor: pointer;\n    }\n\n    .cal-heatmap-container .qi {\n      background-color: ${theme.colors.grayscale.base};\n      fill: ${theme.colors.grayscale.base};\n    }\n\n    .cal-heatmap-container .q1 {\n      background-color: ${theme.colors.alert.light2};\n      fill: ${theme.colors.alert.light2};\n    }\n\n    .cal-heatmap-container .q2 {\n      background-color: ${theme.colors.alert.light1};\n      fill: ${theme.colors.alert.light1};\n    }\n\n    .cal-heatmap-container .q3 {\n      background-color: ${theme.colors.success.light1};\n      fill: ${theme.colors.success.light1};\n    }\n\n    .cal-heatmap-container .q4 {\n      background-color: ${theme.colors.success.base};\n      fill: ${theme.colors.success.base};\n    }\n\n    .cal-heatmap-container .q5 {\n      background-color: ${theme.colors.success.dark1};\n      fill: ${theme.colors.success.dark1};\n    }\n\n    .cal-heatmap-container rect.highlight {\n      stroke: ${theme.colors.grayscale.dark1};\n      stroke-width: 1;\n    }\n\n    .cal-heatmap-container text.highlight {\n      fill: ${theme.colors.grayscale.dark1};\n    }\n\n    .cal-heatmap-container rect.highlight-now {\n      stroke: ${theme.colors.error.base};\n    }\n\n    .cal-heatmap-container text.highlight-now {\n      fill: ${theme.colors.error.base};\n      font-weight: ${theme.typography.weights.bold};\n    }\n\n    .cal-heatmap-container .domain-background {\n      fill: none;\n      shape-rendering: crispedges;\n    }\n\n    .ch-tooltip {\n      padding: ${theme.gridUnit * 2}px;\n      background: ${theme.colors.grayscale.dark1};\n      color: ${theme.colors.grayscale.light1};\n      font-size: ${theme.typography.sizes.s}px;\n      line-height: 1.4;\n      width: 140px;\n      position: absolute;\n      z-index: 99999;\n      text-align: center;\n      border-radius: ${theme.borderRadius}px;\n      box-shadow: 2px 2px 2px ${theme.colors.grayscale.dark2};\n      display: none;\n      box-sizing: border-box;\n    }\n\n    .ch-tooltip::after {\n      position: absolute;\n      width: 0;\n      height: 0;\n      border-color: transparent;\n      border-style: solid;\n      content: '';\n      padding: 0;\n      display: block;\n      bottom: -${theme.gridUnit}px;\n      left: 50%;\n      margin-left: -${theme.gridUnit}px;\n      border-width: ${theme.gridUnit}px ${theme.gridUnit}px 0;\n      border-top-color: ${theme.colors.grayscale.dark1};\n    }\n  `}\n`;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// eslint-disable-next-line no-restricted-syntax -- whole React import is required for `reactify.test.tsx` Jest test passing.\nimport React, { Component, ComponentClass, WeakValidationMap } from 'react';\n\n// TODO: Note that id and className can collide between Props and ReactifyProps\n// leading to (likely) unexpected behaviors. We should either require Props to not\n// contain an id/className, or not combine them (via intersection), instead preferring\n// wrapping (composition). As an example:\n// interface MyProps {\n//   id: number;\n// }\n// function myRender(container: HTMLDivElement, props: Readonly<MyProps>): void {\n//   props.id // unusable: id is string & number\n// }\n// new (reactify(myRender))({ id: 5 }); // error: id has to be string & number\n\nexport type ReactifyProps = {\n  id?: string;\n  className?: string;\n};\n\n// TODO: add more React lifecycle callbacks as needed\nexport type LifeCycleCallbacks = {\n  componentWillUnmount?: () => void;\n};\n\nexport interface RenderFuncType<Props> {\n  (container: HTMLDivElement, props: Readonly<Props & ReactifyProps>): void;\n  displayName?: string;\n  defaultProps?: Partial<Props & ReactifyProps>;\n  propTypes?: WeakValidationMap<Props & ReactifyProps>;\n}\n\nexport default function reactify<Props extends object>(\n  renderFn: RenderFuncType<Props>,\n  callbacks?: LifeCycleCallbacks,\n): ComponentClass<Props & ReactifyProps> {\n  class ReactifiedComponent extends Component<Props & ReactifyProps> {\n    container?: HTMLDivElement;\n\n    constructor(props: Props & ReactifyProps) {\n      super(props);\n      this.setContainerRef = this.setContainerRef.bind(this);\n    }\n\n    componentDidMount() {\n      this.execute();\n    }\n\n    componentDidUpdate() {\n      this.execute();\n    }\n\n    componentWillUnmount() {\n      this.container = undefined;\n      if (callbacks?.componentWillUnmount) {\n        callbacks.componentWillUnmount.bind(this)();\n      }\n    }\n\n    setContainerRef(ref: HTMLDivElement) {\n      this.container = ref;\n    }\n\n    execute() {\n      if (this.container) {\n        renderFn(this.container, this.props);\n      }\n    }\n\n    render() {\n      const { id, className } = this.props;\n\n      return <div ref={this.setContainerRef} id={id} className={className} />;\n    }\n  }\n\n  const ReactifiedClass: ComponentClass<Props & ReactifyProps> =\n    ReactifiedComponent;\n\n  if (renderFn.displayName) {\n    ReactifiedClass.displayName = renderFn.displayName;\n  }\n  // eslint-disable-next-line react/forbid-foreign-prop-types\n  if (renderFn.propTypes) {\n    ReactifiedClass.propTypes = {\n      ...ReactifiedClass.propTypes,\n      ...renderFn.propTypes,\n    };\n  }\n  if (renderFn.defaultProps) {\n    ReactifiedClass.defaultProps = renderFn.defaultProps;\n  }\n\n  return ReactifiedComponent;\n}\n"],"names":["none","selector","this","querySelector","empty","childMatcher","node","matches","find","Array","prototype","childFirst","firstElementChild","filter","children","from","update","length","EnterNode","parent","datum","ownerDocument","namespaceURI","_next","_parent","__data__","bindIndex","group","enter","exit","data","i","groupLength","dataLength","bindKey","key","keyValue","nodeByKeyValue","Map","keyValues","call","has","set","get","delete","arraylike","ascending","a","b","NaN","constructor","appendChild","child","insertBefore","next","querySelectorAll","xhtml","svg","xlink","xml","xmlns","name","prefix","indexOf","slice","namespaces","hasOwnProperty","space","local","attrRemove","removeAttribute","attrRemoveNS","fullname","removeAttributeNS","attrConstant","value","setAttribute","attrConstantNS","setAttributeNS","attrFunction","v","apply","arguments","attrFunctionNS","defaultView","document","styleRemove","style","removeProperty","styleConstant","priority","setProperty","styleFunction","propertyRemove","propertyConstant","propertyFunction","classArray","string","trim","split","classList","ClassList","_node","_names","getAttribute","classedAdd","names","list","n","add","classedRemove","remove","classedTrue","classedFalse","classedFunction","textRemove","textContent","textConstant","textFunction","htmlRemove","innerHTML","htmlConstant","htmlFunction","raise","nextSibling","parentNode","lower","previousSibling","firstChild","creatorInherit","uri","documentElement","createElement","createElementNS","creatorFixed","namespace","constantNull","removeChild","selection_cloneShallow","clone","cloneNode","selection_cloneDeep","onRemove","typename","on","__on","o","j","m","type","removeEventListener","listener","options","onAdd","event","contextListener","addEventListener","push","dispatchEvent","params","window","CustomEvent","createEvent","initEvent","bubbles","cancelable","detail","dispatchConstant","dispatchFunction","join","splice","contains","root","Selection","groups","parents","_groups","_parents","select","subgroups","subnode","subgroup","selectAll","x","isArray","arrayAll","selectorAll","selectChild","match","childFind","selectChildren","childrenFilter","matcher","bind","enterGroup","updateGroup","previous","i0","i1","_enter","_exit","map","sparse","onenter","onupdate","onexit","selection","append","merge","order","context","groups0","groups1","m0","m1","Math","min","merges","group0","group1","compareDocumentPosition","sort","compare","compareNode","sortgroups","sortgroup","callback","nodes","size","each","attr","getAttributeNS","getPropertyValue","getComputedStyle","styleValue","property","classed","text","html","create","creator","insert","before","deep","t","typenames","parseTypenames","dispatch","Symbol","iterator","d3","require","CalHeatMap","self","tip","d3tip","direction","offset","d","timeFormatter","valueFormatter","legendTip","allowedDataType","itemSelector","paintOnLoad","range","cellSize","cellPadding","cellRadius","domainGutter","domainMargin","domain","subDomain","colLimit","rowLimit","weekStartOnMonday","start","Date","minDate","maxDate","dataType","dataPostPayload","dataRequestHeaders","considerMissingDataAsZero","loadOnInit","verticalOrientation","domainDynamicDimension","label","position","align","y","rotate","width","height","legend","displayLegend","legendCellSize","legendCellPadding","legendMargin","legendVerticalPosition","legendHorizontalPosition","legendOrientation","legendColors","highlight","itemName","domainLabelFormat","subDomainTitleFormat","filled","subDomainDateFormat","subDomainTextFormat","legendTitleFormat","inner","upper","animationDuration","nextSelector","previousSelector","itemNamespace","tooltip","onClick","afterLoad","afterLoadNextDomain","afterLoadPreviousDomain","onComplete","afterLoadData","timestamps","stdTimezoneOffset","date","jan","getFullYear","jul","max","getTimezoneOffset","results","timestamp","parseInt","afterUpdate","onMaxDomainReached","onMinDomainReached","_domainType","level","maxItemNumber","defaultRowNumber","defaultColumnNumber","row","getSubDomainRowNumber","column","getSubDomainColumnNumber","floor","getMinutes","format","connector","extractUnit","getMonth","getDate","getHours","getTime","hour","getDayCountInMonth","getWeekDay","p","day","getDayCountInYear","getWeekNumber","getDayOfYear","week","getMonthWeekNumber","dt","weekDay","getDay","setDate","month","year","w","outer","domainHorizontalLabelWidth","h","domainVerticalLabelHeight","lastInsertedSvg","_completed","_domains","graphDim","legendDim","NAVIGATE_LEFT","NAVIGATE_RIGHT","RESET_ALL_ON_UPDATE","RESET_SINGLE_ON_UPDATE","APPEND_ON_UPDATE","DEFAULT_LEGEND_MARGIN","_maxDomainReached","_minDomainReached","domainPosition","DomainPosition","Legend","legendScale","DSTDomain","_init","getDomain","getSubDomain","verticalDomainLabel","paint","preventDefault","loadNextDomain","loadPreviousDomain","redraw","domains","getDomainKeys","getDatas","pop","fill","checkIfMinDomainIsReached","checkIfMaxDomainIsReached","getNextDomain","_initCalendar","navigationDir","domainSvg","reverse","enteringDomainDim","exitingDomainDim","getDomainPosition","classname","domainIndex","axis","domainDim","tmp","setPosition","getPositionFromIndex","shiftRightBy","getLast","shiftLeftBy","rect","getHighlightClassName","positionSubDomainX","positionSubDomainY","base","show","hide","formatDate","s","transition","duration","getPosition","tempWidth","tempHeight","resize","init","settings","mergeRecursive","substring","Error","validateDomainType","validateSelector","error","console","log","message","getOptimalSubDomain","k","canBeFalse","Element","expandMarginSetting","expandDateSetting","expandItemName","parseRowLimit","autoAddLegendMargin","autoAlignLabel","htmlClass","pastDate","dateIsLessThan","sameDate","dateIsEqual","getClass","element","overflow","getSubDomainTitle","rgb","getContrastingColor","formatStringWithObject","formatted","args","prop","regexp","RegExp","replace","triggerEvent","eventName","successArgs","skip","itemNb","response","shift","reached","upperBound","minDomainIsReached","maxDomainIsReached","lowerBound","formatNumber","time","f","count","bound","loadNewDomains","end","newDomains","backward","total","buildSubDomain","datetimestamp","keys","index","ceil","isNow","dateA","dateB","normalizedMillis","subdomain","monthFirstWeekNumber","getWeekNumberInYear","getEndOfMonth","jumpDate","step","setHours","setMonth","setFullYear","getMinuteDomain","stop","minutes","getHourDomain","hours","abs","getDayDomain","days","getWeekDomain","weekStart","endDate","mondays","sundays","getMonthDomain","months","getYearDomain","years","computeMinSubDomainSize","computeHourSubDomainSize","computeDaySubDomainSize","endOfMonth","endWeekNb","startWeekNb","computeWeekSubDomainSize","getPreviousDomain","source","startDate","updateMode","_callback","interpretCSV","parseDatas","url","parseURI","requestType","payload","xhr","json","csv","tsv","header","send","Object","forEach","array","temp","extractTime","domainUnit","isNaN","subDomainsData","str","toISOString","legendWidth","getDim","legendHeight","graphWidth","graphHeight","jumpTo","reset","firstDomain","lastDomain","rewind","dataSource","setLegend","oldLegend","arrayEquals","buildColors","removeLegend","showLegend","destroy","getSVG","styles","e","whitelistStyles","filterStyles","attribute","dom","cs","item","css","currentStyle","l","XMLSerializer","serializeToString","positions","getKeys","dim","calendar","computeDim","obj1","obj2","arrayA","arrayB","legendItem","_legend","legendElement","legendCellLayout","legendCellRadius","getLegendXPosition","round","getLegendYPosition","delay","down","up","isHorizontal","_colorRange","colorScale","unshift","scale","linear","interpolate","interpolateHcl","threshold","withCssClass","propTypes","PropTypes","linearColorScheme","showMetricName","showValues","steps","verboseMap","theme","Calendar","props","domainGranularity","subdomainGranularity","container","d3Select","div","metricsData","METRIC_TEXT","metric","calContainer","extents","values","valueof","undefined","d3Extent","getSequentialSchemeRegistry","createLinearScale","d3Range","browsing","colors","grayscale","light5","displayName","ReactComponent","reactify","Component","className","otherProps","useTheme","_jsxs","_jsx","Global","gridUnit","dark2","typography","sizes","xs","defaultProps","isRequired","styled","borderRadius","light2","alert","light1","success","dark1","weights","bold","renderFn","callbacks","ReactifiedComponent","super","setContainerRef","componentDidMount","execute","componentDidUpdate","componentWillUnmount","ref","render","id","ReactifiedClass"],"sourceRoot":""}