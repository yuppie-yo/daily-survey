"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[3588],{623588:(t,e,n)=>{n.r(e),n.d(e,{default:()=>R});var a=n(943323),r=n(211965),s=n(751995),i=n(615078),o=n.n(i),d=n(45697),l=n.n(d),c=n(728041),u=n.n(c),p=n(767190),g=n(751115),h=n(328062);const m={data:l().objectOf(l().arrayOf(l().shape({key:l().arrayOf(l().string),name:l().arrayOf(l().string),time:l().number,value:l().number}))),width:l().number,height:l().number,dateTimeFormat:l().string,numberFormat:l().string,useRichTooltip:l().bool,useAreaProportions:l().bool,colorScheme:l().string};function f(t){return{startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius}}function y(t,e){return t.value===e.value?t.name>e.name?1:-1:e.value-t.value}function b(t,e){const{data:n,width:a,height:r,colorScheme:s,dateTimeFormat:i,numberFormat:d,useRichTooltip:l,useAreaProportions:c,sliceId:m}=e,b=o().select(t);b.classed("superset-legacy-chart-rose",!0);const I=n,A=Object.keys(I).map((t=>parseInt(t,10))).sort(((t,e)=>t-e)),v=A.length,R=I[A[0]].length,T=(0,p.JB)(d),w=(0,g.bt)(i),k=h.getScale(s);o().select(".nvtooltip").remove(),b.selectAll("*").remove();const x=o().svg.arc(),O=u().models.legend(),N=u().models.tooltip(),S={disabled:I[A[0]].map((()=>!1))},$=b.append("svg").attr("width",a).attr("height",r).append("g").attr("class","rose").append("g"),M=$.append("g").attr("class","legendWrap");function C(t){return t[A[0]].map(((t,e)=>({disabled:S.disabled[e],key:t.name})))}O.width(a).color((t=>k(t.key,m))),M.datum(C(I)).call(O),N.headerFormatter(w).valueFormatter(T),N.classes("tooltip");const P=r-O.height(),J=O.height(),W=Math.min(a,P)/2-35,F=.075,L=`translate(${a/2},${P/2+J})`,z=$.append("g").attr("transform",L).attr("class","roseWrap"),U=$.append("g").attr("transform",L).attr("class","labelsWrap"),Z=$.append("g").attr("transform",L).attr("class","groupLabelsWrap");function j(t){let e=0,n=0;const a=[];for(const t of A){const r=I[t].reduce(((t,e,n)=>t+(S.disabled[n]?0:e.value)),0);e=r>e?r:e,a[n]=r,n+=1}const r=2*Math.PI/v,s=[];for(let t=0;t<=v;t+=1)s.push(r*t-Math.PI/2);const i=W/e,o=i*W,d=(t,e)=>c?Math.sqrt(o*t+e*e):i*t+e,l={data:[],extend:{},push:{},pieStart:{},pie:{},pieOver:{},mini:{},labels:[],groupLabels:[]};let u=0;for(let e=0;e<v;e+=1){const n=A[e],r=s[e],i=s[e+1],o=2*Math.PI/a[e];let c,p,g=0,h=0;for(const e of t[n]){const t=S.disabled[u%R]?0:e.value,{name:n,time:a}=e;e.id=u,c=d(t,g),l.data.push({startAngle:r,endAngle:i,innerRadius:g,outerRadius:c,name:n,arcId:u,val:t,time:a}),l.extend[u]={startAngle:r,endAngle:i,innerRadius:g,name:n,outerRadius:c+8},l.push[u]={startAngle:r,endAngle:i,innerRadius:g+8,outerRadius:c+8},l.pieStart[u]={startAngle:r,endAngle:i,innerRadius:F*W,outerRadius:W},l.mini[u]={startAngle:r,endAngle:i,innerRadius:g*F,outerRadius:c*F},u+=1,g=c}const m={...l.data[e*R]};m.outerRadius=W+20,m.innerRadius=W+15,l.labels.push(m);for(const r of t[n].concat().sort(y))p=o*(S.disabled[r.id%R]?0:r.value)+h,l.pie[r.id]={startAngle:h,endAngle:p,innerRadius:W*F,outerRadius:W,percent:r.value/a[e]},l.pieOver[r.id]={startAngle:h,endAngle:p,innerRadius:W*F,outerRadius:W+8},h=p}return l.groupLabels=l.data.slice(0,R),l}let B=j(I);function D(t,e){return function(n){const a=o().interpolate(f(n),f(t));return t=>e(Object.assign(n,a(t)))}}function K(t){return D(t,(t=>x(t)))}function q(t){return D(t,(t=>`translate(${x.centroid(t)})`))}const G={};function X(t){if(G[t])return G[t];const e=Math.floor(t/R);return G[t]=[t+1,R*(e+1)-1],G[t]}const E={};function H(t){if(E[t])return E[t];const e=Math.floor(t/R);return E[t]=[e*R,(e+1)*R-1],E[t]}let Q=-1,V=!1;const Y=z.selectAll("g").data(JSON.parse(JSON.stringify(B.data))).enter().append("g").attr("class","segment").classed("clickable",!0).on("mouseover",(function(t,e){N.data(function(t,e,n){const a=Math.floor(t.arcId/R),r=l?n[A[a]].filter((t=>!S.disabled[t.id%R])).map((e=>({key:e.name,value:e.value,color:k(e.name,m),highlight:e.id===t.arcId}))):[{key:t.name,value:t.val,color:k(t.name,m)}];return{key:"Date",value:t.time,series:r}}(t,0,I)).hidden(!1);const n=o().select(this);if(n.classed("hover",!0),Q<0&&!V){n.select("path").interrupt().transition().duration(180).attrTween("d",K(B.extend[e]));const t=X(e);et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(180).attrTween("d",(t=>K(B.push[t.arcId])(t)))}else if(!V){const a=H(Q);a[0]<=t.arcId&&t.arcId<=a[1]&&n.select("path").interrupt().transition().duration(180).attrTween("d",K(B.pieOver[e]))}})).on("mouseout",(function(t,e){N.hidden(!0);const n=o().select(this);if(n.classed("hover",!1),Q<0&&!V){n.select("path").interrupt().transition().duration(180).attrTween("d",K(B.data[e]));const t=X(e);et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(180).attrTween("d",(t=>K(B.data[t.arcId])(t)))}else if(!V){const a=H(Q);a[0]<=t.arcId&&t.arcId<=a[1]&&n.select("path").interrupt().transition().duration(180).attrTween("d",K(B.pie[e]))}})).on("mousemove",(function(){N()})).on("click",(function(t,e){if(V)return;const n=o().event.altKey?3750:375,a=H(e);if(Q<0)V=!0,Q=e,_.interrupt().transition().duration(n).attrTween("transform",(t=>q({outerRadius:0,innerRadius:0,startAngle:t.startAngle,endAngle:t.endAngle})(t))).style("opacity",0),tt.attr("transform",`translate(${x.centroid({outerRadius:W+20,innerRadius:W+15,startAngle:B.data[e].startAngle,endAngle:B.data[e].endAngle})})`).interrupt().transition().delay(n).duration(n).attrTween("transform",(t=>q({outerRadius:W+20,innerRadius:W+15,startAngle:B.pie[a[0]+t.arcId].startAngle,endAngle:B.pie[a[0]+t.arcId].endAngle})(t))).style("opacity",(t=>S.disabled[t.arcId]||B.pie[a[0]+t.arcId].percent<.05?0:1)),Y.classed("clickable",(t=>a[0]>t.arcId||t.arcId>a[1])),et.filter((t=>a[0]<=t.arcId&&t.arcId<=a[1])).interrupt().transition().duration(n).attrTween("d",(t=>K(B.pieStart[t.arcId])(t))).transition().duration(n).attrTween("d",(t=>K(B.pie[t.arcId])(t))).each("end",(()=>{V=!1})),et.filter((t=>a[0]>t.arcId||t.arcId>a[1])).interrupt().transition().duration(n).attrTween("d",(t=>K(B.mini[t.arcId])(t)));else if(Q<a[0]||a[1]<Q){V=!0;const t=H(Q);_.interrupt().transition().delay(n).duration(n).attrTween("transform",(t=>q(B.labels[t.arcId/R])(t))).style("opacity",1),tt.interrupt().transition().duration(n).attrTween("transform",q({outerRadius:W+20,innerRadius:W+15,startAngle:B.data[Q].startAngle,endAngle:B.data[Q].endAngle})).style("opacity",0),Y.classed("clickable",!0),et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(n).attrTween("d",(t=>K(B.pieStart[t.arcId])(t))).transition().duration(n).attrTween("d",(t=>K(B.data[t.arcId])(t))).each("end",(()=>{Q=-1,V=!1})),et.filter((e=>t[0]>e.arcId||e.arcId>t[1])).interrupt().transition().delay(n).duration(n).attrTween("d",(t=>K(B.data[t.arcId])(t)))}})),_=U.selectAll("g").data(JSON.parse(JSON.stringify(B.labels))).enter().append("g").attr("class","roseLabel").attr("transform",(t=>`translate(${x.centroid(t)})`));_.append("text").style("text-anchor","middle").style("fill","#000").text((t=>w(t.time)));const tt=Z.selectAll("g").data(JSON.parse(JSON.stringify(B.groupLabels))).enter().append("g");tt.style("opacity",0).attr("class","roseGroupLabels").append("text").style("text-anchor","middle").style("fill","#000").text((t=>t.name));const et=Y.append("path").attr("class","arc").attr("fill",(t=>k(t.name,m))).attr("d",x);O.dispatch.on("stateChange",(t=>{S.disabled!==t.disabled&&(S.disabled=t.disabled,function(){const t=o().event.altKey?3e3:300;M.datum(C(I)).call(O);const e=j(I);if(V=!0,Q<0)et.style("opacity",1).interrupt().transition().duration(t).attrTween("d",(t=>K(e.data[t.arcId])(t))).each("end",(()=>{V=!1,B=e})).transition().duration(0).style("opacity",(t=>S.disabled[t.arcId%R]?0:1));else{const n=H(Q);et.style("opacity",1).interrupt().transition().duration(t).attrTween("d",(t=>n[0]<=t.arcId&&t.arcId<=n[1]?K(e.pie[t.arcId])(t):K(e.mini[t.arcId])(t))).each("end",(()=>{V=!1,B=e})).transition().duration(0).style("opacity",(t=>S.disabled[t.arcId%R]?0:1)),tt.interrupt().transition().duration(t).attrTween("transform",(t=>q({outerRadius:W+20,innerRadius:W+15,startAngle:e.pie[n[0]+t.arcId].startAngle,endAngle:e.pie[n[0]+t.arcId].endAngle})(t))).style("opacity",(t=>S.disabled[t.arcId]||B.pie[n[0]+t.arcId].percent<.05?0:1))}}())}))}b.displayName="Rose",b.propTypes=m;const I=b;var A=n(135944);const v=(0,a.Z)(I),R=(0,s.iK)((({className:t,...e})=>(0,A.BX)("div",{className:t,children:[(0,A.tZ)(r.xB,{styles:t=>r.iv`
        .tooltip {
          line-height: 1;
          padding: ${3*t.gridUnit}px;
          background: ${t.colors.grayscale.dark2};
          color: ${t.colors.grayscale.light5};
          border-radius: 4px;
          pointer-events: none;
          z-index: 1000;
          font-size: ${t.typography.sizes.s}px;
        }
      `}),(0,A.tZ)(v,{...e})]})))`
  ${({theme:t})=>`\n    .superset-legacy-chart-rose path {\n        transition: fill-opacity 180ms linear;\n        stroke: ${t.colors.grayscale.light5};\n        stroke-width: 1px;\n        stroke-opacity: 1;\n        fill-opacity: 0.75;\n    }\n\n    .superset-legacy-chart-rose text {\n        font-weight: ${t.typography.weights.normal};\n        font-size: ${t.typography.sizes.s}px;\n        font-family: ${t.typography.families.sansSerif};\n        pointer-events: none;\n    }\n\n    .superset-legacy-chart-rose .clickable path {\n        cursor: pointer;\n    }\n\n    .superset-legacy-chart-rose .hover path {\n        fill-opacity: 1;\n    }\n\n    .nv-legend .nv-series {\n        cursor: pointer;\n    }\n  `}
`},943323:(t,e,n)=>{n.d(e,{Z:()=>s});var a=n(667294),r=n(135944);function s(t,e){class n extends a.Component{constructor(t){super(t),this.container=void 0,this.setContainerRef=this.setContainerRef.bind(this)}componentDidMount(){this.execute()}componentDidUpdate(){this.execute()}componentWillUnmount(){this.container=void 0,null!=e&&e.componentWillUnmount&&e.componentWillUnmount.bind(this)()}setContainerRef(t){this.container=t}execute(){this.container&&t(this.container,this.props)}render(){const{id:t,className:e}=this.props;return(0,r.tZ)("div",{ref:this.setContainerRef,id:t,className:e})}}const s=n;return t.displayName&&(s.displayName=t.displayName),t.propTypes&&(s.propTypes={...s.propTypes,...t.propTypes}),t.defaultProps&&(s.defaultProps=t.defaultProps),n}}}]);
//# sourceMappingURL=4c8fedb4170627f9e041.chunk.js.map